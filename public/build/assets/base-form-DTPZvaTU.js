import{r as n,j as e,a as C}from"./app-DGEpaMO1.js";import{F as E}from"./form-modal-D70VI4Fh.js";import{t as I}from"./index-BcnpcCLW.js";import"./proxy-JgGNu-as.js";import"./index-d5u58xBD.js";function $({isOpen:u,onClose:x,user:s,statuses:_,role:t,routePrefix:w}){const[L,F]=n.useState(0),[r,m]=n.useState({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:t.id,status:"active",...t.value==="admin"||t.value==="teacher"?{nip:"",position:""}:{},...t.value==="parent"?{job:""}:{},address:""}),[f,b]=n.useState(!1),[v,p]=n.useState(null),[j,g]=n.useState(!1),[k,M]=n.useState(!1),[N,P]=n.useState(!1),h=n.useRef(null);n.useEffect(()=>{u&&s&&!f?(m({...s,password:"",password_confirmation:"",profile_picture:void 0}),s.profile_picture&&p(`/storage/${s.profile_picture}`),b(!0)):u&&!s&&!f&&(m({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:t.id,status:"active",...t.value==="admin"||t.value==="teacher"?{nip:"",position:""}:{},...t.value==="parent"?{job:""}:{},address:""}),p(null),b(!0))},[s,t,u,f]),n.useEffect(()=>{u||(m({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:t.id,status:"active",...t.value==="admin"||t.value==="teacher"?{nip:"",position:""}:{},...t.value==="parent"?{job:""}:{},address:""}),b(!1),p(null),g(!1),F(a=>a+1),h.current&&(h.current.value=""))},[u,t.id,t.value]);const i=(a,o)=>{m(d=>({...d,[a]:o}))},y=a=>o=>{const d=o.target.value.replace(/\D/g,"");m(l=>({...l,[a]:d}))},S=a=>{var d;const o=(d=a.target.files)==null?void 0:d[0];if(o){const l=new FileReader;l.onloadend=()=>{p(l.result)},l.readAsDataURL(o),m(c=>({...c,profile_picture:o})),g(!1)}},B=()=>{p(null),m(a=>({...a,profile_picture:void 0})),g(!0),h.current&&(h.current.value="")},z=a=>{a.preventDefault();const o=new FormData;r.profile_picture instanceof File&&o.append("profile_picture",r.profile_picture),j&&o.append("remove_profile_picture","1"),Object.entries(r).forEach(([l,c])=>{l!=="profile_picture"&&c!==void 0&&c!==null&&o.append(l,c)}),s!=null&&s.id&&o.append("_method","PUT");const d=s!=null&&s.id?route(`${w}.update`,s.id):route(`${w}.store`);C.post(d,o,{preserveScroll:!0,onSuccess:()=>{x(),C.reload()},onError:l=>{const c=Object.values(l).join(`
`);I.error(`Failed: ${c}`)},headers:{"Content-Type":"multipart/form-data"}})};return e.jsxs(E,{isOpen:u,onClose:x,title:s?`Edit ${t.name}`:`Tambah ${t.name} Baru`,onSubmit:z,children:[(t.value==="admin"||t.value==="teacher")&&e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-32 w-32 items-center justify-center overflow-hidden rounded-full border-2 border-gray-300 bg-gray-100",children:v?e.jsx("img",{src:v,alt:"Profile preview",className:"h-full w-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(v||(s==null?void 0:s.profile_picture)&&!j)&&e.jsx("button",{type:"button",onClick:B,className:"absolute -top-2 -right-2 rounded-full bg-red-500 p-1 text-white hover:cursor-pointer hover:bg-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("label",{className:"mt-2 cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("span",{children:"Upload Photo"}),e.jsx("input",{type:"file",ref:h,className:"hidden",accept:"image/*",onChange:S})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 2MB (300x300)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Nama Lengkap*"}),e.jsx("input",{autoComplete:"off",id:"full_name",type:"text",maxLength:70,value:r.full_name,onChange:a=>i("full_name",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username*"}),e.jsx("input",{autoComplete:"off",id:"username",type:"text",maxLength:70,value:r.username,onChange:a=>i("username",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),(t.value==="admin"||t.value==="teacher")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"nip",className:"block text-sm font-medium text-gray-700",children:"NIP"}),e.jsx("input",{autoComplete:"off",id:"nip",type:"text",inputMode:"numeric",pattern:"[0-9]*",minLength:18,maxLength:18,value:r.nip||"",onChange:y("nip"),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Posisi/Jabatan"}),e.jsx("input",{autoComplete:"off",id:"position",type:"text",maxLength:70,value:r.position||"",onChange:a=>i("position",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]})]}),t.value==="parent"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"job",className:"block text-sm font-medium text-gray-700",children:"Pekerjaan"}),e.jsx("input",{autoComplete:"off",id:"job",type:"text",maxLength:70,value:r.job||"",onChange:a=>i("job",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Telepon"}),e.jsx("input",{autoComplete:"off",id:"phone",type:"tel",minLength:7,maxLength:15,value:r.phone||"",onChange:y("phone"),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:["Email",t.value==="admin"?"*":""]}),e.jsx("input",{autoComplete:"off",id:"email",type:"email",value:r.email||"",onChange:a=>i("email",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:t.value==="admin"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Alamat"}),e.jsx("textarea",{id:"address",value:r.address||"",onChange:a=>i("address",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",rows:3})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status*"}),e.jsx("select",{id:"status",value:r.status,onChange:a=>i("status",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0,children:_.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:s?"Password Baru":"Password*"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{autoComplete:"off",id:"password",type:k?"text":"password",value:r.password||"",onChange:a=>i("password",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 pr-10 shadow-sm",placeholder:s?"Leave blank to keep current password":"",required:!s}),e.jsx("button",{type:"button",onClick:()=>M(a=>!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:k?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.974 9.974 0 013.276-4.568m2.743-1.68A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.974 9.974 0 01-2.47 3.63M15 12a3 3 0 00-3-3m0 0a3 3 0 013 3m-3-3l-9 9"})})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700",children:s?"Konfirmasi Password Baru":"Konfirmasi Password*"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{autoComplete:"off",id:"password_confirmation",type:N?"text":"password",value:r.password_confirmation||"",onChange:a=>i("password_confirmation",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 pr-10 shadow-sm",required:!s}),e.jsx("button",{type:"button",onClick:()=>P(a=>!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:N?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.974 9.974 0 013.276-4.568m2.743-1.68A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.974 9.974 0 01-2.47 3.63M15 12a3 3 0 00-3-3m0 0a3 3 0 013 3m-3-3l-9 9"})})})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:x,className:"mr-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:cursor-pointer hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:cursor-pointer hover:bg-blue-700",children:s?"Update":"Create"})]})]},L)}export{$ as default};
