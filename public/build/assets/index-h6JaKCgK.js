import{u as h,r as u,j as t,H as _,a as d,L as m}from"./app-CpmaffYZ.js";import{A as v}from"./action-modal-CbLa0fXX.js";import{P as E}from"./pagination-D3iJVTh2.js";import{T as S}from"./table-BhoylGfR.js";import{A as C}from"./app-layout-CpOj7c4u.js";import{t as b,T as A}from"./index-Dx2zVjDZ.js";import{f as g,p as f}from"./parseISO-C9VBp7jN.js";import{i as y}from"./id-PlgGTalb.js";/* empty css            */import"./proxy-BeD5yudl.js";import"./createLucideIcon-GMqW5Gqz.js";import"./button-Be9gNlbW.js";import"./index-B1B6wCgN.js";import"./index-CR47idHx.js";import"./index-DFum_xsG.js";import"./app-logo-icon-BVqEH_vr.js";const M=[{title:"Kegiatan",href:"/events"}];function F(){const{events:c,filters:o}=h().props,{flash:s}=h().props,[p,x]=u.useState([]),[r,l]=u.useState(null);u.useEffect(()=>{s!=null&&s.success&&b.success(s.success),s!=null&&s.error&&b.error(s.error)},[s]);const j=e=>{d.delete(`events/${e}`,{onSuccess:()=>{l(null),d.reload()}})},k=e=>{x(a=>a.includes(e)?a.filter(n=>n!==e):[...a,e])},i=e=>{const a=new Date;return new Date(`${e.start_date}T${e.start_hour}`)>a},N=e=>{d.get(route("events.index"),{sort:e,direction:o.direction==="asc"?"desc":"asc"},{preserveState:!0})},w=[{key:"name",label:"Nama Kegiatan",sortable:!0},{key:"event_pics.user.full_name",label:"PIC",sortable:!1},{key:"start_date",label:"Tanggal",sortable:!0},{key:"start_hour",label:"Waktu",sortable:!0},{key:"participants_count",label:"Peserta",sortable:!0},{key:"actions",label:"Aksi",sortable:!1}];return t.jsxs(C,{breadcrumbs:M,children:[t.jsx(_,{title:"Events"}),t.jsx(A,{position:"top-right",richColors:!0}),t.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{type:"text",placeholder:"Cari kegiatan...",defaultValue:o.search||"",onChange:e=>d.get(route("events.index"),{search:e.target.value},{preserveState:!0}),className:"w-64 rounded border px-3 py-1 text-sm"})}),t.jsx(m,{href:route("events.create"),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Buat Kegiatan"})]}),t.jsx(S,{headers:w,data:c.data,sortColumn:o.direction==="asc"||o.direction==="desc"?o.direction:"asc",onSort:N,onSelectAll:e=>x(e?c.data.map(a=>a.id):[]),selectedIds:p,rowRender:e=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"w-[10px] p-3 text-sm",children:t.jsx("input",{type:"checkbox",checked:p.includes(e.id),onChange:()=>k(e.id)})}),t.jsx("td",{className:"p-3 text-sm",children:e.name}),t.jsx("td",{className:"p-3 text-sm",children:e.event_pics.map(a=>{var n;return(n=a.user)==null?void 0:n.full_name}).filter(Boolean).join(", ")||"-"}),t.jsxs("td",{className:"p-3 text-sm",children:[g(f(e.start_date),"dd MMM yyyy",{locale:y})," -"," ",g(f(e.end_date),"dd MMM yyyy",{locale:y})]}),t.jsxs("td",{className:"p-3 text-sm",children:[e.start_hour," - ",e.end_hour]}),t.jsxs("td",{className:"p-3 text-sm",children:[e.participants_count," Siswa"]}),t.jsxs("td",{className:"flex gap-2 p-3",children:[i(e)?t.jsx(m,{href:route("events.edit",e.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600",children:"Edit"}):t.jsx("button",{className:"cursor-not-allowed rounded bg-blue-300 px-3 py-1 text-sm font-medium text-white",disabled:!0,title:"Event tidak dapat diedit",children:"Edit"}),t.jsx(m,{href:route("events.attendance",e.id),className:"rounded bg-sky-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-sky-600",children:"Kehadiran"}),t.jsx("button",{onClick:()=>i(e)&&l(e),className:`rounded px-3 py-1 text-sm font-medium text-white ${i(e)?"bg-red-500 hover:cursor-pointer hover:bg-red-600":"cursor-not-allowed bg-red-300 opacity-60"}`,disabled:!i(e),title:i(e)?"":"Event tidak dapat dihapus",children:"Hapus"})]})]},e.id),emptyMessage:"Tidak ada event yang ditemukan"}),t.jsx(E,{links:c.links}),t.jsx(v,{isOpen:!!r,onClose:()=>l(null),title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus kegiatan "${r==null?void 0:r.name}"?`,buttons:[{label:"Batal",onClick:()=>l(null),variant:"neutral"},{label:"Ya, Hapus",onClick:()=>r&&j(r.id),variant:"danger"}]})]})]})}export{F as default};
