import{R as h,r as c,j as t}from"./app-CyshOikY.js";import{$ as Y,a as Q,w as Z,e as ee,o as k,b as te}from"./use-resolve-button-type-Buwe6LOv.js";import{K as D,y as I,T as se,o as v,L as _,u as T,_ as z,O as L}from"./use-is-mounted-BIQTV9M4.js";import{c as ae,i as w,u as re,x as ne,R as le,s as oe,z as ie}from"./transition-MdUSIKLo.js";import{c as C}from"./createLucideIcon-CnvrJxFW.js";import{f as ce,p as ue}from"./parseISO-C9VBp7jN.js";import{i as de}from"./id-PlgGTalb.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],me=C("ChevronDown",pe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fe=C("CircleCheckBig",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ye=C("CircleX",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],be=C("TriangleAlert",ge);function je(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function U(e){return je(e)&&"tagName"in e}function X(e){return U(e)&&"accessKey"in e}function K(e){return U(e)&&"tabIndex"in e}function ve(e){return X(e)&&e.nodeName==="FIELDSET"}function G(e){return X(e)&&e.nodeName==="LEGEND"}function Ne(e){let s=e.parentElement,u=null;for(;s&&!ve(s);)G(s)&&(u=s),s=s.parentElement;let p=(s==null?void 0:s.getAttribute("disabled"))==="";return p&&Ee(u)?!1:p}function Ee(e){if(!e)return!1;let s=e.previousElementSibling;for(;s!==null;){if(G(s))return!1;s=s.previousElementSibling}return!0}let ke=c.createContext(()=>{});function Se({value:e,children:s}){return h.createElement(ke.Provider,{value:e},s)}var q;let we=(q=h.startTransition)!=null?q:function(e){e()};var Ce=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ce||{}),De=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))(De||{});let Ie={0:e=>({...e,disclosureState:T(e.disclosureState,{0:1,1:0})}),1:e=>e.disclosureState===1?e:{...e,disclosureState:1},2(e,s){return e.buttonId===s.buttonId?e:{...e,buttonId:s.buttonId}},3(e,s){return e.panelId===s.panelId?e:{...e,panelId:s.panelId}},4(e,s){return e.buttonElement===s.element?e:{...e,buttonElement:s.element}},5(e,s){return e.panelElement===s.element?e:{...e,panelElement:s.element}}},$=c.createContext(null);$.displayName="DisclosureContext";function P(e){let s=c.useContext($);if(s===null){let u=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,P),u}return s}let A=c.createContext(null);A.displayName="DisclosureAPIContext";function V(e){let s=c.useContext(A);if(s===null){let u=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,V),u}return s}let F=c.createContext(null);F.displayName="DisclosurePanelContext";function _e(){return c.useContext(F)}function Te(e,s){return T(s.type,Ie,e,s)}let $e=c.Fragment;function Pe(e,s){let{defaultOpen:u=!1,...p}=e,a=c.useRef(null),r=I(s,se(m=>{a.current=m},e.as===void 0||e.as===c.Fragment)),o=c.useReducer(Te,{disclosureState:u?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:n,buttonId:i},f]=o,l=v(m=>{f({type:1});let y=te(a);if(!y||!i)return;let b=m?K(m)?m:"current"in m&&K(m.current)?m.current:y.getElementById(i):y.getElementById(i);b==null||b.focus()}),d=c.useMemo(()=>({close:l}),[l]),g=c.useMemo(()=>({open:n===0,close:l}),[n,l]),j={ref:r},N=_();return h.createElement($.Provider,{value:o},h.createElement(A.Provider,{value:d},h.createElement(Se,{value:l},h.createElement(ae,{value:T(n,{0:w.Open,1:w.Closed})},N({ourProps:j,theirProps:p,slot:g,defaultTag:$e,name:"Disclosure"})))))}let Ae="button";function Fe(e,s){let u=c.useId(),{id:p=`headlessui-disclosure-button-${u}`,disabled:a=!1,autoFocus:r=!1,...o}=e,[n,i]=P("Disclosure.Button"),f=_e(),l=f===null?!1:f===n.panelId,d=c.useRef(null),g=I(d,s,v(x=>{if(!l)return i({type:4,element:x})}));c.useEffect(()=>{if(!l)return i({type:2,buttonId:p}),()=>{i({type:2,buttonId:null})}},[p,i,l]);let j=v(x=>{var E;if(l){if(n.disclosureState===1)return;switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),i({type:0}),(E=n.buttonElement)==null||E.focus();break}}else switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),i({type:0});break}}),N=v(x=>{switch(x.key){case k.Space:x.preventDefault();break}}),m=v(x=>{var E;Ne(x.currentTarget)||a||(l?(i({type:0}),(E=n.buttonElement)==null||E.focus()):i({type:0}))}),{isFocusVisible:y,focusProps:b}=Y({autoFocus:r}),{isHovered:S,hoverProps:B}=Q({isDisabled:a}),{pressed:M,pressProps:O}=Z({disabled:a}),J=c.useMemo(()=>({open:n.disclosureState===0,hover:S,active:M,disabled:a,focus:y,autofocus:r}),[n,S,M,y,a,r]),R=ee(e,n.buttonElement),W=l?z({ref:g,type:R,disabled:a||void 0,autoFocus:r,onKeyDown:j,onClick:m},b,B,O):z({ref:g,id:p,type:R,"aria-expanded":n.disclosureState===0,"aria-controls":n.panelElement?n.panelId:void 0,disabled:a||void 0,autoFocus:r,onKeyDown:j,onKeyUp:N,onClick:m},b,B,O);return _()({ourProps:W,theirProps:o,slot:J,defaultTag:Ae,name:"Disclosure.Button"})}let Be="div",Me=L.RenderStrategy|L.Static;function Oe(e,s){let u=c.useId(),{id:p=`headlessui-disclosure-panel-${u}`,transition:a=!1,...r}=e,[o,n]=P("Disclosure.Panel"),{close:i}=V("Disclosure.Panel"),[f,l]=c.useState(null),d=I(s,v(S=>{we(()=>n({type:5,element:S}))}),l);c.useEffect(()=>(n({type:3,panelId:p}),()=>{n({type:3,panelId:null})}),[p,n]);let g=re(),[j,N]=ne(a,f,g!==null?(g&w.Open)===w.Open:o.disclosureState===0),m=c.useMemo(()=>({open:o.disclosureState===0,close:i}),[o.disclosureState,i]),y={ref:d,id:p,...le(N)},b=_();return h.createElement(oe,null,h.createElement(F.Provider,{value:o.panelId},b({ourProps:y,theirProps:r,slot:m,defaultTag:Be,features:Me,visible:j,name:"Disclosure.Panel"})))}let Re=D(Pe),ze=D(Fe),Le=D(Oe),H=Object.assign(Re,{Button:ze,Panel:Le});const We=({subjectAttendances:e,onEdit:s})=>{const u=e.reduce((a,r)=>(a[r.submit_date]||(a[r.submit_date]=[]),a[r.submit_date].push(r),a),{}),p=a=>{const r=u[a]||[],o=r.length,n=r.filter(l=>["present","late"].includes(l.status)).length,i=r.filter(l=>l.status==="late").length,f=r.filter(l=>["alpha","leave","sick_leave","day_off"].includes(l.status)).length;return{total:o,presentCount:n,lateCount:i,absentCount:f,perfect:n===o&&i===0,hasLate:i>0,hasAbsent:f>0}};return t.jsx("div",{className:"w-full overflow-x-auto rounded-lg border",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tanggal"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tahun Ajaran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Ringkasan Kehadiran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Aksi"})]})}),t.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white",children:[Object.entries(u).sort(([a],[r])=>+new Date(r)-+new Date(a)).map(([a,r])=>{var i,f;const o=p(a),n=((f=(i=r[0])==null?void 0:i.academic_year)==null?void 0:f.title)||"-";return t.jsx(H,{as:h.Fragment,children:({open:l})=>t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium whitespace-nowrap text-gray-900",children:ce(ue(a),"EEE, dd MMM yyyy",{locale:de})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:n}),t.jsx("td",{className:"px-4 py-3 text-sm",children:o.perfect?t.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[t.jsx(fe,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Hadir sempurna (",o.presentCount,"/",o.total,")"]})]}):o.hasLate?t.jsxs("div",{className:"flex items-center gap-3 text-yellow-600",children:[t.jsx(be,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Terlambat di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]})]}):o.hasAbsent?t.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[t.jsx(ye,{className:"h-5 w-5 shrink-0"}),"Tidak hadir di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]}):t.jsx("span",{children:"Belum ada data kehadiran"})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:t.jsxs(H.Button,{className:"flex items-center text-blue-600 hover:cursor-pointer hover:text-blue-800 focus:outline-none",children:[t.jsx("span",{className:"mr-1",children:l?"Tutup":"Detail"}),t.jsx(me,{className:`h-5 w-5 transform transition-transform duration-300 ${l?"rotate-180":"rotate-0"}`})]})})]}),t.jsx(ie,{show:l,enter:"transition duration-300 ease-out",enterFrom:"transform scale-y-0 opacity-0",enterTo:"transform scale-y-100 opacity-100",leave:"transition duration-200 ease-in",leaveFrom:"transform scale-y-100 opacity-100",leaveTo:"transform scale-y-0 opacity-0",className:"origin-top",as:h.Fragment,children:t.jsx("tr",{className:"bg-gray-50",children:t.jsx("td",{colSpan:4,className:"px-6 py-4",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Mata Pelajaran"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Waktu"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Absen Masuk"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Catatan"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:r.map(d=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:d.subject_name}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[d.subject_start_hour_formatted," - ",d.subject_end_hour_formatted]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:d.submit_hour_formatted||"-"}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600 capitalize",children:[d.status.replace(/_/g," "),d.day_off_reason&&t.jsxs("div",{className:"text-xs text-gray-400",children:["(",d.day_off_reason,")"]})]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:d.note||"-"}),t.jsx("td",{className:"px-4 py-2 text-sm",children:t.jsx("button",{onClick:()=>s(d),className:"rounded bg-blue-500 px-3 py-1 text-sm text-white hover:cursor-pointer hover:bg-blue-600",children:"Ubah"})})]},d.id))})]})})})})]})},a)}),Object.keys(u).length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500",children:"Tidak ada data kehadiran untuk bulan ini"})})]})]})})};export{We as default};
