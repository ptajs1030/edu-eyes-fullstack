import{u as T,r,j as e,H as K,a as o}from"./app-x9ITRrwy.js";import{A as M}from"./app-layout-Bjw56Jj7.js";import{t as j,T as H}from"./index-BZrGXtxQ.js";import{m as I}from"./constants-B8--eSm4.js";import O from"./editShiftModal-C0dbKyJr.js";import B from"./editSubjectModal-BX63mrqu.js";import F from"./shiftAttendanceTable-DhiFp3lP.js";import P from"./subjectAttendanceTable-DWHhhHDm.js";/* empty css            */import"./button-sNa4QLv-.js";import"./index-C0TBFQwA.js";import"./index-DdgjMu3s.js";import"./index-Cq_yryd7.js";import"./createLucideIcon-R1LtfOPn.js";import"./app-logo-icon-CVtrWIeB.js";import"./form-modal-B1vkh4cH.js";import"./proxy-BLEjzyUF.js";import"./searchable-select-C-dgFeEK.js";import"./parseISO-C9VBp7jN.js";import"./id-PlgGTalb.js";import"./use-resolve-button-type-DRlxTGsI.js";import"./use-is-mounted-DzuD1Tyo.js";import"./transition-_q_PWBtY.js";import"./chevron-down-COZ0R95o.js";const R=(t,c)=>[{title:"Siswa",href:"/students"},{title:t,href:`/students/${c}/attendance`},{title:"Histori Kehadiran"}];function ce({student:t,academicYears:c,filters:i,dayOffOptions:p,attendanceMode:x,shiftAttendances:f=[],shiftStatistics:b={},subjectAttendances:_=[],subjectStatistics:g={}}){const{flash:l}=T().props,[v,u]=r.useState(!1),[S,m]=r.useState(!1),[n,N]=r.useState(null),[d,y]=r.useState(null);r.useEffect(()=>{l!=null&&l.success&&j.success(l.success),l!=null&&l.error&&j.error(l.error)},[l]);const h=(s,a)=>{o.get(route("students.attendance",t.id),{...i,[s]:a},{preserveState:!0})},k=s=>{N(s),u(!0)},E=s=>{y(s),m(!0)},w=s=>{const a={clock_in_hour:s.clock_in_hour_formatted||null,clock_out_hour:s.clock_out_hour_formatted||null,status:s.status,minutes_of_late:s.minutes_of_late||null,note:s.note||null,day_off_reason:s.day_off_reason||null};o.patch(route("students.attendance.shift.save",n==null?void 0:n.id),a,{preserveScroll:!0,onSuccess:()=>{u(!1),o.reload()}})},A=s=>{const a={submit_hour:s.submit_hour_formatted||null,status:s.status,note:s.note||null,day_off_reason:s.day_off_reason||null};o.patch(route("students.attendance.subject.save",d==null?void 0:d.id),a,{preserveScroll:!0,onSuccess:()=>{m(!1),o.reload()}})},C=x==="per-shift"?b:g;return e.jsxs(M,{breadcrumbs:R(t.full_name,t.id),children:[e.jsx(K,{title:`Riwayat Kehadiran - ${t.full_name}`}),e.jsx(H,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Informasi Siswa"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Nama"}),e.jsx("p",{children:t.full_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Kelas"}),e.jsx("p",{children:t.classroom.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Wali Kelas"}),e.jsx("p",{children:t.classroom.main_teacher.full_name})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Filter"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tahun Ajaran"}),e.jsxs("select",{value:i.academic_year_id,onChange:s=>h("academic_year_id",s.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Pilih Tahun Ajaran"}),c.map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bulan"}),e.jsx("select",{value:i.month,onChange:s=>h("month",s.target.value),className:"w-full rounded border p-2",children:I.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tahun"}),e.jsx("input",{type:"number",value:i.year,onChange:s=>h("year",s.target.value),className:"w-full rounded border p-2"})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Statistik Kehadiran (Bulan Ini)"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-7",children:Object.entries(C).map(([s,a])=>e.jsxs("div",{className:"rounded bg-gray-100 p-3 text-center",children:[e.jsx("p",{className:"text-lg font-bold",children:a}),e.jsx("p",{className:"capitalize",children:s.replace(/_/g," ")})]},s))})]}),x==="per-shift"?e.jsx(F,{shiftAttendances:f,onEdit:k}):e.jsx(P,{subjectAttendances:_,onEdit:E}),v&&e.jsx(O,{attendance:n,dayOffOptions:p,onClose:()=>u(!1),onSubmit:w}),S&&e.jsx(B,{attendance:d,dayOffOptions:p,onClose:()=>m(!1),onSubmit:A})]})]})}export{ce as default};
