import{j as e,r as o,m as d,q as S,$}from"./app-V1Umm8Rk.js";import{m as N}from"./proxy-BltTgupC.js";import{t as b,T as L}from"./index-D6ukpaZx.js";import{c as k}from"./app-logo-icon-B1P7fFv2.js";import{A as P}from"./app-layout-BHTKQTHi.js";/* empty css            */import"./index-eyrldQVL.js";import"./button-IN9KUCQP.js";import"./index-rXZuRgUh.js";import"./index-CErprLQ1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],M=k("ChevronDown",I);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],R=k("ChevronUp",T);function q({isDeleteModalOpen:m,setIsDeleteModalOpen:l,handleDelete:n,announcementToDelete:s}){return m&&e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-black/30 z-50",children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.1},className:"bg-white p-6 rounded-lg w-full max-w-xl shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirm Deletion"}),e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:s==null?void 0:s.title}),"?"]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-300 rounded hover:cursor-pointer",children:"Cancel"}),e.jsx("button",{onClick:()=>{s&&n(s.id),l(!1)},className:"px-4 py-2 bg-red-500 text-white rounded hover:cursor-pointer",children:"Confirm"})]})]})})}function z({isOpen:m,closeModal:l,announcement:n}){const[s,p]=o.useState({title:"",content:"",picture:""}),[a,x]=o.useState(null),[j,h]=o.useState("");o.useEffect(()=>{n?(p({title:n.title,content:n.content,picture:n.picture||""}),h(n.picture||""),x(null)):(p({title:"",content:"",picture:""}),h(""),x(null))},[n]);const f=u=>{p({...s,[u.target.name]:u.target.value})},v=u=>{var i;const r=(i=u.target.files)==null?void 0:i[0];r&&(x(r),h(URL.createObjectURL(r)))},g=u=>{u.preventDefault();const r=new FormData;r.append("title",s.title),r.append("content",s.content),a&&r.append("picture",a),n?(r.append("_method","PUT"),d.post(`/announcements/${n.id}`,r,{onSuccess:()=>{l(),b.success("Announcement updated successfully."),d.reload()},onError:i=>{b.error("Failed to update announcement."),console.error(i.message||"Failed to update announcement.")}})):d.post("/announcements",r,{onSuccess:()=>{l(),b.success("Announcement created successfully."),d.reload()},onError:i=>{b.error("Failed to create announcement."),console.error(i.message||"Failed to create announcement.")}})};return m?e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.1},className:"w-full max-w-xl rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:n?"Edit Announcement":"Adding Announcement"}),e.jsxs("form",{onSubmit:g,encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:s.title,onChange:f,className:"w-full rounded border p-2",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Content"}),e.jsx("textarea",{id:"content",name:"content",value:s.content,onChange:f,className:"h-50 w-full rounded border p-2",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"picture",className:"block text-sm font-medium text-gray-700",children:"Picture (optional)"}),e.jsx("input",{type:"file",id:"picture",name:"picture",onChange:v,accept:"image/*",className:"w-full"})]}),j&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-small mb-1",children:"Image Preview:"}),e.jsx("img",{src:j,alt:"Preview",className:"h-32 w-32 rounded object-cover"})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:l,className:"mr-2 rounded bg-gray-500 px-4 py-2 text-white hover:cursor-pointer",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded bg-blue-600 px-4 py-2 text-white hover:cursor-pointer",children:n?"Update":"Create"})]})]})]})}):null}const Z=({options:m,onSortChange:l})=>{const[n,s]=o.useState(!1),p=a=>{l(a.sort,a.direction),s(!1)};return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsxs("button",{onClick:()=>s(!n),className:"inline-flex items-center gap-1 text-blue-600 hover:underline text-sm",children:["Sort",n?e.jsx(R,{className:"w-4 h-4"}):e.jsx(M,{className:"w-4 h-4"})]}),n&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:m.map((a,x)=>e.jsx("button",{onClick:()=>p(a.value),className:"w-full px-4 py-2 text-sm text-left hover:bg-gray-100",children:a.label},x))})]})},B=[{title:"Announcements",href:"/announcements"}];function te(){const m=[{label:"Title (A-Z)",value:{sort:"title",direction:"asc"}},{label:"Title (Z-A)",value:{sort:"title",direction:"desc"}},{label:"Created At (Newest)",value:{sort:"created_at",direction:"desc"}},{label:"Created At (Oldest)",value:{sort:"created_at",direction:"asc"}}],{announcements:l,filters:n}=S().props,{flash:s}=S().props;o.useEffect(()=>{s!=null&&s.success&&b.success(s.success),s!=null&&s.error&&b.error(s.error)},[s]);const[p,a]=o.useState(!1),[x,j]=o.useState(null),[h,f]=o.useState([]),[v,g]=o.useState(!1),[u,r]=o.useState(null),i=(t=null)=>{j(t),a(!0)},A=async t=>{d.delete(`/announcements/${t}`,{onSuccess:()=>{d.reload()}})},F=t=>{f(c=>c.includes(t)?c.filter(w=>w!==t):[...c,t])},E=()=>{const t=l.data.filter(y=>h.includes(y.id)),c=`Title,Content
`,w=t.map(y=>`${y.title},${y.content}`).join(`
`),_=new Blob([c,w],{type:"text/csv"}),U=URL.createObjectURL(_),C=document.createElement("a");C.href=U,C.download="announcements.csv",C.click()},D=t=>{d.get("/announcements",{...n||{},search:t.target.value},{preserveState:!0,replace:!0})},O=(t,c)=>{d.get("/announcements",{...n,sort:t,direction:c},{preserveState:!0,replace:!0})};return e.jsxs(P,{breadcrumbs:B,children:[e.jsx($,{title:"Announcements"}),e.jsx(L,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",defaultValue:n.search||"",onChange:D,placeholder:"Search by title...",className:"w-64 rounded border px-3 py-1"}),e.jsx(Z,{options:m,onSortChange:O}),e.jsx("button",{onClick:E,className:"rounded bg-indigo-600 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Export Selected"})]}),e.jsx("button",{onClick:()=>i(),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Add Announcement"})]}),e.jsxs("table",{className:"w-full border-collapse rounded-lg bg-white text-black shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-100 text-gray-800",children:[e.jsx("th",{className:"p-4",children:e.jsx("input",{type:"checkbox",onChange:t=>f(t.target.checked?l.data.map(c=>c.id):[])})}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Picture"}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Title"}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Content"}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:l.data.length>0?l.data.map(t=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",checked:h.includes(t.id),onChange:()=>F(t.id)})}),e.jsx("td",{className:"p-3",children:t.picture?e.jsx("img",{src:t.picture,alt:"announcement",className:"h-16 w-16 rounded-full object-cover"}):"No Picture"}),e.jsx("td",{className:"p-3",children:t.title}),e.jsx("td",{className:"p-3",children:t.content}),e.jsxs("td",{className:"flex gap-2 p-3",children:[e.jsx("button",{onClick:()=>i(t),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Edit"}),e.jsx("button",{onClick:()=>{r(t),g(!0)},className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Delete"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-600",children:"No announcements found."})})})]}),e.jsx("div",{className:"mt-4 flex justify-center gap-2",children:l.links.map((t,c)=>e.jsx("button",{onClick:()=>t.url&&d.visit(t.url),disabled:!t.url,className:`rounded px-3 py-1 text-sm hover:cursor-pointer ${t.active?"bg-blue-500 text-white":"bg-gray-100 text-black"}`,dangerouslySetInnerHTML:{__html:t.label}},c))})]}),e.jsx(z,{isOpen:p,closeModal:()=>a(!1),announcement:x}),e.jsx(q,{isDeleteModalOpen:v,setIsDeleteModalOpen:g,handleDelete:A,announcementToDelete:u})]})}export{te as default};
