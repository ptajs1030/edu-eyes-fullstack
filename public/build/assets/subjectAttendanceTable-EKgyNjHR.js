import{R as h,r as c,j as t}from"./app-BoAFDmgT.js";import{$ as Y,a as Q,w as Z,e as ee,o as S,b as te}from"./use-resolve-button-type-C4roS6gh.js";import{K as C,y as D,T as ae,o as v,L as I,u as T,_ as z,O as L}from"./use-is-mounted-COag9C6h.js";import{c as se,i as w,u as re,x as ne,R as le,s as oe,z as ie}from"./transition-BTcoM1WU.js";import{c as _}from"./createLucideIcon-CZ4Nq8AV.js";import{C as ce}from"./chevron-down-DeRlasnV.js";import{f as ue,p as de}from"./parseISO-C9VBp7jN.js";import{i as pe}from"./id-PlgGTalb.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xe=_("CircleCheckBig",me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],he=_("CircleX",fe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ge=_("TriangleAlert",ye);function be(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function U(e){return be(e)&&"tagName"in e}function X(e){return U(e)&&"accessKey"in e}function K(e){return U(e)&&"tabIndex"in e}function je(e){return X(e)&&e.nodeName==="FIELDSET"}function G(e){return X(e)&&e.nodeName==="LEGEND"}function ve(e){let a=e.parentElement,u=null;for(;a&&!je(a);)G(a)&&(u=a),a=a.parentElement;let p=(a==null?void 0:a.getAttribute("disabled"))==="";return p&&Ne(u)?!1:p}function Ne(e){if(!e)return!1;let a=e.previousElementSibling;for(;a!==null;){if(G(a))return!1;a=a.previousElementSibling}return!0}let Ee=c.createContext(()=>{});function Se({value:e,children:a}){return h.createElement(Ee.Provider,{value:e},a)}var q;let ke=(q=h.startTransition)!=null?q:function(e){e()};var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))(Ce||{});let De={0:e=>({...e,disclosureState:T(e.disclosureState,{0:1,1:0})}),1:e=>e.disclosureState===1?e:{...e,disclosureState:1},2(e,a){return e.buttonId===a.buttonId?e:{...e,buttonId:a.buttonId}},3(e,a){return e.panelId===a.panelId?e:{...e,panelId:a.panelId}},4(e,a){return e.buttonElement===a.element?e:{...e,buttonElement:a.element}},5(e,a){return e.panelElement===a.element?e:{...e,panelElement:a.element}}},P=c.createContext(null);P.displayName="DisclosureContext";function $(e){let a=c.useContext(P);if(a===null){let u=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,$),u}return a}let A=c.createContext(null);A.displayName="DisclosureAPIContext";function V(e){let a=c.useContext(A);if(a===null){let u=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,V),u}return a}let F=c.createContext(null);F.displayName="DisclosurePanelContext";function Ie(){return c.useContext(F)}function Te(e,a){return T(a.type,De,e,a)}let _e=c.Fragment;function Pe(e,a){let{defaultOpen:u=!1,...p}=e,s=c.useRef(null),r=D(a,ae(m=>{s.current=m},e.as===void 0||e.as===c.Fragment)),o=c.useReducer(Te,{disclosureState:u?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:n,buttonId:i},f]=o,l=v(m=>{f({type:1});let y=te(s);if(!y||!i)return;let b=m?K(m)?m:"current"in m&&K(m.current)?m.current:y.getElementById(i):y.getElementById(i);b==null||b.focus()}),d=c.useMemo(()=>({close:l}),[l]),g=c.useMemo(()=>({open:n===0,close:l}),[n,l]),j={ref:r},N=I();return h.createElement(P.Provider,{value:o},h.createElement(A.Provider,{value:d},h.createElement(Se,{value:l},h.createElement(se,{value:T(n,{0:w.Open,1:w.Closed})},N({ourProps:j,theirProps:p,slot:g,defaultTag:_e,name:"Disclosure"})))))}let $e="button";function Ae(e,a){let u=c.useId(),{id:p=`headlessui-disclosure-button-${u}`,disabled:s=!1,autoFocus:r=!1,...o}=e,[n,i]=$("Disclosure.Button"),f=Ie(),l=f===null?!1:f===n.panelId,d=c.useRef(null),g=D(d,a,v(x=>{if(!l)return i({type:4,element:x})}));c.useEffect(()=>{if(!l)return i({type:2,buttonId:p}),()=>{i({type:2,buttonId:null})}},[p,i,l]);let j=v(x=>{var E;if(l){if(n.disclosureState===1)return;switch(x.key){case S.Space:case S.Enter:x.preventDefault(),x.stopPropagation(),i({type:0}),(E=n.buttonElement)==null||E.focus();break}}else switch(x.key){case S.Space:case S.Enter:x.preventDefault(),x.stopPropagation(),i({type:0});break}}),N=v(x=>{switch(x.key){case S.Space:x.preventDefault();break}}),m=v(x=>{var E;ve(x.currentTarget)||s||(l?(i({type:0}),(E=n.buttonElement)==null||E.focus()):i({type:0}))}),{isFocusVisible:y,focusProps:b}=Y({autoFocus:r}),{isHovered:k,hoverProps:B}=Q({isDisabled:s}),{pressed:M,pressProps:O}=Z({disabled:s}),J=c.useMemo(()=>({open:n.disclosureState===0,hover:k,active:M,disabled:s,focus:y,autofocus:r}),[n,k,M,y,s,r]),R=ee(e,n.buttonElement),W=l?z({ref:g,type:R,disabled:s||void 0,autoFocus:r,onKeyDown:j,onClick:m},b,B,O):z({ref:g,id:p,type:R,"aria-expanded":n.disclosureState===0,"aria-controls":n.panelElement?n.panelId:void 0,disabled:s||void 0,autoFocus:r,onKeyDown:j,onKeyUp:N,onClick:m},b,B,O);return I()({ourProps:W,theirProps:o,slot:J,defaultTag:$e,name:"Disclosure.Button"})}let Fe="div",Be=L.RenderStrategy|L.Static;function Me(e,a){let u=c.useId(),{id:p=`headlessui-disclosure-panel-${u}`,transition:s=!1,...r}=e,[o,n]=$("Disclosure.Panel"),{close:i}=V("Disclosure.Panel"),[f,l]=c.useState(null),d=D(a,v(k=>{ke(()=>n({type:5,element:k}))}),l);c.useEffect(()=>(n({type:3,panelId:p}),()=>{n({type:3,panelId:null})}),[p,n]);let g=re(),[j,N]=ne(s,f,g!==null?(g&w.Open)===w.Open:o.disclosureState===0),m=c.useMemo(()=>({open:o.disclosureState===0,close:i}),[o.disclosureState,i]),y={ref:d,id:p,...le(N)},b=I();return h.createElement(oe,null,h.createElement(F.Provider,{value:o.panelId},b({ourProps:y,theirProps:r,slot:m,defaultTag:Fe,features:Be,visible:j,name:"Disclosure.Panel"})))}let Oe=C(Pe),Re=C(Ae),ze=C(Me),H=Object.assign(Oe,{Button:Re,Panel:ze});const We=({subjectAttendances:e,onEdit:a})=>{const u=e.reduce((s,r)=>(s[r.submit_date]||(s[r.submit_date]=[]),s[r.submit_date].push(r),s),{}),p=s=>{const r=u[s]||[],o=r.length,n=r.filter(l=>["present","late"].includes(l.status)).length,i=r.filter(l=>l.status==="late").length,f=r.filter(l=>["alpha","leave","sick_leave","day_off"].includes(l.status)).length;return{total:o,presentCount:n,lateCount:i,absentCount:f,perfect:n===o&&i===0,hasLate:i>0,hasAbsent:f>0}};return t.jsx("div",{className:"w-full overflow-x-auto rounded-lg border",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tanggal"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tahun Ajaran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Ringkasan Kehadiran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Aksi"})]})}),t.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white",children:[Object.entries(u).sort(([s],[r])=>+new Date(r)-+new Date(s)).map(([s,r])=>{var i,f;const o=p(s),n=((f=(i=r[0])==null?void 0:i.academic_year)==null?void 0:f.title)||"-";return t.jsx(H,{as:h.Fragment,children:({open:l})=>t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium whitespace-nowrap text-gray-900",children:ue(de(s),"EEE, dd MMM yyyy",{locale:pe})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:n}),t.jsx("td",{className:"px-4 py-3 text-sm",children:o.perfect?t.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[t.jsx(xe,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Hadir sempurna (",o.presentCount,"/",o.total,")"]})]}):o.hasLate?t.jsxs("div",{className:"flex items-center gap-3 text-yellow-600",children:[t.jsx(ge,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Terlambat di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]})]}):o.hasAbsent?t.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[t.jsx(he,{className:"h-5 w-5 shrink-0"}),"Tidak hadir di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]}):t.jsx("span",{children:"Belum ada data kehadiran"})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:t.jsxs(H.Button,{className:"flex items-center text-blue-600 hover:cursor-pointer hover:text-blue-800 focus:outline-none",children:[t.jsx("span",{className:"mr-1",children:l?"Tutup":"Detail"}),t.jsx(ce,{className:`h-5 w-5 transform transition-transform duration-300 ${l?"rotate-180":"rotate-0"}`})]})})]}),t.jsx(ie,{show:l,enter:"transition duration-300 ease-out",enterFrom:"transform scale-y-0 opacity-0",enterTo:"transform scale-y-100 opacity-100",leave:"transition duration-200 ease-in",leaveFrom:"transform scale-y-100 opacity-100",leaveTo:"transform scale-y-0 opacity-0",className:"origin-top",as:h.Fragment,children:t.jsx("tr",{className:"bg-gray-50",children:t.jsx("td",{colSpan:4,className:"px-6 py-4",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Mata Pelajaran"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Waktu"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Absen Masuk"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Catatan"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:r.map(d=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:d.subject_name}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[d.subject_start_hour_formatted," - ",d.subject_end_hour_formatted]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:d.submit_hour_formatted||"-"}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600 capitalize",children:[d.status.replace(/_/g," "),d.day_off_reason&&t.jsxs("div",{className:"text-xs text-gray-400",children:["(",d.day_off_reason,")"]})]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:d.note||"-"}),t.jsx("td",{className:"px-4 py-2 text-sm",children:t.jsx("button",{onClick:()=>a(d),className:"rounded bg-blue-500 px-3 py-1 text-sm text-white hover:cursor-pointer hover:bg-blue-600",children:"Ubah"})})]},d.id))})]})})})})]})},s)}),Object.keys(u).length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500",children:"Tidak ada data kehadiran untuk bulan ini"})})]})]})})};export{We as default};
