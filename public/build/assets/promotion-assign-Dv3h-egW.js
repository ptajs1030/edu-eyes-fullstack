import{u as P,r as o,j as e,H as K,L as z,a as I}from"./app-Dwy6WXrN.js";import{A as R}from"./action-modal-CYiOwsOm.js";import{A as T}from"./app-layout-DtfI_7ga.js";import{t as N,T as $}from"./index-1TBG1X3O.js";/* empty css            */import"./proxy-v70Swg85.js";import"./button-DE_zN_8H.js";import"./index-Cv1cY6Iw.js";import"./index-BM-VIJWr.js";import"./index-CRagEzsh.js";import"./createLucideIcon-Cw2TyyBi.js";import"./app-logo-icon-BgxRxKW3.js";function X({currentClass:r,students:k,targetClassOptions:c,isHighestLevel:f,unassignedCount:p,incomingStudents:h}){const{flash:i}=P().props,[n,v]=o.useState(k),[m,u]=o.useState([]),[d,j]=o.useState(""),[y,x]=o.useState(!1);o.useEffect(()=>{i!=null&&i.success?N.success(i.success):i!=null&&i.error&&N.error(i.error)},[i]);const S=s=>{u(l=>l.includes(s)?l.filter(t=>t!==s):[...l,s])},_=s=>{u(s?n.map(l=>l.id):[])},g=(s,l,t)=>{v(a=>a.map(b=>b.id===s?{...b,[l]:t}:b))},w=()=>{d&&(v(s=>s.map(l=>m.includes(l.id)?d==="graduate"?{...l,target_class_id:null,is_graduate:!0}:d==="null"?{...l,target_class_id:null,is_graduate:!1}:{...l,target_class_id:parseInt(d),is_graduate:!1}:l)),j(""),u([]))},A=()=>{I.post(route("grade-promotions.update",r.id),{students:n})},B=()=>{const s=c.filter(a=>a.level===r.level).map(a=>({value:a.id,label:a.name})),l=c.filter(a=>a.level===r.level+1).map(a=>({value:a.id,label:a.name})),t=[{value:"",label:"Belum Ditentukan"},...s,...l];return f&&t.push({value:"graduate",label:"Lulus"}),t},C=()=>{const s=c.filter(a=>a.level===r.level).map(a=>({value:a.id,label:`Pindah ke ${a.name}`})),l=c.filter(a=>a.level===r.level+1).map(a=>({value:a.id,label:`Pindah ke ${a.name}`})),t=[{value:"null",label:"Pilih Aksi Massal"},...s,...l];return f&&t.push({value:"graduate",label:"Luluskan"}),t},L=s=>s.is_graduate?"bg-purple-50 border-purple-200":s.target_class_id?"bg-green-50 border-green-200":"bg-white border",M=[{title:"Kenaikan Kelas",href:"/grade-promotions"},{title:"Atur Siswa"}];return e.jsxs(T,{breadcrumbs:M,children:[e.jsx(K,{title:`Promosi Kelas - ${r.name}`}),e.jsx($,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Atur Promosi Kelas ",r.name]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[n.length===0?e.jsx("div",{className:"rounded-lg bg-green-50 p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:"Kelas ini tidak memiliki siswa"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",p===0?"Selesai":"Belum Selesai"]})]})})}):e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Siswa Kelas ",r.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:m.length===n.length&&n.length>0,onChange:s=>_(s.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Pilih Semua"]}),e.jsx("select",{value:d,onChange:s=>j(s.target.value),className:"rounded border px-3 py-1 text-sm",children:C().map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("button",{onClick:w,disabled:!d||m.length===0,className:"rounded-md bg-blue-600 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-700 disabled:opacity-50",children:"Terapkan"})]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:n.map(s=>e.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-3 ${L(s)}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:m.includes(s.id),onChange:()=>S(s.id),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["NIS: ",s.nis||"-"]})]})]}),e.jsx("select",{value:s.is_graduate?"graduate":s.target_class_id||"",onChange:l=>{l.target.value==="graduate"?(g(s.id,"is_graduate",!0),g(s.id,"target_class_id",null)):(g(s.id,"is_graduate",!1),g(s.id,"target_class_id",l.target.value?parseInt(l.target.value):null))},className:"rounded border px-2 py-1 text-sm",children:B().map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]},s.id))})}),p>0?e.jsxs("div",{className:"mt-4 flex items-center rounded-lg bg-yellow-50 p-3 text-sm text-yellow-700",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsxs("span",{children:["Siswa belum ditentukan: ",p]})]}):e.jsxs("div",{className:"mt-4 flex items-center rounded-lg bg-green-50 p-3 text-sm text-green-700",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Siswa selesai ditentukan"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Siswa yang Akan Masuk"}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:h.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:h.map(s=>e.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-3",children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsxs("div",{className:"mt-1 flex justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["NIS: ",s.nis||"-"]}),e.jsxs("span",{children:["Dari: ",s.initial_class_name]})]})]},s.id))}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:"Belum ada siswa yang akan masuk ke kelas ini"})}),e.jsxs("div",{className:"mt-4 rounded-lg bg-blue-50 p-3 text-sm text-blue-700",children:["Total Siswa Masuk: ",h.length]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>x(!0),className:"rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-green-700",children:"Simpan Perubahan"}),e.jsx(z,{href:route("grade-promotions.index"),className:"rounded-md bg-gray-200 px-4 py-2 text-sm font-medium text-gray-800 hover:bg-gray-300",children:"Kembali"})]})]}),e.jsx(R,{isOpen:y,onClose:()=>x(!1),title:"Konfirmasi Simpan",message:"Apakah Anda yakin ingin menyimpan perubahan promosi kelas ini?",buttons:[{label:"Batal",onClick:()=>x(!1),variant:"neutral"},{label:"Simpan",onClick:()=>{A(),x(!1)},variant:"primary"}]})]})}export{X as default};
