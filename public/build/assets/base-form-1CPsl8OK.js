import{r as c,j as e,a as _}from"./app-CvrC6elp.js";import{F as C}from"./form-modal-41a4gwI4.js";import{t as g}from"./index-DJjf4RqA.js";/* empty css            */import"./proxy-BDbWOOOw.js";import"./index-FDENQIDP.js";function E({isOpen:w,onClose:p,user:s,statuses:j,role:t,routePrefix:f}){const[r,m]=c.useState({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:t.id,status:"active",...t.value==="admin"||t.value==="teacher"?{nip:"",position:""}:{},...t.value==="parent"?{job:""}:{},address:""}),[h,u]=c.useState(null),[v,x]=c.useState(!1),b=c.useRef(null);c.useEffect(()=>{s?(m({...s,password:"",password_confirmation:""}),s.profile_picture&&u(`/storage/${s.profile_picture}`)):(m({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:t.id,status:"active",...t.value==="admin"||t.value==="teacher"?{nip:"",position:""}:{},...t.value==="parent"?{job:""}:{},address:""}),u(null)),x(!1)},[s,t.id]);const l=(a,o)=>{m(i=>({...i,[a]:o}))},N=a=>{var i;const o=(i=a.target.files)==null?void 0:i[0];if(o){const d=new FileReader;d.onloadend=()=>{u(d.result)},d.readAsDataURL(o),m(n=>({...n,profile_picture:o})),x(!1)}},y=()=>{u(null),m(a=>({...a,profile_picture:void 0})),x(!0),b.current&&(b.current.value="")},k=a=>{a.preventDefault();const o=new FormData;Object.entries(r).forEach(([d,n])=>{n!=null&&o.append(d,n)}),v&&o.append("remove_profile_picture","1"),s!=null&&s.id&&o.append("_method","PUT");const i=s!=null&&s.id?route(`${f}.update`,s.id):route(`${f}.store`);_.post(i,o,{preserveScroll:!0,onSuccess:()=>{p(),g.success(s?`${t.name} updated successfully`:`New ${t.name} created successfully`)},onError:d=>{const n=Object.values(d).join(`
`);g.error(`Operation failed: ${n}`)},headers:{"Content-Type":"multipart/form-data"}})};return e.jsxs(C,{isOpen:w,onClose:p,title:s?`Edit ${t.name}`:`Add New ${t.name}`,onSubmit:k,children:[e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-24 w-24 items-center justify-center overflow-hidden rounded-full border-2 border-gray-300 bg-gray-100",children:h?e.jsx("img",{src:h,alt:"Profile preview",className:"h-full w-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(h||(s==null?void 0:s.profile_picture)&&!v)&&e.jsx("button",{type:"button",onClick:y,className:"absolute -top-2 -right-2 rounded-full bg-red-500 p-1 text-white hover:cursor-pointer hover:bg-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("label",{className:"mt-2 cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("span",{children:"Upload Photo"}),e.jsx("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:N})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 2MB (300x300)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("input",{type:"text",value:t.name,disabled:!0,className:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 p-2 shadow-sm"}),e.jsx("input",{type:"hidden",name:"role_id",value:t.id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name*"}),e.jsx("input",{id:"full_name",type:"text",value:r.full_name,onChange:a=>l("full_name",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username*"}),e.jsx("input",{id:"username",type:"text",value:r.username,onChange:a=>l("username",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),(t.value==="admin"||t.value==="teacher")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"nip",className:"block text-sm font-medium text-gray-700",children:"NIP"}),e.jsx("input",{id:"nip",type:"text",value:r.nip||"",onChange:a=>l("nip",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Position"}),e.jsx("input",{id:"position",type:"text",value:r.position||"",onChange:a=>l("position",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]})]}),t.value==="parent"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"job",className:"block text-sm font-medium text-gray-700",children:"Job"}),e.jsx("input",{id:"job",type:"text",value:r.job||"",onChange:a=>l("job",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("input",{id:"phone",type:"tel",value:r.phone||"",onChange:a=>l("phone",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:r.email||"",onChange:a=>l("email",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("textarea",{id:"address",value:r.address||"",onChange:a=>l("address",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",rows:3})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status*"}),e.jsx("select",{id:"status",value:r.status,onChange:a=>l("status",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0,children:j.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:s?"New Password":"Password*"}),e.jsx("input",{id:"password",type:"password",value:r.password||"",onChange:a=>l("password",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",placeholder:s?"Leave blank to keep current password":"",required:!s})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700",children:s?"Confirm New Password":"Confirm Password*"}),e.jsx("input",{id:"password_confirmation",type:"password",value:r.password_confirmation||"",onChange:a=>l("password_confirmation",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!s})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:p,className:"mr-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:cursor-pointer hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:cursor-pointer hover:bg-blue-700",children:s?"Update":"Create"})]})]})}export{E as default};
