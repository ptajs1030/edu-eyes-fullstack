import{r as d,j as e,a as h}from"./app-vEdtwNW7.js";import{A as k}from"./action-modal-j6J48rUB.js";import{F as w}from"./form-modal-DxTSCgsT.js";import{t as u}from"./index-B7XEl1Qj.js";/* empty css            */import"./proxy-UnotoAeQ.js";import"./index-CjDXsFZL.js";function E({isOpen:r,closeModal:m,academicYear:t,attendanceModes:g}){const s=(t==null?void 0:t.status)==="complete",[i,b]=d.useState({start_year:new Date().getFullYear(),attendance_mode:"",note:""}),[c,f]=d.useState(!1),[j,n]=d.useState(!1);d.useEffect(()=>{r&&t&&!c?(b({start_year:t.start_year,attendance_mode:t.attendance_mode,note:t.note||""}),f(!0)):r&&!t&&!c&&(b({start_year:new Date().getFullYear(),attendance_mode:"",note:""}),f(!0))},[t,r,c]),d.useEffect(()=>{r||f(!1)},[r]);const x=a=>{const{name:o,value:l}=a.target;b(v=>({...v,[o]:l}))},y=a=>{if(a.preventDefault(),s){u.error("Tahun ajaran sudah complete â€” tidak bisa diedit.");return}t?p():n(!0)},p=()=>{n(!1);const a={...i};t?h.post(`/academic-years/${t.id}`,{...a,_method:"PUT"},{onSuccess:()=>{m(),u.success("Tahun ajaran berhasil diperbarui."),h.reload()},onError:o=>{const l=Object.values(o).join(`
`);u.error("Gagal memperbarui tahun ajaran: "+l)}}):h.post("/academic-years",a,{onSuccess:()=>{m(),u.success("Tahun ajaran berhasil ditambahkan."),h.reload()},onError:o=>{const l=Object.values(o).join(`
`);u.error("Gagal menambahkan tahun ajaran: "+l)}})};return r?e.jsxs(e.Fragment,{children:[e.jsxs(w,{isOpen:r,onClose:m,title:t?"Edit Tahun Akademik":"Tambah Tahun Akademik",onSubmit:y,children:[e.jsxs("div",{className:"mb-3 flex flex-wrap justify-between",children:[e.jsx("label",{htmlFor:"start_year",className:"block text-sm font-medium text-gray-700",children:"Tahun Mulai"}),e.jsx("input",{type:"number",id:"start_year",name:"start_year",value:i.start_year,min:new Date().getFullYear(),disabled:!!t,onChange:x,className:`mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm ${t?"bg-gray-100":""} `,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"attendance_mode",className:"block text-sm font-medium text-gray-700",children:"Mode Kehadiran"}),e.jsxs("select",{name:"attendance_mode",value:i.attendance_mode,onChange:x,disabled:s,className:`mt-1 block w-full rounded-md border p-2 shadow-sm ${s?"bg-gray-100 cursor-not-allowed":""}`,required:!0,children:[e.jsx("option",{value:"",children:"-- Select Mode --"}),g.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"note",className:"block text-sm font-medium text-gray-700",children:"Catatan (opsional)"}),e.jsx("textarea",{name:"note",value:i.note,onChange:x,disabled:s,className:`mt-1 block w-full rounded-md border p-2 shadow-sm ${s?"bg-gray-100 cursor-not-allowed":""}`})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:m,className:"mr-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:cursor-pointer hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"submit",disabled:s,className:`rounded-md px-4 py-2 text-sm font-medium text-white shadow-sm ${s?"bg-gray-400 cursor-not-allowed":"hover:cursor-pointer bg-blue-600 hover:bg-blue-700"}`,children:t?"Ubah":"Simpan"})]})]}),e.jsx(k,{isOpen:j,title:"Konfirmasi",message:"Apakah Anda yakin ingin menambahkan tahun ajaran baru?",buttons:[{label:"Batal",onClick:()=>n(!1),variant:"neutral"},{label:"Ya",onClick:()=>{p(),n(!1)},variant:"primary"}],onClose:()=>n(!1)})]}):null}export{E as default};
