import{R as y,r as d,j as t}from"./app-RtmSSgIt.js";import{s as Q}from"./constants-Ctf-IRat.js";import{l as Z,n as C,o as k,$ as ee,a as te,w as se,b as ae}from"./use-resolve-button-type-CJgp12xs.js";import{Y as D,A as K,y as I,T as re,d as ne,o as v,K as $,u as T,V as L}from"./use-is-mounted-O8K99OZL.js";import{c as le,i as S,u as oe,N as ie,x as ce,s as ue,K as de}from"./transition-CAbaRz1j.js";import{c as P}from"./createLucideIcon-RggCplLh.js";import{C as pe}from"./chevron-down-BADn0r-u.js";import{f as me,p as xe}from"./parseISO-C9VBp7jN.js";import{i as fe}from"./id-PlgGTalb.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ye=P("CircleCheckBig",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],be=P("CircleX",ge);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ve=P("TriangleAlert",je);function Ne(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function H(e){return Ne(e)&&"tagName"in e}function U(e){return H(e)&&"accessKey"in e}function z(e){return H(e)&&"tabIndex"in e}function Ee(e){return U(e)&&e.nodeName==="FIELDSET"}function q(e){return U(e)&&e.nodeName==="LEGEND"}function ke(e){let s=e.parentElement,c=null;for(;s&&!Ee(s);)q(s)&&(c=s),s=s.parentElement;let p=(s==null?void 0:s.getAttribute("disabled"))==="";return p&&Se(c)?!1:p}function Se(e){if(!e)return!1;let s=e.previousElementSibling;for(;s!==null;){if(q(s))return!1;s=s.previousElementSibling}return!0}let we=d.createContext(()=>{});function Ce({value:e,children:s}){return y.createElement(we.Provider,{value:e},s)}var V;let De=(V=y.startTransition)!=null?V:function(e){e()};var Ie=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ie||{}),$e=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))($e||{});let Te={0:e=>({...e,disclosureState:T(e.disclosureState,{0:1,1:0})}),1:e=>e.disclosureState===1?e:{...e,disclosureState:1},2(e,s){return e.buttonId===s.buttonId?e:{...e,buttonId:s.buttonId}},3(e,s){return e.panelId===s.panelId?e:{...e,panelId:s.panelId}},4(e,s){return e.buttonElement===s.element?e:{...e,buttonElement:s.element}},5(e,s){return e.panelElement===s.element?e:{...e,panelElement:s.element}}},_=d.createContext(null);_.displayName="DisclosureContext";function A(e){let s=d.useContext(_);if(s===null){let c=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,A),c}return s}let B=d.createContext(null);B.displayName="DisclosureAPIContext";function G(e){let s=d.useContext(B);if(s===null){let c=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,G),c}return s}let F=d.createContext(null);F.displayName="DisclosurePanelContext";function Pe(){return d.useContext(F)}function _e(e,s){return T(s.type,Te,e,s)}let Ae=d.Fragment;function Be(e,s){let{defaultOpen:c=!1,...p}=e,a=d.useRef(null),r=I(s,re(m=>{a.current=m},e.as===void 0||ne(e.as))),o=d.useReducer(_e,{disclosureState:c?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:l,buttonId:i},f]=o,n=v(m=>{f({type:1});let b=Z(a.current);if(!b||!i)return;let j=m?z(m)?m:"current"in m&&z(m.current)?m.current:b.getElementById(i):b.getElementById(i);j==null||j.focus()}),u=d.useMemo(()=>({close:n}),[n]),h=C({open:l===0,close:n}),g={ref:r},N=$();return y.createElement(_.Provider,{value:o},y.createElement(B.Provider,{value:u},y.createElement(Ce,{value:n},y.createElement(le,{value:T(l,{0:S.Open,1:S.Closed})},N({ourProps:g,theirProps:p,slot:h,defaultTag:Ae,name:"Disclosure"})))))}let Fe="button";function Oe(e,s){let c=d.useId(),{id:p=`headlessui-disclosure-button-${c}`,disabled:a=!1,autoFocus:r=!1,...o}=e,[l,i]=A("Disclosure.Button"),f=Pe(),n=f===null?!1:f===l.panelId,u=d.useRef(null),h=I(u,s,v(x=>{if(!n)return i({type:4,element:x})}));d.useEffect(()=>{if(!n)return i({type:2,buttonId:p}),()=>{i({type:2,buttonId:null})}},[p,i,n]);let g=v(x=>{var E;if(n){if(l.disclosureState===1)return;switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),i({type:0}),(E=l.buttonElement)==null||E.focus();break}}else switch(x.key){case k.Space:case k.Enter:x.preventDefault(),x.stopPropagation(),i({type:0});break}}),N=v(x=>{switch(x.key){case k.Space:x.preventDefault();break}}),m=v(x=>{var E;ke(x.currentTarget)||a||(n?(i({type:0}),(E=l.buttonElement)==null||E.focus()):i({type:0}))}),{isFocusVisible:b,focusProps:j}=ee({autoFocus:r}),{isHovered:w,hoverProps:O}=te({isDisabled:a}),{pressed:Y,pressProps:M}=se({disabled:a}),J=C({open:l.disclosureState===0,hover:w,active:Y,disabled:a,focus:b,autofocus:r}),R=ae(e,l.buttonElement),W=n?L({ref:h,type:R,disabled:a||void 0,autoFocus:r,onKeyDown:g,onClick:m},j,O,M):L({ref:h,id:p,type:R,"aria-expanded":l.disclosureState===0,"aria-controls":l.panelElement?l.panelId:void 0,disabled:a||void 0,autoFocus:r,onKeyDown:g,onKeyUp:N,onClick:m},j,O,M);return $()({ourProps:W,theirProps:o,slot:J,defaultTag:Fe,name:"Disclosure.Button"})}let Me="div",Re=K.RenderStrategy|K.Static;function Ke(e,s){let c=d.useId(),{id:p=`headlessui-disclosure-panel-${c}`,transition:a=!1,...r}=e,[o,l]=A("Disclosure.Panel"),{close:i}=G("Disclosure.Panel"),[f,n]=d.useState(null),u=I(s,v(w=>{De(()=>l({type:5,element:w}))}),n);d.useEffect(()=>(l({type:3,panelId:p}),()=>{l({type:3,panelId:null})}),[p,l]);let h=oe(),[g,N]=ie(a,f,h!==null?(h&S.Open)===S.Open:o.disclosureState===0),m=C({open:o.disclosureState===0,close:i}),b={ref:u,id:p,...ce(N)},j=$();return y.createElement(ue,null,y.createElement(F.Provider,{value:o.panelId},j({ourProps:b,theirProps:r,slot:m,defaultTag:Me,features:Re,visible:g,name:"Disclosure.Panel"})))}let Le=D(Be),ze=D(Oe),Ve=D(Ke),X=Object.assign(Le,{Button:ze,Panel:Ve});const et=({subjectAttendances:e,onEdit:s})=>{const c=e.reduce((a,r)=>(a[r.submit_date]||(a[r.submit_date]=[]),a[r.submit_date].push(r),a),{}),p=a=>{const r=c[a]||[],o=r.length,l=r.filter(n=>["present","late"].includes(n.status)).length,i=r.filter(n=>n.status==="late").length,f=r.filter(n=>["alpha","leave","sick_leave","day_off"].includes(n.status)).length;return{total:o,presentCount:l,lateCount:i,absentCount:f,perfect:l===o&&i===0,hasLate:i>0,hasAbsent:f>0}};return t.jsx("div",{className:"w-full overflow-x-auto rounded-lg border",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tanggal"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Tahun Ajaran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Ringkasan Kehadiran"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs tracking-wider text-gray-500 uppercase",children:"Aksi"})]})}),t.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white",children:[Object.entries(c).sort(([a],[r])=>+new Date(r)-+new Date(a)).map(([a,r])=>{var i,f;const o=p(a),l=((f=(i=r[0])==null?void 0:i.academic_year)==null?void 0:f.title)||"-";return t.jsx(X,{as:y.Fragment,children:({open:n})=>t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:"transition-colors hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium whitespace-nowrap text-gray-900",children:me(xe(a),"EEE, dd MMM yyyy",{locale:fe})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:l}),t.jsx("td",{className:"px-4 py-3 text-sm",children:o.perfect?t.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[t.jsx(ye,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Hadir sempurna (",o.presentCount,"/",o.total,")"]})]}):o.hasLate?t.jsxs("div",{className:"flex items-center gap-3 text-yellow-600",children:[t.jsx(ve,{className:"h-5 w-5 shrink-0"}),t.jsxs("div",{children:["Terlambat di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]})]}):o.hasAbsent?t.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[t.jsx(be,{className:"h-5 w-5 shrink-0"}),"Tidak hadir di beberapa mata pelajaran (",o.presentCount,"/",o.total,")"]}):t.jsx("span",{children:"Belum ada data kehadiran"})}),t.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-500",children:t.jsxs(X.Button,{className:"flex items-center text-blue-600 hover:cursor-pointer hover:text-blue-800 focus:outline-none",children:[t.jsx("span",{className:"mr-1",children:n?"Tutup":"Detail"}),t.jsx(pe,{className:`h-5 w-5 transform transition-transform duration-300 ${n?"rotate-180":"rotate-0"}`})]})})]}),t.jsx(de,{show:n,enter:"transition duration-300 ease-out",enterFrom:"transform scale-y-0 opacity-0",enterTo:"transform scale-y-100 opacity-100",leave:"transition duration-200 ease-in",leaveFrom:"transform scale-y-100 opacity-100",leaveTo:"transform scale-y-0 opacity-0",className:"origin-top",as:y.Fragment,children:t.jsx("tr",{className:"bg-gray-50",children:t.jsx("td",{colSpan:4,className:"px-6 py-4",children:t.jsxs("table",{className:"w-full table-fixed divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Mata Pelajaran"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Waktu"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Absen Masuk"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Catatan"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:r.map(u=>{var h;return t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:u.subject_name}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600",children:[u.subject_start_hour_formatted," - ",u.subject_end_hour_formatted]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:u.submit_hour_formatted||"-"}),t.jsxs("td",{className:"px-4 py-2 text-sm text-gray-600 capitalize",children:[((h=Q.subject.find(g=>g.value===u.status))==null?void 0:h.label)||u.status,u.day_off_reason&&t.jsxs("div",{className:"text-xs text-gray-400",children:["(",u.day_off_reason,")"]})]}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:u.note||"-"}),t.jsx("td",{className:"px-4 py-2 text-sm",children:t.jsx("button",{onClick:()=>s(u),className:"rounded bg-blue-500 px-3 py-1 text-sm text-white hover:cursor-pointer hover:bg-blue-600",children:"Ubah"})})]},u.id)})})]})})})})]})},a)}),Object.keys(c).length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500",children:"Tidak ada data kehadiran untuk bulan ini"})})]})]})})};export{et as default};
