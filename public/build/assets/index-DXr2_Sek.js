import{r as u,u as S,j as t,H as _,a as c,L as g}from"./app-ARBfmUkN.js";import{A as b}from"./action-modal-Cb5Ak2E5.js";import{P as H}from"./pagination-CHIcoOsN.js";import{T as I}from"./table-CaSWywFK.js";import{A as K}from"./app-layout-CR20SyES.js";import{t as y,T as O}from"./index-O4ibSkm5.js";/* empty css            */import"./proxy-DUyxyE7i.js";import"./createLucideIcon-lEs_2s0Q.js";import"./button-Bzg_-9s1.js";import"./index-Cfa3hls5.js";import"./index-DlQZmt9q.js";import"./index-VVdZ58hQ.js";import"./app-logo-icon-BRGhLVGp.js";const E=[{title:"Tugas",href:""}];function Q({tasks:h,filters:r}){const[f,j]=u.useState([]),[l,m]=u.useState(null),[o,p]=u.useState(null),[d,x]=u.useState(null),{flash:s}=S().props;u.useEffect(()=>{s!=null&&s.success&&y.success(s.success),s!=null&&s.error&&y.error(s.error)},[s]);const k=e=>{j(a=>a.includes(e)?a.filter(n=>n!==e):[...a,e])},N=e=>e?new Date(e).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",w=e=>e?e.length===5?e:e.substring(0,5):"-",T=[{key:"title",label:"Judul",sortable:!0},{key:"description",label:"Deskripsi",sortable:!1},{key:"due_date",label:"Tanggal Tenggat",sortable:!0},{key:"due_time",label:"Waktu Tenggat ",sortable:!0},{key:"attachments.url",label:"Lampiran",sortable:!1},{key:"actions",label:"Aksi",sortable:!1}],v=e=>{c.get(route("tasks.index"),{sort:e,direction:r.direction==="asc"?"desc":"asc"})},C=e=>{c.delete(route("tasks.destroy",e),{onSuccess:()=>{c.reload()}})},i=e=>{const a=new Date,n=new Date(e.due_date);if(isNaN(n.getTime()))return console.error("Invalid base date:",e.due_date),!0;if(e.due_time){const[A,D]=e.due_time.split(":");n.setHours(parseInt(A),parseInt(D),0,0)}else n.setHours(23,59,59,999);return a>n};return t.jsxs(K,{breadcrumbs:E,children:[t.jsx(_,{title:"Daftar Tugas"}),t.jsx(O,{position:"top-right",richColors:!0}),t.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{type:"text",placeholder:"Cari Tugas...",defaultValue:r.search||"",onChange:e=>c.get(route("tasks.index"),{search:e.target.value}),className:"w-64 rounded border px-3 py-1 text-sm"})}),t.jsx(g,{href:route("tasks.create"),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Buat Tugas"})]}),t.jsx(I,{headers:T,data:h.data,sortColumn:r.sort||"",sortDirection:r.direction==="asc"||r.direction==="desc"?r.direction:"asc",onSort:v,onSelectAll:e=>j(e?h.data.map(a=>a.id):[]),selectedIds:f,emptyMessage:"Tugas Tidak Ditemukan.",rowRender:e=>t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"w-[10px] p-3 text-sm",children:t.jsx("input",{type:"checkbox",checked:f.includes(e.id),onChange:()=>k(e.id)})}),t.jsxs("td",{className:"p-3 text-sm",children:[e.title," ",i(e)]}),t.jsx("td",{className:"p-3 text-sm max-w-[180px] truncate",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.description||"-"}),t.jsx("td",{className:"p-3 text-sm",children:N(e.due_date)}),t.jsx("td",{className:"p-3 text-sm",children:w(e.due_time)}),t.jsx("td",{className:"p-3 text-sm",children:e.attachments&&e.attachments.length>0?e.attachments.map((a,n)=>t.jsx("div",{children:t.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:["lampiran ",n+1]})},n)):t.jsx("span",{children:"-"})}),t.jsxs("td",{className:"flex gap-2 p-3",children:[t.jsx(g,{href:route("tasks.edit",e.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Edit"}),t.jsx(g,{href:route("tasks.show",e.id),className:"rounded bg-sky-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Detail"}),t.jsx("button",{onClick:()=>p(e),disabled:i(e),className:`rounded px-3 py-1 text-sm font-medium text-white ${i(e)?"cursor-not-allowed bg-orange-300":"bg-orange-500 hover:cursor-pointer hover:bg-orange-600"}`,title:i(e)?"Tugas sudah melewati deadline":"Kirim notifikasi sync",children:"Sync Notif"}),t.jsx("button",{onClick:()=>x(e),disabled:i(e),className:`rounded px-3 py-1 text-sm font-medium text-white ${i(e)?"cursor-not-allowed bg-purple-300":"bg-purple-500 hover:cursor-pointer hover:bg-purple-600"}`,title:i(e)?"Tugas sudah melewati deadline":"Kirim notifikasi async",children:"Async Notif"}),t.jsx("button",{onClick:()=>m(e),className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Hapus"})]})]},e.id)}),t.jsx(H,{links:h.links}),t.jsx(b,{isOpen:!!l,onClose:()=>m(null),title:"Konfirmasi Penghapusan",message:t.jsxs("span",{children:["Apakah Anda yakin ingin menghapus tugas ",t.jsx("strong",{children:l==null?void 0:l.title}),"?"]}),buttons:[{label:"Batal",onClick:()=>m(null),variant:"neutral"},{label:"Ya, Hapus",onClick:()=>{l&&(C(l.id),m(null))},variant:"danger"}]}),t.jsx(b,{isOpen:!!o,onClose:()=>p(null),title:"Konfirmasi Notifikasi Sync",message:t.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi ",t.jsx("strong",{children:"SYNC"})," untuk tugas ",t.jsx("strong",{children:o==null?void 0:o.title}),"?",t.jsx("br",{}),t.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim secara langsung dan mungkin membutuhkan waktu lebih lama."})]}),buttons:[{label:"Batal",onClick:()=>p(null),variant:"neutral"},{label:"Kirim Sync",onClick:()=>{o&&(c.post(route("tasks.sync-resend-notification",o.id)),p(null))},variant:"primary"}]}),t.jsx(b,{isOpen:!!d,onClose:()=>x(null),title:"Konfirmasi Notifikasi Async",message:t.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi ",t.jsx("strong",{children:"ASYNC"})," untuk tugas ",t.jsx("strong",{children:d==null?void 0:d.title}),"?",t.jsx("br",{}),t.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim melalui queue job dan lebih cepat untuk proses yang banyak."})]}),buttons:[{label:"Batal",onClick:()=>x(null),variant:"neutral"},{label:"Kirim Async",onClick:()=>{d&&(c.post(route("tasks.async-resend-notification",d.id)),x(null))},variant:"primary"}]})]})]})}export{Q as default};
