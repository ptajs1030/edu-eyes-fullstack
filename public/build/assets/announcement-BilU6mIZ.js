import{j as e,r as o,a as c,u as S,H as P}from"./app-BAPB98s5.js";import{m as j}from"./proxy-UzE8AFBl.js";import{t as h,T as I}from"./index-DXmNrHBV.js";import{c as M}from"./createLucideIcon-Dff4Dkwf.js";import{C as U}from"./chevron-down-C_Re3eix.js";import{A as L}from"./app-layout-DDRi8pf_.js";/* empty css            */import"./index-BEZTdwTo.js";import"./button-BoLw_LAS.js";import"./index-C2AIOuuF.js";import"./index-BrNQt190.js";import"./app-logo-icon-KurThtPT.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],$=M("ChevronUp",T);function z({isDeleteModalOpen:d,setIsDeleteModalOpen:r,handleDelete:n,announcementToDelete:s}){return d&&e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-black/30 z-50",children:e.jsxs(j.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.1},className:"bg-white p-6 rounded-lg w-full max-w-xl shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Confirm Deletion"}),e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:s==null?void 0:s.title}),"?"]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-gray-300 rounded hover:cursor-pointer",children:"Cancel"}),e.jsx("button",{onClick:()=>{s&&n(s.id),r(!1)},className:"px-4 py-2 bg-red-500 text-white rounded hover:cursor-pointer",children:"Confirm"})]})]})})}function R({isOpen:d,closeModal:r,announcement:n}){const[s,u]=o.useState({title:"",content:"",short_content:""}),[l,x]=o.useState(null),[w,b]=o.useState("");o.useEffect(()=>{n?(u({title:n.title,content:n.content,short_content:n.short_content||""}),b(n.short_content||""),x(null)):(u({title:"",content:"",short_content:""}),b(""),x(null))},[n]);const p=m=>{u({...s,[m.target.name]:m.target.value})},y=m=>{m.preventDefault();const i=new FormData;i.append("title",s.title),i.append("content",s.content),i.append("short_content",s.short_content),n?(i.append("_method","PUT"),c.post(`/announcements/${n.id}`,i,{onSuccess:()=>{r(),h.success("Announcement updated successfully."),c.reload()},onError:f=>{h.error("Failed to update announcement."),console.error(f.message||"Failed to update announcement.")}})):c.post("/announcements",i,{onSuccess:()=>{r(),h.success("Announcement created successfully."),c.reload()},onError:f=>{h.error("Failed to create announcement."),console.error(f.message||"Failed to create announcement.")}})};return d?e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:e.jsxs(j.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.1},className:"w-full max-w-xl rounded-lg bg-white p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:n?"Edit Announcement":"Adding Announcement"}),e.jsxs("form",{onSubmit:y,encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Judul"}),e.jsx("input",{type:"text",id:"title",name:"title",value:s.title,onChange:p,className:"w-full rounded border p-2",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Isi Pengumuman"}),e.jsx("textarea",{id:"content",name:"content",value:s.content,onChange:p,className:"h-50 w-full rounded border p-2",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"short_content",className:"block text-sm font-medium text-gray-700",children:"Ringkasan Pengumuman"}),e.jsx("textarea",{id:"short_content",name:"short_content",value:s.short_content,onChange:p,className:"h-50 w-full rounded border p-2",required:!0})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:r,className:"mr-2 rounded bg-gray-500 px-4 py-2 text-white hover:cursor-pointer",children:"Batal"}),e.jsx("button",{type:"submit",className:"rounded bg-blue-600 px-4 py-2 text-white hover:cursor-pointer",children:n?"Update":"Create"})]})]})]})}):null}const q=({options:d,onSortChange:r})=>{const[n,s]=o.useState(!1),u=l=>{r(l.sort,l.direction),s(!1)};return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsxs("button",{onClick:()=>s(!n),className:"inline-flex items-center gap-1 text-blue-600 hover:underline text-sm",children:["Sort",n?e.jsx($,{className:"w-4 h-4"}):e.jsx(U,{className:"w-4 h-4"})]}),n&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:d.map((l,x)=>e.jsx("button",{onClick:()=>u(l.value),className:"w-full px-4 py-2 text-sm text-left hover:bg-gray-100",children:l.label},x))})]})},H=[{title:"Pengumuman",href:"/announcements"}];function se(){const d=[{label:"Title (A-Z)",value:{sort:"title",direction:"asc"}},{label:"Title (Z-A)",value:{sort:"title",direction:"desc"}},{label:"Created At (Newest)",value:{sort:"created_at",direction:"desc"}},{label:"Created At (Oldest)",value:{sort:"created_at",direction:"asc"}}],{announcements:r,filters:n}=S().props,{flash:s}=S().props;o.useEffect(()=>{s!=null&&s.success&&h.success(s.success),s!=null&&s.error&&h.error(s.error)},[s]);const[u,l]=o.useState(!1),[x,w]=o.useState(null),[b,p]=o.useState([]),[y,m]=o.useState(!1),[i,f]=o.useState(null),C=(t=null)=>{w(t),l(!0)},k=async t=>{c.delete(`/announcements/${t}`,{onSuccess:()=>{c.reload()}})},A=t=>{p(a=>a.includes(t)?a.filter(N=>N!==t):[...a,t])},_=()=>{const t=r.data.filter(g=>b.includes(g.id)),a=`Title,Content
`,N=t.map(g=>`${g.title},${g.content}`).join(`
`),D=new Blob([a,N],{type:"text/csv"}),O=URL.createObjectURL(D),v=document.createElement("a");v.href=O,v.download="announcements.csv",v.click()},F=t=>{c.get("/announcements",{...n||{},search:t.target.value},{preserveState:!0,replace:!0})},E=(t,a)=>{c.get("/announcements",{...n,sort:t,direction:a},{preserveState:!0,replace:!0})};return e.jsxs(L,{breadcrumbs:H,children:[e.jsx(P,{title:"Announcements"}),e.jsx(I,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",defaultValue:n.search||"",onChange:F,placeholder:"Search by title...",className:"w-64 rounded border px-3 py-1"}),e.jsx(q,{options:d,onSortChange:E}),e.jsx("button",{onClick:_,className:"rounded bg-indigo-600 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Export Selected"})]}),e.jsx("button",{onClick:()=>C(),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Tambah Pengumuman"})]}),e.jsxs("table",{className:"w-full border-collapse rounded-lg bg-white text-black shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-100 text-gray-800",children:[e.jsx("th",{className:"p-4",children:e.jsx("input",{type:"checkbox",onChange:t=>p(t.target.checked?r.data.map(a=>a.id):[])})}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Judul"}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Isi Pengumuman"}),e.jsx("th",{className:"p-4 text-sm font-semibold",children:"Aksi"})]})}),e.jsx("tbody",{children:r.data.length>0?r.data.map(t=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",checked:b.includes(t.id),onChange:()=>A(t.id)})}),e.jsx("td",{className:"p-3",children:t.title}),e.jsx("td",{className:"p-3",children:t.short_content}),e.jsxs("td",{className:"flex gap-2 p-3",children:[e.jsx("button",{onClick:()=>C(t),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Edit"}),e.jsx("button",{onClick:()=>{f(t),m(!0)},className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Delete"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-600",children:"No announcements found."})})})]}),e.jsx("div",{className:"mt-4 flex justify-center gap-2",children:r.links.map((t,a)=>e.jsx("button",{onClick:()=>t.url&&c.visit(t.url),disabled:!t.url,className:`rounded px-3 py-1 text-sm hover:cursor-pointer ${t.active?"bg-blue-500 text-white":"bg-gray-100 text-black"}`,dangerouslySetInnerHTML:{__html:t.label}},a))})]}),e.jsx(R,{isOpen:u,closeModal:()=>l(!1),announcement:x}),e.jsx(z,{isDeleteModalOpen:y,setIsDeleteModalOpen:m,handleDelete:k,announcementToDelete:i})]})}export{se as default};
