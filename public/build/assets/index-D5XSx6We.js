import{u as y,r as c,j as e,H as _,a as n,L as g}from"./app-RtmSSgIt.js";import{A as b}from"./action-modal-D4KCFIDw.js";import{P}from"./pagination-CXGz1L8k.js";import{T as H}from"./table-B8oyjt8o.js";import{A as K}from"./app-layout-DmT0hxPZ.js";import{t as v,T as D}from"./index-CEaZY_xi.js";import{f as Y,p as B}from"./parseISO-C9VBp7jN.js";import{i as E}from"./id-PlgGTalb.js";/* empty css            */import"./proxy-C_JX7idc.js";import"./createLucideIcon-RggCplLh.js";import"./button-Dn8o4koa.js";import"./index-UIP8aiHW.js";import"./index-BfNfS4iZ.js";import"./app-logo-icon-CL7od90h.js";const I=[{title:"Tagihan",href:"/payments"}];function Z(){const{flash:a}=y().props,[f,k]=c.useState([]),[r,u]=c.useState(null),[l,m]=c.useState(null),[o,p]=c.useState(null),{payments:x,filters:s,academicYears:j}=y().props,N=Array.isArray(j)?j:[];c.useEffect(()=>{a!=null&&a.success&&v.success(a.success),a!=null&&a.error&&v.error(a.error)},[a]);const C=t=>{n.delete(`payments/${t}`,{onSuccess:()=>{u(null),n.reload()}})},w=t=>{n.get(route("payments.index"),{...s,academic_year:t||null},{preserveState:!0})},A=t=>{k(i=>i.includes(t)?i.filter(h=>h!==t):[...i,t])},S=t=>{n.get(route("payments.index"),{sort:t,direction:s.direction==="asc"?"desc":"asc"},{preserveState:!0})},d=t=>{const i=new Date,h=new Date(t.due_date);return h.setHours(23,59,59,999),i>h},T=[{key:"title",label:"Tagihan",sortable:!0},{key:"academic_year.title",label:"Tahun Ajaran",sortable:!1},{key:"nominal",label:"Nominal",sortable:!0},{key:"due_date",label:"Batas Waktu",sortable:!0},{key:"actions",label:"Aksi",sortable:!1}];return e.jsxs(K,{breadcrumbs:I,children:[e.jsx(_,{title:"Tagihan"}),e.jsx(D,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Cari tagihan...",defaultValue:s.search||"",onChange:t=>n.get(route("payments.index"),{search:t.target.value},{preserveState:!0}),className:"w-64 rounded border px-3 py-1 text-sm"}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"rounded bg-gray-200 px-3 py-1 text-sm font-medium text-gray-700",children:e.jsxs("select",{value:s.academic_year||"",onChange:t=>w(t.target.value),className:"cursor-pointer bg-transparent outline-none",children:[e.jsx("option",{value:"",children:"Tahun Ajaran"}),N.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})})})]}),e.jsx(g,{href:route("payments.create"),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Buat Tagihan"})]}),e.jsx(H,{headers:T,data:x.data,sortColumn:s.direction==="asc"||s.direction==="desc"?s.direction:"asc",onSort:S,onSelectAll:t=>k(t?x.data.map(i=>i.id):[]),selectedIds:f,rowRender:t=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"w-[10px] p-3 text-sm",children:e.jsx("input",{type:"checkbox",checked:f.includes(t.id),onChange:()=>A(t.id)})}),e.jsx("td",{className:"p-3 text-sm",children:t.title}),e.jsx("td",{className:"p-3 text-sm",children:t.academic_year.title}),e.jsxs("td",{className:"p-3 text-sm",children:["Rp ",t.nominal.toLocaleString("id-ID")]}),e.jsxs("td",{className:"p-3 text-sm",children:[" ",Y(B(t.due_date),"dd MMM yyyy",{locale:E})]}),e.jsxs("td",{className:"flex gap-2 p-3",children:[e.jsx(g,{href:route("payments.edit",t.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600",children:"Edit"}),e.jsx(g,{href:route("payments.show",t.id),className:"rounded bg-sky-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-sky-600",children:"Detail"}),e.jsx("button",{onClick:()=>m(t),disabled:d(t),className:`rounded px-3 py-1 text-sm font-medium text-white ${d(t)?"cursor-not-allowed bg-orange-300":"bg-orange-500 hover:cursor-pointer hover:bg-orange-600"}`,title:d(t)?"Tagihan sudah melewati deadline":"Kirim notifikasi sync",children:"Sync Notif"}),e.jsx("button",{onClick:()=>p(t),disabled:d(t),className:`rounded px-3 py-1 text-sm font-medium text-white ${d(t)?"cursor-not-allowed bg-purple-300":"bg-purple-500 hover:cursor-pointer hover:bg-purple-600"}`,title:d(t)?"Tagihan sudah melewati deadline":"Kirim notifikasi async",children:"Async Notif"}),e.jsx("button",{onClick:()=>u(t),className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-600",children:"Hapus"})]})]},t.id),emptyMessage:"Tidak ada tagihan yang ditemukan"}),e.jsx(P,{links:x.links}),e.jsx(b,{isOpen:!!r,onClose:()=>u(null),title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus tagihan "${r==null?void 0:r.title}"?`,buttons:[{label:"Batal",onClick:()=>u(null),variant:"neutral"},{label:"Ya, Hapus",onClick:()=>r&&C(r.id),variant:"danger"}]}),e.jsx(b,{isOpen:!!l,onClose:()=>m(null),title:"Konfirmasi Notifikasi Sync",message:e.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi ",e.jsx("strong",{children:"SYNC"})," untuk tagihan ",e.jsx("strong",{children:l==null?void 0:l.title}),"?",e.jsx("br",{}),e.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim secara langsung dan mungkin membutuhkan waktu lebih lama."})]}),buttons:[{label:"Batal",onClick:()=>m(null),variant:"neutral"},{label:"Kirim Sync",onClick:()=>{l&&(n.post(route("payments.sync-resend-notification",l.id)),m(null))},variant:"primary"}]}),e.jsx(b,{isOpen:!!o,onClose:()=>p(null),title:"Konfirmasi Notifikasi Async",message:e.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi ",e.jsx("strong",{children:"ASYNC"})," untuk tagihan ",e.jsx("strong",{children:o==null?void 0:o.title}),"?",e.jsx("br",{}),e.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim melalui queue job dan lebih cepat untuk proses yang banyak."})]}),buttons:[{label:"Batal",onClick:()=>p(null),variant:"neutral"},{label:"Kirim Async",onClick:()=>{o&&(n.post(route("payments.async-resend-notification",o.id)),p(null))},variant:"primary"}]})]})]})}export{Z as default};
