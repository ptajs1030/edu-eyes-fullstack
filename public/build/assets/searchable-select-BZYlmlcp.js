import{r as s,j as r,h as _}from"./app-DY4zhPys.js";function I({value:V,onChange:d,placeholder:w="Search...",endpoint:g,initialOption:a,showInitialOptions:i=!1,maxInitialOptions:S=10,disabled:n=!1,required:b=!1}){const[p,u]=s.useState(""),[v,c]=s.useState([]),[j,o]=s.useState(!1),[N,y]=s.useState(!1),[l,f]=s.useState(a||null),m=s.useRef(null),h=s.useRef(null);s.useEffect(()=>{a&&(f(a),u(a.full_name))},[a]),s.useEffect(()=>{const e=t=>{h.current&&!h.current.contains(t.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const x=async e=>{if(g){y(!0);try{const k=(await _.get(g,{params:{query:e},withCredentials:!0})).data.slice(0,S);c(k),o(!0)}catch(t){console.error("Error fetching options:",t),c([])}finally{y(!1)}}},E=e=>{if(n)return;const t=e.target.value;if(u(t),l&&t!==l.full_name&&(f(null),d(null)),m.current&&clearTimeout(m.current),i&&t===""){x("");return}m.current=setTimeout(()=>{t.length>=1||i&&t.length===0?x(t):(c([]),o(!1))},300)},C=e=>{f(e),u(e.full_name),d(e.id),o(!1)},L=()=>{f(null),u(""),d(null),c([])},R=()=>{n||i&&p===""&&x("")};return r.jsxs("div",{className:"relative",ref:h,children:[r.jsxs("div",{className:`flex mt-1 items-center block border p-2 border-gray-300 rounded-md shadow-sm ${n?"bg-gray-100 cursor-not-allowed":"bg-white"}`,children:[r.jsx("input",{type:"text",value:p,onChange:E,placeholder:w,onFocus:R,disabled:n,className:"flex-1 outline-none w-full",required:b}),l&&!n&&r.jsx("button",{type:"button",onClick:L,className:"px-2 text-gray-500 hover:text-red-500",children:"Ã—"})]}),!n&&j&&r.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border max-h-60 overflow-auto",children:N?r.jsx("div",{className:"py-2 px-3 text-gray-500",children:"Loading..."}):v.length===0?r.jsx("div",{className:"py-2 px-3 text-gray-500",children:"No results found"}):v.map(e=>r.jsx("div",{onClick:()=>C(e),className:`px-3 py-2 hover:bg-gray-100 cursor-pointer ${(l==null?void 0:l.id)===e.id?"bg-blue-50":""}`,children:e.full_name},e.id))})]})}export{I as S};
