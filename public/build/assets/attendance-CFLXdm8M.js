import{u as S,r as n,j as e,H as L,L as C,a as y}from"./app-CkblNEmk.js";import{P as T}from"./pagination-CJviQlBC.js";import{A}from"./app-layout-BUOE2KgS.js";import{t as b,T as E}from"./index-B6px7_Mb.js";import I from"./editAttendance-CbTlVLQW.js";/* empty css            */import"./button-89-GDGpk.js";import"./index-CZ5wBAIj.js";import"./index-BI3dlrI6.js";import"./index-BZmqtXQq.js";import"./createLucideIcon-Hn6pGr9g.js";import"./app-logo-icon-3-yksRhs.js";import"./form-modal-CyLqw2q_.js";import"./proxy-BD0GIVOm.js";const M=s=>[{title:"Events",href:"/events"},{title:s}];function G({event:s,attendances:x,canEditAttendance:h}){const{flash:l}=S().props,[g,m]=n.useState(null),[a,d]=n.useState([]),[N,u]=n.useState(!1),[j,f]=n.useState(!1);l!=null&&l.success?b.success(l.success):l!=null&&l.error&&b.error(l.error);const i=n.useMemo(()=>{const t=[],r=new Date(s.start_date),p=new Date(s.end_date);for(let o=new Date(r);o<=p;o.setDate(o.getDate()+1))t.push(o.toISOString().split("T")[0]);return t},[s.start_date,s.end_date]),v=()=>{a.length===i.length?(d([]),c([])):(d([...i]),c(i))},w=t=>{let r;a.includes(t)?r=a.filter(p=>p!==t):r=[...a,t],d(r),c(r)},c=t=>{y.get(route("events.attendance",s.id),{dates:t},{preserveState:!0})},k=t=>{y.patch(route("events.attendance.update",s.id),t,{preserveScroll:!0,onSuccess:()=>{u(!1),m(null)}})},D=t=>{switch(t){case"present":return"bg-green-100 text-green-800 border-green-200";case"present_in_tolerance":return"bg-blue-100 text-blue-800 border-blue-200";case"late":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"alpha":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=t=>{switch(t){case"present":return"Hadir";case"present_in_tolerance":return"Hadir (Toleransi)";case"late":return"Terlambat";case"alpha":return"Alpha";default:return"Belum Diisi"}};return e.jsxs(A,{breadcrumbs:M(s.name),children:[e.jsx(L,{title:`Detail Event - ${s.name}`}),e.jsx(E,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h1",{className:"mb-4 text-2xl font-bold",children:s.name}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Tanggal"}),e.jsxs("p",{className:"mt-1",children:[new Date(s.start_date).toLocaleDateString("id-ID")," - ",new Date(s.end_date).toLocaleDateString("id-ID")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Waktu"}),e.jsxs("p",{className:"mt-1",children:[s.start_hour," - ",s.end_hour]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"PIC"}),e.jsx("p",{className:"mt-1",children:s.event_pics.map(t=>t.user.full_name).join(", ")||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Deskripsi"}),e.jsx("p",{className:"mt-1",children:s.description||"-"})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Daftar Kehadiran"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>f(!j),className:"flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter Tanggal",a.length>0&&e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-800 text-xs",children:a.length})]}),j&&e.jsxs("div",{className:"absolute top-full right-0 z-10 mt-2 w-80 rounded-lg border border-gray-200 bg-white p-4 shadow-lg",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filter Berdasarkan Tanggal"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:cursor-pointer hover:text-gray-600",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.length===i.length,onChange:v,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Pilih Semua Tanggal"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border-t border-gray-200 pt-3",children:i.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[e.jsx("input",{type:"checkbox",checked:a.includes(t),onChange:()=>w(t),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(t).toLocaleDateString("id-ID",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]},t))}),e.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[a.length," tanggal dipilih"]}),e.jsx("button",{onClick:()=>{d([]),c([])},className:"text-sm text-blue-600 hover:cursor-pointer hover:text-blue-800",children:"Reset Filter"})]})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tanggal"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nama"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NIS"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Kelas"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Jam Masuk"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Jam Keluar"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Keterlambatan"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Catatan"}),h&&e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:x.data.map(t=>{var r;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(t.submit_date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.student.full_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.student.nis||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:((r=t.student.classroom)==null?void 0:r.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-medium ${D(t.status)}`,children:_(t.status)})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.clock_in_hour||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.clock_out_hour||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.minutes_of_late?`${t.minutes_of_late} menit`:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:t.note||"-"}),h&&e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{onClick:()=>{m(t),u(!0)},className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600",children:"Edit"})})]},`${t.submit_date}-${t.student.id}`)})})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(T,{links:x.links})}),x.data.length===0&&e.jsx("div",{className:"mt-4 text-center text-gray-500",children:"Tidak ada data kehadiran untuk tanggal yang dipilih"})]}),e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx(C,{href:route("events.index"),className:"rounded-md bg-gray-200 px-4 py-2 text-sm font-medium text-gray-800 hover:bg-gray-300",children:"Kembali ke Daftar Event"})})]}),N&&g&&e.jsx(I,{attendance:g,onClose:()=>{u(!1),m(null)},onSubmit:k})]})}export{G as default};
