import{r as c,j as e,a as k}from"./app-3a7-8PMK.js";import{F as _}from"./form-modal-lpGbdfyG.js";/* empty css            */import"./proxy-Dr-V1dPV.js";function R({isOpen:v,onClose:p,user:t,statuses:w,role:s,routePrefix:f}){const[r,i]=c.useState({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:s.id,status:"active",...s.value==="admin"||s.value==="teacher"?{nip:"",position:""}:{},...s.value==="parent"?{job:""}:{},address:""}),[h,u]=c.useState(null),[g,x]=c.useState(!1),b=c.useRef(null);c.useEffect(()=>{t?(i({...t,password:"",password_confirmation:"",profile_picture:void 0}),t.profile_picture&&u(`/storage/${t.profile_picture}`)):(i({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:s.id,status:"active",...s.value==="admin"||s.value==="teacher"?{nip:"",position:""}:{},...s.value==="parent"?{job:""}:{},address:""}),u(null)),x(!1)},[t,s.id]);const l=(a,o)=>{i(d=>({...d,[a]:o}))},j=a=>{var d;const o=(d=a.target.files)==null?void 0:d[0];if(o){const n=new FileReader;n.onloadend=()=>{u(n.result)},n.readAsDataURL(o),i(m=>({...m,profile_picture:o})),x(!1)}},N=()=>{u(null),i(a=>({...a,profile_picture:void 0})),x(!0),b.current&&(b.current.value="")},y=a=>{a.preventDefault();const o=new FormData;r.profile_picture instanceof File&&o.append("profile_picture",r.profile_picture),g&&o.append("remove_profile_picture","1"),Object.entries(r).forEach(([n,m])=>{n!=="profile_picture"&&m!==void 0&&m!==null&&o.append(n,m)}),t!=null&&t.id&&o.append("_method","PUT");const d=t!=null&&t.id?route(`${f}.update`,t.id):route(`${f}.store`);k.post(d,o,{preserveScroll:!0,onSuccess:()=>p(),onError:()=>{},headers:{"Content-Type":"multipart/form-data"}})};return e.jsxs(_,{isOpen:v,onClose:p,title:t?`Edit ${s.name}`:`Add New ${s.name}`,onSubmit:y,children:[e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-24 w-24 items-center justify-center overflow-hidden rounded-full border-2 border-gray-300 bg-gray-100",children:h?e.jsx("img",{src:h,alt:"Profile preview",className:"h-full w-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(h||(t==null?void 0:t.profile_picture)&&!g)&&e.jsx("button",{type:"button",onClick:N,className:"absolute -top-2 -right-2 rounded-full bg-red-500 p-1 text-white hover:cursor-pointer hover:bg-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("label",{className:"mt-2 cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("span",{children:"Upload Photo"}),e.jsx("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:j})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 2MB (300x300)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("input",{type:"text",value:s.name,disabled:!0,className:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 p-2 shadow-sm"}),e.jsx("input",{type:"hidden",name:"role_id",value:s.id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name*"}),e.jsx("input",{id:"full_name",type:"text",maxLength:70,value:r.full_name,onChange:a=>l("full_name",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username*"}),e.jsx("input",{id:"username",type:"text",maxLength:70,value:r.username,onChange:a=>l("username",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),(s.value==="admin"||s.value==="teacher")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"nip",className:"block text-sm font-medium text-gray-700",children:"NIP"}),e.jsx("input",{id:"nip",type:"text",maxLength:70,value:r.nip||"",onChange:a=>l("nip",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Position"}),e.jsx("input",{id:"position",type:"text",maxLength:70,value:r.position||"",onChange:a=>l("position",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]})]}),s.value==="parent"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"job",className:"block text-sm font-medium text-gray-700",children:"Job"}),e.jsx("input",{id:"job",type:"text",maxLength:70,value:r.job||"",onChange:a=>l("job",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("input",{id:"phone",type:"tel",value:r.phone||"",onChange:a=>l("phone",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:r.email||"",onChange:a=>l("email",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("textarea",{id:"address",value:r.address||"",onChange:a=>l("address",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",rows:3})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status*"}),e.jsx("select",{id:"status",value:r.status,onChange:a=>l("status",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0,children:w.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:t?"New Password":"Password*"}),e.jsx("input",{id:"password",type:"password",value:r.password||"",onChange:a=>l("password",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",placeholder:t?"Leave blank to keep current password":"",required:!t})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700",children:t?"Confirm New Password":"Confirm Password*"}),e.jsx("input",{id:"password_confirmation",type:"password",value:r.password_confirmation||"",onChange:a=>l("password_confirmation",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!t})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:p,className:"mr-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:cursor-pointer hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:cursor-pointer hover:bg-blue-700",children:t?"Update":"Create"})]})]})}export{R as default};
