import{u as b,r as u,j as t,H as w,a as o,L as x}from"./app-R0rMdquo.js";import{A as f}from"./action-modal-C5xzWGOx.js";import{P as C}from"./pagination-BdMLDMeh.js";import{T as S}from"./table-vKAX4raL.js";import{A}from"./app-layout-BTrLOwnA.js";import{t as k,T}from"./index-D97IkeqK.js";import{f as H,p as P}from"./parseISO-C9VBp7jN.js";import{i as _}from"./id-PlgGTalb.js";/* empty css            */import"./proxy-C1q8mDJX.js";import"./createLucideIcon-z0AE1PcL.js";import"./button-C2viNmP0.js";import"./index-BhORX2Px.js";import"./index-C39OHPGn.js";import"./index-DrhDQZ7H.js";import"./app-logo-icon-DqgII9sk.js";const D=[{title:"Tagihan",href:"/payments"}];function J(){const{payments:m,filters:n}=b().props,{flash:s}=b().props,[h,g]=u.useState([]),[r,l]=u.useState(null),[i,d]=u.useState(null);u.useEffect(()=>{s!=null&&s.success&&k.success(s.success),s!=null&&s.error&&k.error(s.error)},[s]);const j=e=>{o.delete(`payments/${e}`,{onSuccess:()=>{l(null),o.reload()}})},y=e=>{g(a=>a.includes(e)?a.filter(c=>c!==e):[...a,e])},N=e=>{o.get(route("payments.index"),{sort:e,direction:n.direction==="asc"?"desc":"asc"},{preserveState:!0})},p=e=>{const a=new Date,c=new Date(e.due_date);return c.setHours(23,59,59,999),a>c},v=[{key:"title",label:"Tagihan",sortable:!0},{key:"academic_year.title",label:"Tahun Ajaran",sortable:!1},{key:"nominal",label:"Nominal",sortable:!0},{key:"due_date",label:"Batas Waktu",sortable:!0},{key:"actions",label:"Aksi",sortable:!1}];return t.jsxs(A,{breadcrumbs:D,children:[t.jsx(w,{title:"Tagihan"}),t.jsx(T,{position:"top-right",richColors:!0}),t.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{type:"text",placeholder:"Cari tagihan...",defaultValue:n.search||"",onChange:e=>o.get(route("payments.index"),{search:e.target.value},{preserveState:!0}),className:"w-64 rounded border px-3 py-1 text-sm"})}),t.jsx(x,{href:route("payments.create"),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Buat Tagihan"})]}),t.jsx(S,{headers:v,data:m.data,sortColumn:n.direction==="asc"||n.direction==="desc"?n.direction:"asc",onSort:N,onSelectAll:e=>g(e?m.data.map(a=>a.id):[]),selectedIds:h,rowRender:e=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"w-[10px] p-3 text-sm",children:t.jsx("input",{type:"checkbox",checked:h.includes(e.id),onChange:()=>y(e.id)})}),t.jsx("td",{className:"p-3 text-sm",children:e.title}),t.jsx("td",{className:"p-3 text-sm",children:e.academic_year.title}),t.jsxs("td",{className:"p-3 text-sm",children:["Rp ",e.nominal.toLocaleString("id-ID")]}),t.jsxs("td",{className:"p-3 text-sm",children:[" ",H(P(e.due_date),"dd MMM yyyy",{locale:_})]}),t.jsxs("td",{className:"flex gap-2 p-3",children:[t.jsx(x,{href:route("payments.edit",e.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600",children:"Edit"}),t.jsx(x,{href:route("payments.show",e.id),className:"rounded bg-sky-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-sky-600",children:"Detail"}),t.jsx("button",{onClick:()=>d(e),disabled:p(e),className:`rounded px-3 py-1 text-sm font-medium text-white ${p(e)?"cursor-not-allowed bg-sky-300":"bg-sky-500 hover:cursor-pointer"}`,title:p(e)?"Tagihan sudah melewati deadline":"Kirim notifikasi",children:"Kirim Notif"}),t.jsx("button",{onClick:()=>l(e),className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-600",children:"Hapus"})]})]},e.id),emptyMessage:"Tidak ada event yang ditemukan"}),t.jsx(C,{links:m.links}),t.jsx(f,{isOpen:!!r,onClose:()=>l(null),title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus event "${r==null?void 0:r.title}"?`,buttons:[{label:"Batal",onClick:()=>l(null),variant:"neutral"},{label:"Ya, Hapus",onClick:()=>r&&j(r.id),variant:"danger"}]}),t.jsx(f,{isOpen:!!i,onClose:()=>d(null),title:"Konfirmasi Notifikasi",message:t.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi untuk tagihan ",t.jsx("strong",{children:i==null?void 0:i.title}),"?",t.jsx("br",{}),t.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim ke orang tua siswa yang belum melakukan pembayaran."})]}),buttons:[{label:"Batal",onClick:()=>d(null),variant:"neutral"},{label:"Kirim Notifikasi",onClick:()=>{i&&(o.post(route("payments.resend-notification",i.id)),d(null))},variant:"primary"}]})]})]})}export{J as default};
