import{r as c,j as i,U as W,b as Qe,u as Ze,H as et,a as tt}from"./app-BeCyjbzU.js";import{S as Le}from"./searchable-select-DuzLyQbX.js";import{A as rt}from"./app-layout-DcP7GnsP.js";import{t as ne,T as nt}from"./index-CuFryUCT.js";import{s as at,p as ot,o as R,K as Z,L as ee,f as st,y as ie,n as fe,_ as Ae,a as ce,O as Ne,u as oe,t as it}from"./use-is-mounted-Drh1ayw1.js";/* empty css            */import"./button-BEK5hkam.js";import"./index-BEtZMnes.js";import"./index-BBjrAkwY.js";import"./index-Cn4ZBZ8K.js";import"./app-logo-icon-LSMy-X9F.js";function lt({value:e,onChange:t,placeholder:r="Search...",options:n}){const[a,l]=c.useState(""),[s,u]=c.useState(!1),p=c.useRef(null),v=n.filter(d=>d.name.toLowerCase().includes(a.toLowerCase())&&!e.includes(d.id)),g=n.filter(d=>e.includes(d.id));c.useEffect(()=>{const d=x=>{p.current&&!p.current.contains(x.target)&&u(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const h=d=>{t([...e,d.id]),l(""),u(!1)},$=d=>{t(e.filter(x=>x!==d))};return i.jsxs("div",{className:"relative",ref:p,children:[i.jsx("div",{className:"flex flex-wrap gap-1 mb-1",children:g.map(d=>i.jsxs("div",{className:"flex items-center rounded bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800",children:[i.jsx("span",{children:d.name}),i.jsx("button",{type:"button",onClick:()=>$(d.id),className:"ml-1 text-gray-500 hover:text-red-500 hover:cursor-pointer",children:"×"})]},d.id))}),i.jsx("div",{className:"flex border border-gray-300 rounded",children:i.jsx("input",{type:"text",value:a,onChange:d=>l(d.target.value),placeholder:r,className:"flex-1 px-3 py-2 outline-none",onFocus:()=>u(!0)})}),s&&i.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border max-h-60 overflow-auto",children:v.length===0?i.jsx("div",{className:"py-2 px-3 text-gray-500",children:"Tidak ditemukan"}):v.map(d=>i.jsx("div",{onClick:()=>h(d),className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",children:d.name},d.id))})]})}const Ie=typeof document<"u"?W.useLayoutEffect:()=>{};var ge;const ut=(ge=W.useInsertionEffect)!==null&&ge!==void 0?ge:Ie;function ct(e){const t=c.useRef(null);return ut(()=>{t.current=e},[e]),c.useCallback((...r)=>{const n=t.current;return n==null?void 0:n(...r)},[])}const B=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},K=e=>e&&"window"in e&&e.window===e?e:B(e).defaultView||window;function dt(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function ft(e){return dt(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let bt=!1;function Se(){return bt}function Me(e,t){if(!Se())return t&&e?e.contains(t):!1;if(!e||!t)return!1;let r=t;for(;r!==null;){if(r===e)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:ft(r)?r=r.host:r=r.parentNode}return!1}const xe=(e=document)=>{var t;if(!Se())return e.activeElement;let r=e.activeElement;for(;r&&"shadowRoot"in r&&(!((t=r.shadowRoot)===null||t===void 0)&&t.activeElement);)r=r.shadowRoot.activeElement;return r};function ke(e){return Se()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function mt(e){var t;if(typeof window>"u"||window.navigator==null)return!1;let r=(t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands;return Array.isArray(r)&&r.some(n=>e.test(n.brand))||e.test(window.navigator.userAgent)}function pt(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function De(e){let t=null;return()=>(t==null&&(t=e()),t)}const ht=De(function(){return pt(/^Mac/i)}),vt=De(function(){return mt(/Android/i)});function Oe(){let e=c.useRef(new Map),t=c.useCallback((a,l,s,u)=>{let p=u!=null&&u.once?(...v)=>{e.current.delete(s),s(...v)}:s;e.current.set(s,{type:l,eventTarget:a,fn:p,options:u}),a.addEventListener(l,p,u)},[]),r=c.useCallback((a,l,s,u)=>{var p;let v=((p=e.current.get(s))===null||p===void 0?void 0:p.fn)||s;a.removeEventListener(l,v,u),e.current.delete(s)},[]),n=c.useCallback(()=>{e.current.forEach((a,l)=>{r(a.eventTarget,a.type,l,a.options)})},[r]);return c.useEffect(()=>n,[n]),{addGlobalListener:t,removeGlobalListener:r,removeAllGlobalListeners:n}}function gt(e){return e.mozInputSource===0&&e.isTrusted?!0:vt()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function He(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function xt(e,t){Object.defineProperty(e,"target",{value:t}),Object.defineProperty(e,"currentTarget",{value:t})}function Re(e){let t=c.useRef({isFocused:!1,observer:null});Ie(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=ct(n=>{e==null||e(n)});return c.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;let a=n.target,l=s=>{if(t.current.isFocused=!1,a.disabled){let u=He(s);r(u)}t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};a.addEventListener("focusout",l,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&a.disabled){var s;(s=t.current.observer)===null||s===void 0||s.disconnect();let u=a===document.activeElement?null:document.activeElement;a.dispatchEvent(new FocusEvent("blur",{relatedTarget:u})),a.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:u}))}}),t.current.observer.observe(a,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let yt=!1,le=null,ye=new Set,se=new Map,V=!1,$e=!1;const $t={Tab:!0,Escape:!0};function Te(e,t){for(let r of ye)r(e,t)}function wt(e){return!(e.metaKey||!ht()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function be(e){V=!0,wt(e)&&(le="keyboard",Te("keyboard",e))}function Y(e){le="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(V=!0,Te("pointer",e))}function Ge(e){gt(e)&&(V=!0,le="virtual")}function We(e){e.target===window||e.target===document||yt||!e.isTrusted||(!V&&!$e&&(le="virtual",Te("virtual",e)),V=!1,$e=!1)}function Be(){V=!1,$e=!0}function we(e){if(typeof window>"u"||typeof document>"u"||se.get(K(e)))return;const t=K(e),r=B(e);let n=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){V=!0,n.apply(this,arguments)},r.addEventListener("keydown",be,!0),r.addEventListener("keyup",be,!0),r.addEventListener("click",Ge,!0),t.addEventListener("focus",We,!0),t.addEventListener("blur",Be,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",Y,!0),r.addEventListener("pointermove",Y,!0),r.addEventListener("pointerup",Y,!0)),t.addEventListener("beforeunload",()=>{Ue(e)},{once:!0}),se.set(t,{focus:n})}const Ue=(e,t)=>{const r=K(e),n=B(e);t&&n.removeEventListener("DOMContentLoaded",t),se.has(r)&&(r.HTMLElement.prototype.focus=se.get(r).focus,n.removeEventListener("keydown",be,!0),n.removeEventListener("keyup",be,!0),n.removeEventListener("click",Ge,!0),r.removeEventListener("focus",We,!0),r.removeEventListener("blur",Be,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",Y,!0),n.removeEventListener("pointermove",Y,!0),n.removeEventListener("pointerup",Y,!0)),se.delete(r))};function Et(e){const t=B(e);let r;return t.readyState!=="loading"?we(e):(r=()=>{we(e)},t.addEventListener("DOMContentLoaded",r)),()=>Ue(e,r)}typeof document<"u"&&Et();function Ke(){return le!=="pointer"}const St=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Tt(e,t,r){let n=B(r==null?void 0:r.target);const a=typeof window<"u"?K(r==null?void 0:r.target).HTMLInputElement:HTMLInputElement,l=typeof window<"u"?K(r==null?void 0:r.target).HTMLTextAreaElement:HTMLTextAreaElement,s=typeof window<"u"?K(r==null?void 0:r.target).HTMLElement:HTMLElement,u=typeof window<"u"?K(r==null?void 0:r.target).KeyboardEvent:KeyboardEvent;return e=e||n.activeElement instanceof a&&!St.has(n.activeElement.type)||n.activeElement instanceof l||n.activeElement instanceof s&&n.activeElement.isContentEditable,!(e&&t==="keyboard"&&r instanceof u&&!$t[r.key])}function jt(e,t,r){we(),c.useEffect(()=>{let n=(a,l)=>{Tt(!!(r!=null&&r.isTextInput),a,l)&&e(Ke())};return ye.add(n),()=>{ye.delete(n)}},t)}function Ft(e){let{isDisabled:t,onFocus:r,onBlur:n,onFocusChange:a}=e;const l=c.useCallback(p=>{if(p.target===p.currentTarget)return n&&n(p),a&&a(!1),!0},[n,a]),s=Re(l),u=c.useCallback(p=>{const v=B(p.target),g=v?xe(v):xe();p.target===p.currentTarget&&g===ke(p.nativeEvent)&&(r&&r(p),a&&a(!0),s(p))},[a,r,s]);return{focusProps:{onFocus:!t&&(r||a||n)?u:void 0,onBlur:!t&&(n||a)?l:void 0}}}function _t(e){let{isDisabled:t,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:a}=e,l=c.useRef({isFocusWithin:!1}),{addGlobalListener:s,removeAllGlobalListeners:u}=Oe(),p=c.useCallback(h=>{h.currentTarget.contains(h.target)&&l.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(l.current.isFocusWithin=!1,u(),r&&r(h),a&&a(!1))},[r,a,l,u]),v=Re(p),g=c.useCallback(h=>{if(!h.currentTarget.contains(h.target))return;const $=B(h.target),d=xe($);if(!l.current.isFocusWithin&&d===ke(h.nativeEvent)){n&&n(h),a&&a(!0),l.current.isFocusWithin=!0,v(h);let x=h.currentTarget;s($,"focus",w=>{if(l.current.isFocusWithin&&!Me(x,w.target)){let _=new $.defaultView.FocusEvent("blur",{relatedTarget:w.target});xt(_,x);let E=He(_);p(E)}},{capture:!0})}},[n,a,v,s,p]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:g,onBlur:p}}}let Ee=!1,de=0;function Pt(){Ee=!0,setTimeout(()=>{Ee=!1},50)}function Ce(e){e.pointerType==="touch"&&Pt()}function Lt(){if(!(typeof document>"u"))return de===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",Ce),de++,()=>{de--,!(de>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",Ce)}}function Nt(e){let{onHoverStart:t,onHoverChange:r,onHoverEnd:n,isDisabled:a}=e,[l,s]=c.useState(!1),u=c.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;c.useEffect(Lt,[]);let{addGlobalListener:p,removeAllGlobalListeners:v}=Oe(),{hoverProps:g,triggerHoverEnd:h}=c.useMemo(()=>{let $=(w,_)=>{if(u.pointerType=_,a||_==="touch"||u.isHovered||!w.currentTarget.contains(w.target))return;u.isHovered=!0;let E=w.currentTarget;u.target=E,p(B(w.target),"pointerover",S=>{u.isHovered&&u.target&&!Me(u.target,S.target)&&d(S,S.pointerType)},{capture:!0}),t&&t({type:"hoverstart",target:E,pointerType:_}),r&&r(!0),s(!0)},d=(w,_)=>{let E=u.target;u.pointerType="",u.target=null,!(_==="touch"||!u.isHovered||!E)&&(u.isHovered=!1,v(),n&&n({type:"hoverend",target:E,pointerType:_}),r&&r(!1),s(!1))},x={};return typeof PointerEvent<"u"&&(x.onPointerEnter=w=>{Ee&&w.pointerType==="mouse"||$(w,w.pointerType)},x.onPointerLeave=w=>{!a&&w.currentTarget.contains(w.target)&&d(w,w.pointerType)}),{hoverProps:x,triggerHoverEnd:d}},[t,r,n,a,u,p,v]);return c.useEffect(()=>{a&&h({currentTarget:u.target},u.pointerType)},[a]),{hoverProps:g,isHovered:l}}function Ve(e={}){let{autoFocus:t=!1,isTextInput:r,within:n}=e,a=c.useRef({isFocused:!1,isFocusVisible:t||Ke()}),[l,s]=c.useState(!1),[u,p]=c.useState(()=>a.current.isFocused&&a.current.isFocusVisible),v=c.useCallback(()=>p(a.current.isFocused&&a.current.isFocusVisible),[]),g=c.useCallback(d=>{a.current.isFocused=d,s(d),v()},[v]);jt(d=>{a.current.isFocusVisible=d,v()},[],{isTextInput:r});let{focusProps:h}=Ft({isDisabled:n,onFocusChange:g}),{focusWithinProps:$}=_t({isDisabled:!n,onFocusWithinChange:g});return{isFocused:l,isFocusVisible:u,focusProps:n?$:h}}function qe(e){var t,r;return at.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?(r=(t=e.current)==null?void 0:t.ownerDocument)!=null?r:document:null:document}function Ct(e){let t=e.width/2,r=e.height/2;return{top:e.clientY-r,right:e.clientX+t,bottom:e.clientY+r,left:e.clientX-t}}function At(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function It({disabled:e=!1}={}){let t=c.useRef(null),[r,n]=c.useState(!1),a=ot(),l=R(()=>{t.current=null,n(!1),a.dispose()}),s=R(u=>{if(a.dispose(),t.current===null){t.current=u.currentTarget,n(!0);{let p=qe(u.currentTarget);a.addEventListener(p,"pointerup",l,!1),a.addEventListener(p,"pointermove",v=>{if(t.current){let g=Ct(v);n(At(g,t.current.getBoundingClientRect()))}},!1),a.addEventListener(p,"pointercancel",l,!1)}}});return{pressed:r,pressProps:e?{}:{onPointerDown:s,onPointerUp:l,onClick:l}}}let Mt="span";var Xe=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Xe||{});function kt(e,t){var r;let{features:n=1,...a}=e,l={ref:t,"aria-hidden":(n&2)===2?!0:(r=a["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ee()({ourProps:l,theirProps:a,slot:{},defaultTag:Mt,name:"Hidden"})}let ze=Z(kt);var I=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(I||{});let Dt=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),Ot=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var M=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(M||{}),ae=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ae||{}),Ht=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Ht||{});function Rt(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Dt)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function Gt(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Ot)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Wt=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Wt||{}),Bt=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Bt||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let Ut=["textarea","input"].join(",");function Kt(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Ut))!=null?r:!1}function J(e,t=r=>r){return e.slice().sort((r,n)=>{let a=t(r),l=t(n);if(a===null||l===null)return 0;let s=a.compareDocumentPosition(l);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function X(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:a=[]}={}){let l=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,s=Array.isArray(e)?r?J(e):e:t&64?Gt(e):Rt(e);a.length>0&&s.length>1&&(s=s.filter(d=>!a.some(x=>x!=null&&"current"in x?(x==null?void 0:x.current)===d:x===d))),n=n??l.activeElement;let u=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),p=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,s.indexOf(n))-1;if(t&4)return Math.max(0,s.indexOf(n))+1;if(t&8)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),v=t&32?{preventScroll:!0}:{},g=0,h=s.length,$;do{if(g>=h||g+h<=0)return 0;let d=p+g;if(t&16)d=(d+h)%h;else{if(d<0)return 3;if(d>=h)return 1}$=s[d],$==null||$.focus(v),g+=u}while($!==l.activeElement);return t&6&&Kt($)&&$.select(),2}function Vt(e,t){return c.useMemo(()=>{var r;if(e.type)return e.type;let n=(r=e.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||(t==null?void 0:t.tagName)==="BUTTON"&&!t.hasAttribute("type"))return"button"},[e.type,e.as,t])}function qt({onFocus:e}){let[t,r]=c.useState(!0),n=st();return t?W.createElement(ze,{as:"button",type:"button",features:Xe.Focusable,onFocus:a=>{a.preventDefault();let l,s=50;function u(){if(s--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!n.current)return;r(!1);return}l=requestAnimationFrame(u)}l=requestAnimationFrame(u)}}):null}const Je=c.createContext(null);function Xt(){return{groups:new Map,get(e,t){var r;let n=this.groups.get(e);n||(n=new Map,this.groups.set(e,n));let a=(r=n.get(t))!=null?r:0;n.set(t,a+1);let l=Array.from(n.keys()).indexOf(t);function s(){let u=n.get(t);u>1?n.set(t,u-1):n.delete(t)}return[l,s]}}}function zt({children:e}){let t=c.useRef(Xt());return c.createElement(Je.Provider,{value:t},e)}function Ye(e){let t=c.useContext(Je);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let r=c.useId(),[n,a]=t.current.get(e,r);return c.useEffect(()=>a,[]),n}var Jt=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Jt||{}),Yt=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Yt||{}),Qt=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Qt||{});let Zt={0(e,t){var r;let n=J(e.tabs,g=>g.current),a=J(e.panels,g=>g.current),l=n.filter(g=>{var h;return!((h=g.current)!=null&&h.hasAttribute("disabled"))}),s={...e,tabs:n,panels:a};if(t.index<0||t.index>n.length-1){let g=oe(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>oe(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return s;let h=oe(g,{0:()=>n.indexOf(l[0]),1:()=>n.indexOf(l[l.length-1])});return{...s,selectedIndex:h===-1?e.selectedIndex:h}}let u=n.slice(0,t.index),p=[...n.slice(t.index),...u].find(g=>l.includes(g));if(!p)return s;let v=(r=n.indexOf(p))!=null?r:e.selectedIndex;return v===-1&&(v=e.selectedIndex),{...s,selectedIndex:v}},1(e,t){if(e.tabs.includes(t.tab))return e;let r=e.tabs[e.selectedIndex],n=J([...e.tabs,t.tab],l=>l.current),a=e.selectedIndex;return e.info.current.isControlled||(a=n.indexOf(r),a===-1&&(a=e.selectedIndex)),{...e,tabs:n,selectedIndex:a}},2(e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:J([...e.panels,t.panel],r=>r.current)}},4(e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},je=c.createContext(null);je.displayName="TabsDataContext";function Q(e){let t=c.useContext(je);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Q),r}return t}let Fe=c.createContext(null);Fe.displayName="TabsActionsContext";function _e(e){let t=c.useContext(Fe);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,_e),r}return t}function er(e,t){return oe(t.type,Zt,e,t)}let tr="div";function rr(e,t){let{defaultIndex:r=0,vertical:n=!1,manual:a=!1,onChange:l,selectedIndex:s=null,...u}=e;const p=n?"vertical":"horizontal",v=a?"manual":"auto";let g=s!==null,h=ce({isControlled:g}),$=ie(t),[d,x]=c.useReducer(er,{info:h,selectedIndex:s??r,tabs:[],panels:[]}),w=c.useMemo(()=>({selectedIndex:d.selectedIndex}),[d.selectedIndex]),_=ce(l||(()=>{})),E=ce(d.tabs),S=c.useMemo(()=>({orientation:p,activation:v,...d}),[p,v,d]),P=R(F=>(x({type:1,tab:F}),()=>x({type:2,tab:F}))),k=R(F=>(x({type:3,panel:F}),()=>x({type:4,panel:F}))),L=R(F=>{C.current!==F&&_.current(F),g||x({type:0,index:F})}),C=ce(g?e.selectedIndex:d.selectedIndex),O=c.useMemo(()=>({registerTab:P,registerPanel:k,change:L}),[]);fe(()=>{x({type:0,index:s??r})},[s]),fe(()=>{if(C.current===void 0||d.tabs.length<=0)return;let F=J(d.tabs,D=>D.current);F.some((D,H)=>d.tabs[H]!==D)&&L(F.indexOf(d.tabs[C.current]))});let te={ref:$},U=ee();return W.createElement(zt,null,W.createElement(Fe.Provider,{value:O},W.createElement(je.Provider,{value:S},S.tabs.length<=0&&W.createElement(qt,{onFocus:()=>{var F,D;for(let H of E.current)if(((F=H.current)==null?void 0:F.tabIndex)===0)return(D=H.current)==null||D.focus(),!0;return!1}}),U({ourProps:te,theirProps:u,slot:w,defaultTag:tr,name:"Tabs"}))))}let nr="div";function ar(e,t){let{orientation:r,selectedIndex:n}=Q("Tab.List"),a=ie(t),l=c.useMemo(()=>({selectedIndex:n}),[n]),s=e,u={ref:a,role:"tablist","aria-orientation":r};return ee()({ourProps:u,theirProps:s,slot:l,defaultTag:nr,name:"Tabs.List"})}let or="button";function sr(e,t){var r,n;let a=c.useId(),{id:l=`headlessui-tabs-tab-${a}`,disabled:s=!1,autoFocus:u=!1,...p}=e,{orientation:v,activation:g,selectedIndex:h,tabs:$,panels:d}=Q("Tab"),x=_e("Tab"),w=Q("Tab"),[_,E]=c.useState(null),S=c.useRef(null),P=ie(S,t,E);fe(()=>x.registerTab(S),[x,S]);let k=Ye("tabs"),L=$.indexOf(S);L===-1&&(L=k);let C=L===h,O=R(T=>{var o;let b=T();if(b===ae.Success&&g==="auto"){let m=(o=qe(S))==null?void 0:o.activeElement,f=w.tabs.findIndex(y=>y.current===m);f!==-1&&x.change(f)}return b}),te=R(T=>{let o=$.map(b=>b.current).filter(Boolean);if(T.key===I.Space||T.key===I.Enter){T.preventDefault(),T.stopPropagation(),x.change(L);return}switch(T.key){case I.Home:case I.PageUp:return T.preventDefault(),T.stopPropagation(),O(()=>X(o,M.First));case I.End:case I.PageDown:return T.preventDefault(),T.stopPropagation(),O(()=>X(o,M.Last))}if(O(()=>oe(v,{vertical(){return T.key===I.ArrowUp?X(o,M.Previous|M.WrapAround):T.key===I.ArrowDown?X(o,M.Next|M.WrapAround):ae.Error},horizontal(){return T.key===I.ArrowLeft?X(o,M.Previous|M.WrapAround):T.key===I.ArrowRight?X(o,M.Next|M.WrapAround):ae.Error}}))===ae.Success)return T.preventDefault()}),U=c.useRef(!1),F=R(()=>{var T;U.current||(U.current=!0,(T=S.current)==null||T.focus({preventScroll:!0}),x.change(L),it(()=>{U.current=!1}))}),D=R(T=>{T.preventDefault()}),{isFocusVisible:H,focusProps:q}=Ve({autoFocus:u}),{isHovered:re,hoverProps:me}=Nt({isDisabled:s}),{pressed:ue,pressProps:pe}=It({disabled:s}),he=c.useMemo(()=>({selected:C,hover:re,active:ue,focus:H,autofocus:u,disabled:s}),[C,re,H,ue,u,s]),ve=Ae({ref:P,onKeyDown:te,onMouseDown:D,onClick:F,id:l,role:"tab",type:Vt(e,_),"aria-controls":(n=(r=d[L])==null?void 0:r.current)==null?void 0:n.id,"aria-selected":C,tabIndex:C?0:-1,disabled:s||void 0,autoFocus:u},q,me,pe);return ee()({ourProps:ve,theirProps:p,slot:he,defaultTag:or,name:"Tabs.Tab"})}let ir="div";function lr(e,t){let{selectedIndex:r}=Q("Tab.Panels"),n=ie(t),a=c.useMemo(()=>({selectedIndex:r}),[r]),l=e,s={ref:n};return ee()({ourProps:s,theirProps:l,slot:a,defaultTag:ir,name:"Tabs.Panels"})}let ur="div",cr=Ne.RenderStrategy|Ne.Static;function dr(e,t){var r,n,a,l;let s=c.useId(),{id:u=`headlessui-tabs-panel-${s}`,tabIndex:p=0,...v}=e,{selectedIndex:g,tabs:h,panels:$}=Q("Tab.Panel"),d=_e("Tab.Panel"),x=c.useRef(null),w=ie(x,t);fe(()=>d.registerPanel(x),[d,x]);let _=Ye("panels"),E=$.indexOf(x);E===-1&&(E=_);let S=E===g,{isFocusVisible:P,focusProps:k}=Ve(),L=c.useMemo(()=>({selected:S,focus:P}),[S,P]),C=Ae({ref:w,id:u,role:"tabpanel","aria-labelledby":(n=(r=h[E])==null?void 0:r.current)==null?void 0:n.id,tabIndex:S?p:-1},k),O=ee();return!S&&((a=v.unmount)==null||a)&&!((l=v.static)!=null&&l)?W.createElement(ze,{"aria-hidden":"true",...C}):O({ourProps:C,theirProps:v,slot:L,defaultTag:ur,features:cr,visible:S,name:"Tabs.Panel"})}let fr=Z(sr),br=Z(rr),mr=Z(ar),pr=Z(lr),hr=Z(dr),z=Object.assign(fr,{Group:br,List:mr,Panels:pr,Panel:hr});const vr=(e,t)=>[{title:"Kelas",href:"/classrooms"},{title:e,href:`/classrooms/${t}`},{title:"Jadwal",href:""}];function Pr({classroom:e,days:t,shiftings:r,teachers:n,academicYear:a,subjectSchedulesByDay:l,subjects:s}){const{data:u,setData:p,post:v,processing:g}=Qe({days:t}),[h,$]=c.useState(()=>pe(l)),[d,x]=c.useState(!1),[w,_]=c.useState(a.attendance_mode==="per-shift"?0:1),[E,S]=c.useState(null),{flash:P}=Ze().props,k=a.attendance_mode==="per-shift",L=a.attendance_mode==="per-subject",C=c.useMemo(()=>he(n),[n]);c.useEffect(()=>{P!=null&&P.success&&ne.success(P.success),P!=null&&P.error&&ne.error(P.error)},[P]),c.useEffect(()=>{_(k?0:1)},[a.attendance_mode]);const O=o=>{o===0&&k||o===1&&L?_(o):ne.warning(`Current attendance mode is "${a.attendance_mode}". Switch mode in Academic Year settings to access this feature.`)},te=(o,b)=>{const m=[...u.days];m[o]={...m[o],shifting_id:b,teachers:b?m[o].teachers:[],selected_teachers:b?m[o].selected_teachers:[]},p("days",m)},U=(o,b)=>{const m=[...u.days],f=b.filter(j=>j!==null).map(Number),y=f.map(j=>{var N;return{id:j,name:((N=n.find(G=>G.id===j))==null?void 0:N.full_name)||"Unknown"}});m[o]={...m[o],teachers:f,selected_teachers:y},p("days",m)},F=(o,b)=>{const m={...h[o][b]};S({day:o,index:b,original:m})},D=(o,b)=>{E&&($(m=>{const f=[...m[o]];return f[b]=E.original,{...m,[o]:f}}),S(null))},H=o=>{$(b=>({...b,[o]:[...b[o]||[],{subject_id:null,teacher_id:null,start_hour:"08:00",end_hour:"09:00",editable:!0}]}))},q=(o,b,m,f)=>{$(y=>{const j=[...y[o]];return j[b]={...j[b],[m]:f},{...y,[o]:j}})},re=(o,b)=>{$(m=>{const f=[...m[o]];return f.splice(b,1),{...m,[o]:f}})},me=o=>{o.preventDefault(),v(route("classrooms.schedule.shift.save",e.id))},ue=o=>{o.preventDefault();const b=ve(h),m=T(b);if(m.length>0){m.forEach(f=>ne.error(f));return}x(!0),tt.post(route("classrooms.schedule.subject.save",e.id),{schedules:b},{onError:f=>{Object.values(f).flat().forEach(y=>ne.error(y))},onSuccess:()=>{window.location.reload()},onFinish:()=>{x(!1)}})};function pe(o){var m;const b={};for(let f=1;f<=7;f++)b[f]=((m=o[f])==null?void 0:m.map(y=>({id:y.id,subject_id:y.subject_id,teacher_id:y.teacher_id,start_hour:y.start_hour,end_hour:y.end_hour})))||[];return b}function he(o){return o.map(b=>({id:b.id,name:b.full_name}))}function ve(o){return Object.entries(o).flatMap(([b,m])=>m.map(f=>({id:f.id||void 0,day:parseInt(b),subject_id:f.subject_id??null,teacher_id:f.teacher_id??null,start_hour:f.start_hour??"",end_hour:f.end_hour??""}))).sort((b,m)=>b.day-m.day||b.start_hour.localeCompare(m.start_hour))}function T(o){const b=[],m={};return o.forEach((f,y)=>{f.day||b.push(`Schedule at index ${y+1} is missing day`),f.subject_id||b.push(`Schedule on day ${f.day} is missing subject`),f.teacher_id||b.push(`Schedule on day ${f.day} is missing teacher`),(!f.start_hour||!f.end_hour)&&b.push(`Schedule on day ${f.day} is missing start or end time`),f.end_hour<=f.start_hour&&b.push(`Day ${f.day}: End time must be after start time`),m[f.day]||(m[f.day]=[]),m[f.day].push(f)}),Object.entries(m).forEach(([f,y])=>{y.sort((j,N)=>j.start_hour.localeCompare(N.start_hour));for(let j=1;j<y.length;j++){const N=y[j-1],G=y[j];G.start_hour<N.end_hour&&b.push(`Day ${f}: Schedule overlaps between ${N.start_hour}-${N.end_hour} and ${G.start_hour}-${G.end_hour}`)}}),b}return i.jsxs(rt,{breadcrumbs:vr(e.name,e.id),children:[i.jsx(et,{title:`Jadwal - ${e.name}`}),i.jsx(nt,{position:"top-right",richColors:!0}),i.jsxs("div",{className:"rounded-xl bg-white p-6 shadow-lg",children:[i.jsxs("div",{className:"mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[i.jsxs("h1",{className:"text-2xl font-bold",children:["Jadwal: ",e.name]}),i.jsx("button",{type:"submit",form:w===0?"shift-form":"subject-form",disabled:w===0?g:d,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-700 disabled:opacity-50",children:w===0?g?"Saving...":"Save Shift Schedule":d?"Saving...":"Save Subject Schedule"})]}),i.jsxs(z.Group,{selectedIndex:w,onChange:O,children:[i.jsx(z.List,{className:"mb-6 flex rounded-lg bg-blue-100 p-1",children:["By Shifting","By Subject"].map(o=>i.jsx(z,{disabled:o==="By Shifting"&&!k||o==="By Subject"&&!L,className:({selected:b})=>`flex-1 rounded-lg py-3 text-center text-sm font-medium transition-all hover:cursor-pointer ${b?"bg-white text-blue-700 shadow":"text-gray-600 hover:bg-blue-200"} ${o==="By Shifting"&&!k||o==="By Subject"&&!L?"cursor-not-allowed opacity-50":""}`,children:o},o))}),i.jsxs(z.Panels,{children:[i.jsx(z.Panel,{children:i.jsx("form",{id:"shift-form",onSubmit:me,className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.days.map((o,b)=>i.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[i.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:o.day_name}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Shifting:"}),i.jsxs("select",{value:o.shifting_id||"",onChange:m=>te(b,m.target.value?parseInt(m.target.value):null),className:"w-full rounded-md border border-gray-300 bg-gray-50 p-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"-- No Schedule --"}),r.map(m=>i.jsxs("option",{value:m.id,children:[m.name," (",m.start_hour," - ",m.end_hour,")"]},m.id))]})]}),o.shifting_id&&i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Teacher responsible:"}),i.jsx(lt,{value:o.teachers,onChange:m=>U(b,m),placeholder:"Search teachers...",options:C})]})]},o.day))})}),i.jsx(z.Panel,{children:L?i.jsx("form",{id:"subject-form",onSubmit:ue,className:"space-y-6",children:[1,2,3,4,5,6,7].map(o=>{var b,m;return i.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][o-1]}),i.jsx("button",{type:"button",onClick:()=>H(o),className:"inline-flex items-center rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-green-700",children:"+ Add Subject"})]}),i.jsx("div",{className:"grid gap-4 md:grid-cols-1",children:(b=h[o])==null?void 0:b.map((f,y)=>{var G,Pe;const j=(E==null?void 0:E.day)===o&&(E==null?void 0:E.index)===y,N=!f.id;return i.jsx("div",{className:"relative rounded-md border border-gray-300 bg-gray-50 p-4",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Start Time"}),i.jsx("input",{type:"time",value:f.start_hour,onChange:A=>q(o,y,"start_hour",A.target.value),className:`w-full rounded-md border p-2 text-sm ${!j&&!N?"bg-gray-100":"bg-white"}`,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"End Time"}),i.jsx("input",{type:"time",value:f.end_hour,onChange:A=>q(o,y,"end_hour",A.target.value),className:`w-full rounded-md border p-2 text-sm ${!j&&!N?"bg-gray-100":"bg-white"}`,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Subject"}),i.jsx(Le,{value:f.subject_id,onChange:A=>q(o,y,"subject_id",A),placeholder:"Select subject...",endpoint:route("subjects.search"),initialOption:f.subject_id?{id:f.subject_id,full_name:((G=s.find(A=>A.id===f.subject_id))==null?void 0:G.name)||""}:void 0,showInitialOptions:!0,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Teacher"}),i.jsx(Le,{value:f.teacher_id,onChange:A=>q(o,y,"teacher_id",A),placeholder:"Select teacher...",endpoint:route("teachers.search"),initialOption:f.teacher_id?{id:f.teacher_id,full_name:((Pe=n.find(A=>A.id===f.teacher_id))==null?void 0:Pe.full_name)||""}:void 0,showInitialOptions:!0,disabled:!j&&!N})]}),i.jsx("div",{className:"flex h-full items-center justify-start space-x-2 pt-6 md:pt-0",children:N?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>re(o,y),className:"rounded-md bg-gray-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-gray-600",children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-800",children:"Done"})]}):j?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>D(o,y),className:"rounded-md bg-gray-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-gray-600",children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer",children:"Done"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>F(o,y),className:"rounded-md bg-yellow-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-yellow-600",children:"Edit"}),i.jsx("button",{type:"button",onClick:()=>re(o,y),className:"rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-700",children:"Remove"})]})})]})},y)})}),((m=h[o])==null?void 0:m.length)===0&&i.jsx("div",{className:"py-4 text-center text-gray-500",children:"No subjects scheduled for this day"})]},o)})}):i.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center",children:i.jsxs("div",{className:"mx-auto max-w-md",children:[i.jsx("div",{className:"mb-4 text-5xl",children:"⚠️"}),i.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"Attendance Mode Mismatch"}),i.jsx("p",{className:"text-gray-600",children:'Currently active attendance mode is "Per Shift". Switch to "Per Subject" mode in Academic Year settings to use this feature.'})]})})})]})]})]})]})}export{Pr as default};
