import{u as f,r as u,j as t,H as S,a as o,L as x}from"./app-PkndB79V.js";import{A as k}from"./action-modal-S9gMMQue.js";import{P as T}from"./pagination-DmfrbNuB.js";import{T as _}from"./table-BrAUAiMJ.js";import{A as H}from"./app-layout-t0ozXABL.js";import{t as j,T as P}from"./index-Boj8S9x-.js";import{f as D,p as E}from"./parseISO-C9VBp7jN.js";import{i as I}from"./id-PlgGTalb.js";/* empty css            */import"./proxy-Ci-Jvyre.js";import"./createLucideIcon-B5bqn-ja.js";import"./button-BWgq0PXM.js";import"./index-DjQ-EHzR.js";import"./index-Bs5ODDgC.js";import"./index-2NzzaYCb.js";import"./app-logo-icon-D4AnAOwj.js";const K=[{title:"Tagihan",href:"/payments"}];function X(){const{flash:a}=f().props,[h,g]=u.useState([]),[i,l]=u.useState(null),[n,d]=u.useState(null),{payments:m,filters:s,academicYears:b}=f().props,y=Array.isArray(b)?b:[];u.useEffect(()=>{a!=null&&a.success&&j.success(a.success),a!=null&&a.error&&j.error(a.error)},[a]);const v=e=>{o.delete(`payments/${e}`,{onSuccess:()=>{l(null),o.reload()}})},N=e=>{o.get(route("payments.index"),{...s,academic_year:e||null},{preserveState:!0})},w=e=>{g(r=>r.includes(e)?r.filter(c=>c!==e):[...r,e])},C=e=>{o.get(route("payments.index"),{sort:e,direction:s.direction==="asc"?"desc":"asc"},{preserveState:!0})},p=e=>{const r=new Date,c=new Date(e.due_date);return c.setHours(23,59,59,999),r>c},A=[{key:"title",label:"Tagihan",sortable:!0},{key:"academic_year.title",label:"Tahun Ajaran",sortable:!1},{key:"nominal",label:"Nominal",sortable:!0},{key:"due_date",label:"Batas Waktu",sortable:!0},{key:"actions",label:"Aksi",sortable:!1}];return t.jsxs(H,{breadcrumbs:K,children:[t.jsx(S,{title:"Tagihan"}),t.jsx(P,{position:"top-right",richColors:!0}),t.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",placeholder:"Cari tagihan...",defaultValue:s.search||"",onChange:e=>o.get(route("payments.index"),{search:e.target.value},{preserveState:!0}),className:"w-64 rounded border px-3 py-1 text-sm"}),t.jsx("div",{className:"relative",children:t.jsx("div",{className:"rounded bg-gray-200 px-3 py-1 text-sm font-medium text-gray-700",children:t.jsxs("select",{value:s.academic_year||"",onChange:e=>N(e.target.value),className:"cursor-pointer bg-transparent outline-none",children:[t.jsx("option",{value:"",children:"Tahun Ajaran"}),y.map(e=>t.jsx("option",{value:e.id,children:e.title},e.id))]})})})]}),t.jsx(x,{href:route("payments.create"),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Buat Tagihan"})]}),t.jsx(_,{headers:A,data:m.data,sortColumn:s.direction==="asc"||s.direction==="desc"?s.direction:"asc",onSort:C,onSelectAll:e=>g(e?m.data.map(r=>r.id):[]),selectedIds:h,rowRender:e=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"w-[10px] p-3 text-sm",children:t.jsx("input",{type:"checkbox",checked:h.includes(e.id),onChange:()=>w(e.id)})}),t.jsx("td",{className:"p-3 text-sm",children:e.title}),t.jsx("td",{className:"p-3 text-sm",children:e.academic_year.title}),t.jsxs("td",{className:"p-3 text-sm",children:["Rp ",e.nominal.toLocaleString("id-ID")]}),t.jsxs("td",{className:"p-3 text-sm",children:[" ",D(E(e.due_date),"dd MMM yyyy",{locale:I})]}),t.jsxs("td",{className:"flex gap-2 p-3",children:[t.jsx(x,{href:route("payments.edit",e.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600",children:"Edit"}),t.jsx(x,{href:route("payments.show",e.id),className:"rounded bg-sky-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-sky-600",children:"Detail"}),t.jsx("button",{onClick:()=>d(e),disabled:p(e),className:`rounded px-3 py-1 text-sm font-medium text-white ${p(e)?"cursor-not-allowed bg-sky-300":"bg-sky-500 hover:cursor-pointer"}`,title:p(e)?"Tagihan sudah melewati deadline":"Kirim notifikasi",children:"Kirim Notif"}),t.jsx("button",{onClick:()=>l(e),className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-600",children:"Hapus"})]})]},e.id),emptyMessage:"Tidak ada tagihan yang ditemukan"}),t.jsx(T,{links:m.links}),t.jsx(k,{isOpen:!!i,onClose:()=>l(null),title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus tagihan "${i==null?void 0:i.title}"?`,buttons:[{label:"Batal",onClick:()=>l(null),variant:"neutral"},{label:"Ya, Hapus",onClick:()=>i&&v(i.id),variant:"danger"}]}),t.jsx(k,{isOpen:!!n,onClose:()=>d(null),title:"Konfirmasi Notifikasi",message:t.jsxs("span",{children:["Apakah Anda yakin ingin mengirim notifikasi untuk tagihan ",t.jsx("strong",{children:n==null?void 0:n.title}),"?",t.jsx("br",{}),t.jsx("small",{className:"text-gray-500",children:"Notifikasi akan dikirim ke orang tua siswa yang belum melakukan pembayaran."})]}),buttons:[{label:"Batal",onClick:()=>d(null),variant:"neutral"},{label:"Kirim Notifikasi",onClick:()=>{n&&(o.post(route("payments.resend-notification",n.id)),d(null))},variant:"primary"}]})]})]})}export{X as default};
