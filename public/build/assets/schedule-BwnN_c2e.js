import{r as c,j as i,U,v as Je,q as Qe,$ as Ze,m as et}from"./app--8tztu9u.js";import{S as Pe}from"./searchable-select-ZjCYQHUf.js";import{A as tt}from"./app-layout-cdbmaNQy.js";import{t as ne,T as rt}from"./index-CAEQJ3gJ.js";import{s as nt,p as ot,o as R,K as Z,L as ee,f as at,y as ie,n as de,_ as Ce,a as ce,O as Le,u as ae,t as st}from"./use-is-mounted-DkT2cBP5.js";/* empty css            */import"./button-CANVr8nS.js";import"./index-CHt9rkk6.js";import"./index-Cl3x8yBZ.js";import"./index-COSppDxn.js";import"./app-logo-icon-D82enWnp.js";function it({value:e,onChange:t,placeholder:r="Search...",options:n}){const[o,l]=c.useState(""),[s,u]=c.useState(!1),p=c.useRef(null),v=n.filter(d=>d.name.toLowerCase().includes(o.toLowerCase())&&!e.includes(d.id)),g=n.filter(d=>e.includes(d.id));c.useEffect(()=>{const d=x=>{p.current&&!p.current.contains(x.target)&&u(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const h=d=>{t([...e,d.id]),l(""),u(!1)},$=d=>{t(e.filter(x=>x!==d))};return i.jsxs("div",{className:"relative",ref:p,children:[i.jsx("div",{className:"flex flex-wrap gap-1 mb-1",children:g.map(d=>i.jsxs("div",{className:"flex items-center rounded bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800",children:[i.jsx("span",{children:d.name}),i.jsx("button",{type:"button",onClick:()=>$(d.id),className:"ml-1 text-gray-500 hover:text-red-500 hover:cursor-pointer",children:"×"})]},d.id))}),i.jsx("div",{className:"flex border border-gray-300 rounded",children:i.jsx("input",{type:"text",value:o,onChange:d=>l(d.target.value),placeholder:r,className:"flex-1 px-3 py-2 outline-none",onFocus:()=>u(!0)})}),s&&i.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border max-h-60 overflow-auto",children:v.length===0?i.jsx("div",{className:"py-2 px-3 text-gray-500",children:"Tidak ditemukan"}):v.map(d=>i.jsx("div",{onClick:()=>h(d),className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",children:d.name},d.id))})]})}const Ae=typeof document<"u"?U.useLayoutEffect:()=>{};function lt(e){const t=c.useRef(null);return Ae(()=>{t.current=e},[e]),c.useCallback((...r)=>{const n=t.current;return n==null?void 0:n(...r)},[])}const W=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},K=e=>e&&"window"in e&&e.window===e?e:W(e).defaultView||window;function ut(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function ct(e){return ut(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let dt=!1;function Ee(){return dt}function Me(e,t){if(!Ee())return t&&e?e.contains(t):!1;if(!e||!t)return!1;let r=t;for(;r!==null;){if(r===e)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:ct(r)?r=r.host:r=r.parentNode}return!1}const ge=(e=document)=>{var t;if(!Ee())return e.activeElement;let r=e.activeElement;for(;r&&"shadowRoot"in r&&(!((t=r.shadowRoot)===null||t===void 0)&&t.activeElement);)r=r.shadowRoot.activeElement;return r};function ke(e){return Ee()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function ft(e){var t;return typeof window>"u"||window.navigator==null?!1:((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands.some(r=>e.test(r.brand)))||e.test(window.navigator.userAgent)}function bt(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function Ie(e){let t=null;return()=>(t==null&&(t=e()),t)}const mt=Ie(function(){return bt(/^Mac/i)}),pt=Ie(function(){return ft(/Android/i)});function De(){let e=c.useRef(new Map),t=c.useCallback((o,l,s,u)=>{let p=u!=null&&u.once?(...v)=>{e.current.delete(s),s(...v)}:s;e.current.set(s,{type:l,eventTarget:o,fn:p,options:u}),o.addEventListener(l,p,u)},[]),r=c.useCallback((o,l,s,u)=>{var p;let v=((p=e.current.get(s))===null||p===void 0?void 0:p.fn)||s;o.removeEventListener(l,v,u),e.current.delete(s)},[]),n=c.useCallback(()=>{e.current.forEach((o,l)=>{r(o.eventTarget,o.type,l,o.options)})},[r]);return c.useEffect(()=>n,[n]),{addGlobalListener:t,removeGlobalListener:r,removeAllGlobalListeners:n}}function ht(e){return e.mozInputSource===0&&e.isTrusted?!0:pt()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function Oe(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function vt(e,t){Object.defineProperty(e,"target",{value:t}),Object.defineProperty(e,"currentTarget",{value:t})}function He(e){let t=c.useRef({isFocused:!1,observer:null});Ae(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=lt(n=>{e==null||e(n)});return c.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;let o=n.target,l=s=>{if(t.current.isFocused=!1,o.disabled){let u=Oe(s);r(u)}t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};o.addEventListener("focusout",l,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&o.disabled){var s;(s=t.current.observer)===null||s===void 0||s.disconnect();let u=o===document.activeElement?null:document.activeElement;o.dispatchEvent(new FocusEvent("blur",{relatedTarget:u})),o.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:u}))}}),t.current.observer.observe(o,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let gt=!1,le=null,xe=new Set,se=new Map,V=!1,ye=!1;const xt={Tab:!0,Escape:!0};function Se(e,t){for(let r of xe)r(e,t)}function yt(e){return!(e.metaKey||!mt()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function fe(e){V=!0,yt(e)&&(le="keyboard",Se("keyboard",e))}function J(e){le="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(V=!0,Se("pointer",e))}function Re(e){ht(e)&&(V=!0,le="virtual")}function Ge(e){e.target===window||e.target===document||gt||!e.isTrusted||(!V&&!ye&&(le="virtual",Se("virtual",e)),V=!1,ye=!1)}function We(){V=!1,ye=!0}function $e(e){if(typeof window>"u"||typeof document>"u"||se.get(K(e)))return;const t=K(e),r=W(e);let n=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){V=!0,n.apply(this,arguments)},r.addEventListener("keydown",fe,!0),r.addEventListener("keyup",fe,!0),r.addEventListener("click",Re,!0),t.addEventListener("focus",Ge,!0),t.addEventListener("blur",We,!1),typeof PointerEvent<"u"&&(r.addEventListener("pointerdown",J,!0),r.addEventListener("pointermove",J,!0),r.addEventListener("pointerup",J,!0)),t.addEventListener("beforeunload",()=>{Be(e)},{once:!0}),se.set(t,{focus:n})}const Be=(e,t)=>{const r=K(e),n=W(e);t&&n.removeEventListener("DOMContentLoaded",t),se.has(r)&&(r.HTMLElement.prototype.focus=se.get(r).focus,n.removeEventListener("keydown",fe,!0),n.removeEventListener("keyup",fe,!0),n.removeEventListener("click",Re,!0),r.removeEventListener("focus",Ge,!0),r.removeEventListener("blur",We,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",J,!0),n.removeEventListener("pointermove",J,!0),n.removeEventListener("pointerup",J,!0)),se.delete(r))};function $t(e){const t=W(e);let r;return t.readyState!=="loading"?$e(e):(r=()=>{$e(e)},t.addEventListener("DOMContentLoaded",r)),()=>Be(e,r)}typeof document<"u"&&$t();function Ue(){return le!=="pointer"}const wt=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Et(e,t,r){let n=W(r==null?void 0:r.target);const o=typeof window<"u"?K(r==null?void 0:r.target).HTMLInputElement:HTMLInputElement,l=typeof window<"u"?K(r==null?void 0:r.target).HTMLTextAreaElement:HTMLTextAreaElement,s=typeof window<"u"?K(r==null?void 0:r.target).HTMLElement:HTMLElement,u=typeof window<"u"?K(r==null?void 0:r.target).KeyboardEvent:KeyboardEvent;return e=e||n.activeElement instanceof o&&!wt.has(n.activeElement.type)||n.activeElement instanceof l||n.activeElement instanceof s&&n.activeElement.isContentEditable,!(e&&t==="keyboard"&&r instanceof u&&!xt[r.key])}function St(e,t,r){$e(),c.useEffect(()=>{let n=(o,l)=>{Et(!!(r!=null&&r.isTextInput),o,l)&&e(Ue())};return xe.add(n),()=>{xe.delete(n)}},t)}function Tt(e){let{isDisabled:t,onFocus:r,onBlur:n,onFocusChange:o}=e;const l=c.useCallback(p=>{if(p.target===p.currentTarget)return n&&n(p),o&&o(!1),!0},[n,o]),s=He(l),u=c.useCallback(p=>{const v=W(p.target),g=v?ge(v):ge();p.target===p.currentTarget&&g===ke(p.nativeEvent)&&(r&&r(p),o&&o(!0),s(p))},[o,r,s]);return{focusProps:{onFocus:!t&&(r||o||n)?u:void 0,onBlur:!t&&(n||o)?l:void 0}}}function jt(e){let{isDisabled:t,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:o}=e,l=c.useRef({isFocusWithin:!1}),{addGlobalListener:s,removeAllGlobalListeners:u}=De(),p=c.useCallback(h=>{h.currentTarget.contains(h.target)&&l.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(l.current.isFocusWithin=!1,u(),r&&r(h),o&&o(!1))},[r,o,l,u]),v=He(p),g=c.useCallback(h=>{if(!h.currentTarget.contains(h.target))return;const $=W(h.target),d=ge($);if(!l.current.isFocusWithin&&d===ke(h.nativeEvent)){n&&n(h),o&&o(!0),l.current.isFocusWithin=!0,v(h);let x=h.currentTarget;s($,"focus",w=>{if(l.current.isFocusWithin&&!Me(x,w.target)){let _=new $.defaultView.FocusEvent("blur",{relatedTarget:w.target});vt(_,x);let E=Oe(_);p(E)}},{capture:!0})}},[n,o,v,s,p]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:g,onBlur:p}}}let we=!1,ve=0;function Ft(){we=!0,setTimeout(()=>{we=!1},50)}function Ne(e){e.pointerType==="touch"&&Ft()}function _t(){if(!(typeof document>"u"))return typeof PointerEvent<"u"&&document.addEventListener("pointerup",Ne),ve++,()=>{ve--,!(ve>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",Ne)}}function Pt(e){let{onHoverStart:t,onHoverChange:r,onHoverEnd:n,isDisabled:o}=e,[l,s]=c.useState(!1),u=c.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;c.useEffect(_t,[]);let{addGlobalListener:p,removeAllGlobalListeners:v}=De(),{hoverProps:g,triggerHoverEnd:h}=c.useMemo(()=>{let $=(w,_)=>{if(u.pointerType=_,o||_==="touch"||u.isHovered||!w.currentTarget.contains(w.target))return;u.isHovered=!0;let E=w.currentTarget;u.target=E,p(W(w.target),"pointerover",S=>{u.isHovered&&u.target&&!Me(u.target,S.target)&&d(S,S.pointerType)},{capture:!0}),t&&t({type:"hoverstart",target:E,pointerType:_}),r&&r(!0),s(!0)},d=(w,_)=>{let E=u.target;u.pointerType="",u.target=null,!(_==="touch"||!u.isHovered||!E)&&(u.isHovered=!1,v(),n&&n({type:"hoverend",target:E,pointerType:_}),r&&r(!1),s(!1))},x={};return typeof PointerEvent<"u"&&(x.onPointerEnter=w=>{we&&w.pointerType==="mouse"||$(w,w.pointerType)},x.onPointerLeave=w=>{!o&&w.currentTarget.contains(w.target)&&d(w,w.pointerType)}),{hoverProps:x,triggerHoverEnd:d}},[t,r,n,o,u,p,v]);return c.useEffect(()=>{o&&h({currentTarget:u.target},u.pointerType)},[o]),{hoverProps:g,isHovered:l}}function Ke(e={}){let{autoFocus:t=!1,isTextInput:r,within:n}=e,o=c.useRef({isFocused:!1,isFocusVisible:t||Ue()}),[l,s]=c.useState(!1),[u,p]=c.useState(()=>o.current.isFocused&&o.current.isFocusVisible),v=c.useCallback(()=>p(o.current.isFocused&&o.current.isFocusVisible),[]),g=c.useCallback(d=>{o.current.isFocused=d,s(d),v()},[v]);St(d=>{o.current.isFocusVisible=d,v()},[],{isTextInput:r});let{focusProps:h}=Tt({isDisabled:n,onFocusChange:g}),{focusWithinProps:$}=jt({isDisabled:!n,onFocusWithinChange:g});return{isFocused:l,isFocusVisible:u,focusProps:n?$:h}}function Ve(e){var t,r;return nt.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?(r=(t=e.current)==null?void 0:t.ownerDocument)!=null?r:document:null:document}function Lt(e){let t=e.width/2,r=e.height/2;return{top:e.clientY-r,right:e.clientX+t,bottom:e.clientY+r,left:e.clientX-t}}function Nt(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function Ct({disabled:e=!1}={}){let t=c.useRef(null),[r,n]=c.useState(!1),o=ot(),l=R(()=>{t.current=null,n(!1),o.dispose()}),s=R(u=>{if(o.dispose(),t.current===null){t.current=u.currentTarget,n(!0);{let p=Ve(u.currentTarget);o.addEventListener(p,"pointerup",l,!1),o.addEventListener(p,"pointermove",v=>{if(t.current){let g=Lt(v);n(Nt(g,t.current.getBoundingClientRect()))}},!1),o.addEventListener(p,"pointercancel",l,!1)}}});return{pressed:r,pressProps:e?{}:{onPointerDown:s,onPointerUp:l,onClick:l}}}let At="span";var qe=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(qe||{});function Mt(e,t){var r;let{features:n=1,...o}=e,l={ref:t,"aria-hidden":(n&2)===2?!0:(r=o["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ee()({ourProps:l,theirProps:o,slot:{},defaultTag:At,name:"Hidden"})}let Xe=Z(Mt);var M=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(M||{});let kt=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),It=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var k=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(k||{}),oe=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(oe||{}),Dt=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Dt||{});function Ot(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(kt)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}function Ht(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(It)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Rt=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Rt||{}),Gt=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Gt||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let Wt=["textarea","input"].join(",");function Bt(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Wt))!=null?r:!1}function Y(e,t=r=>r){return e.slice().sort((r,n)=>{let o=t(r),l=t(n);if(o===null||l===null)return 0;let s=o.compareDocumentPosition(l);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function X(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:o=[]}={}){let l=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,s=Array.isArray(e)?r?Y(e):e:t&64?Ht(e):Ot(e);o.length>0&&s.length>1&&(s=s.filter(d=>!o.some(x=>x!=null&&"current"in x?(x==null?void 0:x.current)===d:x===d))),n=n??l.activeElement;let u=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),p=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,s.indexOf(n))-1;if(t&4)return Math.max(0,s.indexOf(n))+1;if(t&8)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),v=t&32?{preventScroll:!0}:{},g=0,h=s.length,$;do{if(g>=h||g+h<=0)return 0;let d=p+g;if(t&16)d=(d+h)%h;else{if(d<0)return 3;if(d>=h)return 1}$=s[d],$==null||$.focus(v),g+=u}while($!==l.activeElement);return t&6&&Bt($)&&$.select(),2}function Ut(e,t){return c.useMemo(()=>{var r;if(e.type)return e.type;let n=(r=e.as)!=null?r:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||(t==null?void 0:t.tagName)==="BUTTON"&&!t.hasAttribute("type"))return"button"},[e.type,e.as,t])}function Kt({onFocus:e}){let[t,r]=c.useState(!0),n=at();return t?U.createElement(Xe,{as:"button",type:"button",features:qe.Focusable,onFocus:o=>{o.preventDefault();let l,s=50;function u(){if(s--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!n.current)return;r(!1);return}l=requestAnimationFrame(u)}l=requestAnimationFrame(u)}}):null}const ze=c.createContext(null);function Vt(){return{groups:new Map,get(e,t){var r;let n=this.groups.get(e);n||(n=new Map,this.groups.set(e,n));let o=(r=n.get(t))!=null?r:0;n.set(t,o+1);let l=Array.from(n.keys()).indexOf(t);function s(){let u=n.get(t);u>1?n.set(t,u-1):n.delete(t)}return[l,s]}}}function qt({children:e}){let t=c.useRef(Vt());return c.createElement(ze.Provider,{value:t},e)}function Ye(e){let t=c.useContext(ze);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let r=c.useId(),[n,o]=t.current.get(e,r);return c.useEffect(()=>o,[]),n}var Xt=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Xt||{}),zt=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(zt||{}),Yt=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Yt||{});let Jt={0(e,t){var r;let n=Y(e.tabs,g=>g.current),o=Y(e.panels,g=>g.current),l=n.filter(g=>{var h;return!((h=g.current)!=null&&h.hasAttribute("disabled"))}),s={...e,tabs:n,panels:o};if(t.index<0||t.index>n.length-1){let g=ae(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>ae(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return s;let h=ae(g,{0:()=>n.indexOf(l[0]),1:()=>n.indexOf(l[l.length-1])});return{...s,selectedIndex:h===-1?e.selectedIndex:h}}let u=n.slice(0,t.index),p=[...n.slice(t.index),...u].find(g=>l.includes(g));if(!p)return s;let v=(r=n.indexOf(p))!=null?r:e.selectedIndex;return v===-1&&(v=e.selectedIndex),{...s,selectedIndex:v}},1(e,t){if(e.tabs.includes(t.tab))return e;let r=e.tabs[e.selectedIndex],n=Y([...e.tabs,t.tab],l=>l.current),o=e.selectedIndex;return e.info.current.isControlled||(o=n.indexOf(r),o===-1&&(o=e.selectedIndex)),{...e,tabs:n,selectedIndex:o}},2(e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:Y([...e.panels,t.panel],r=>r.current)}},4(e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},Te=c.createContext(null);Te.displayName="TabsDataContext";function Q(e){let t=c.useContext(Te);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Q),r}return t}let je=c.createContext(null);je.displayName="TabsActionsContext";function Fe(e){let t=c.useContext(je);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Fe),r}return t}function Qt(e,t){return ae(t.type,Jt,e,t)}let Zt="div";function er(e,t){let{defaultIndex:r=0,vertical:n=!1,manual:o=!1,onChange:l,selectedIndex:s=null,...u}=e;const p=n?"vertical":"horizontal",v=o?"manual":"auto";let g=s!==null,h=ce({isControlled:g}),$=ie(t),[d,x]=c.useReducer(Qt,{info:h,selectedIndex:s??r,tabs:[],panels:[]}),w=c.useMemo(()=>({selectedIndex:d.selectedIndex}),[d.selectedIndex]),_=ce(l||(()=>{})),E=ce(d.tabs),S=c.useMemo(()=>({orientation:p,activation:v,...d}),[p,v,d]),P=R(F=>(x({type:1,tab:F}),()=>x({type:2,tab:F}))),I=R(F=>(x({type:3,panel:F}),()=>x({type:4,panel:F}))),L=R(F=>{C.current!==F&&_.current(F),g||x({type:0,index:F})}),C=ce(g?e.selectedIndex:d.selectedIndex),O=c.useMemo(()=>({registerTab:P,registerPanel:I,change:L}),[]);de(()=>{x({type:0,index:s??r})},[s]),de(()=>{if(C.current===void 0||d.tabs.length<=0)return;let F=Y(d.tabs,D=>D.current);F.some((D,H)=>d.tabs[H]!==D)&&L(F.indexOf(d.tabs[C.current]))});let te={ref:$},B=ee();return U.createElement(qt,null,U.createElement(je.Provider,{value:O},U.createElement(Te.Provider,{value:S},S.tabs.length<=0&&U.createElement(Kt,{onFocus:()=>{var F,D;for(let H of E.current)if(((F=H.current)==null?void 0:F.tabIndex)===0)return(D=H.current)==null||D.focus(),!0;return!1}}),B({ourProps:te,theirProps:u,slot:w,defaultTag:Zt,name:"Tabs"}))))}let tr="div";function rr(e,t){let{orientation:r,selectedIndex:n}=Q("Tab.List"),o=ie(t),l=c.useMemo(()=>({selectedIndex:n}),[n]),s=e,u={ref:o,role:"tablist","aria-orientation":r};return ee()({ourProps:u,theirProps:s,slot:l,defaultTag:tr,name:"Tabs.List"})}let nr="button";function or(e,t){var r,n;let o=c.useId(),{id:l=`headlessui-tabs-tab-${o}`,disabled:s=!1,autoFocus:u=!1,...p}=e,{orientation:v,activation:g,selectedIndex:h,tabs:$,panels:d}=Q("Tab"),x=Fe("Tab"),w=Q("Tab"),[_,E]=c.useState(null),S=c.useRef(null),P=ie(S,t,E);de(()=>x.registerTab(S),[x,S]);let I=Ye("tabs"),L=$.indexOf(S);L===-1&&(L=I);let C=L===h,O=R(T=>{var a;let b=T();if(b===oe.Success&&g==="auto"){let m=(a=Ve(S))==null?void 0:a.activeElement,f=w.tabs.findIndex(y=>y.current===m);f!==-1&&x.change(f)}return b}),te=R(T=>{let a=$.map(b=>b.current).filter(Boolean);if(T.key===M.Space||T.key===M.Enter){T.preventDefault(),T.stopPropagation(),x.change(L);return}switch(T.key){case M.Home:case M.PageUp:return T.preventDefault(),T.stopPropagation(),O(()=>X(a,k.First));case M.End:case M.PageDown:return T.preventDefault(),T.stopPropagation(),O(()=>X(a,k.Last))}if(O(()=>ae(v,{vertical(){return T.key===M.ArrowUp?X(a,k.Previous|k.WrapAround):T.key===M.ArrowDown?X(a,k.Next|k.WrapAround):oe.Error},horizontal(){return T.key===M.ArrowLeft?X(a,k.Previous|k.WrapAround):T.key===M.ArrowRight?X(a,k.Next|k.WrapAround):oe.Error}}))===oe.Success)return T.preventDefault()}),B=c.useRef(!1),F=R(()=>{var T;B.current||(B.current=!0,(T=S.current)==null||T.focus({preventScroll:!0}),x.change(L),st(()=>{B.current=!1}))}),D=R(T=>{T.preventDefault()}),{isFocusVisible:H,focusProps:q}=Ke({autoFocus:u}),{isHovered:re,hoverProps:be}=Pt({isDisabled:s}),{pressed:ue,pressProps:me}=Ct({disabled:s}),pe=c.useMemo(()=>({selected:C,hover:re,active:ue,focus:H,autofocus:u,disabled:s}),[C,re,H,ue,u,s]),he=Ce({ref:P,onKeyDown:te,onMouseDown:D,onClick:F,id:l,role:"tab",type:Ut(e,_),"aria-controls":(n=(r=d[L])==null?void 0:r.current)==null?void 0:n.id,"aria-selected":C,tabIndex:C?0:-1,disabled:s||void 0,autoFocus:u},q,be,me);return ee()({ourProps:he,theirProps:p,slot:pe,defaultTag:nr,name:"Tabs.Tab"})}let ar="div";function sr(e,t){let{selectedIndex:r}=Q("Tab.Panels"),n=ie(t),o=c.useMemo(()=>({selectedIndex:r}),[r]),l=e,s={ref:n};return ee()({ourProps:s,theirProps:l,slot:o,defaultTag:ar,name:"Tabs.Panels"})}let ir="div",lr=Le.RenderStrategy|Le.Static;function ur(e,t){var r,n,o,l;let s=c.useId(),{id:u=`headlessui-tabs-panel-${s}`,tabIndex:p=0,...v}=e,{selectedIndex:g,tabs:h,panels:$}=Q("Tab.Panel"),d=Fe("Tab.Panel"),x=c.useRef(null),w=ie(x,t);de(()=>d.registerPanel(x),[d,x]);let _=Ye("panels"),E=$.indexOf(x);E===-1&&(E=_);let S=E===g,{isFocusVisible:P,focusProps:I}=Ke(),L=c.useMemo(()=>({selected:S,focus:P}),[S,P]),C=Ce({ref:w,id:u,role:"tabpanel","aria-labelledby":(n=(r=h[E])==null?void 0:r.current)==null?void 0:n.id,tabIndex:S?p:-1},I),O=ee();return!S&&((o=v.unmount)==null||o)&&!((l=v.static)!=null&&l)?U.createElement(Xe,{"aria-hidden":"true",...C}):O({ourProps:C,theirProps:v,slot:L,defaultTag:ir,features:lr,visible:S,name:"Tabs.Panel"})}let cr=Z(or),dr=Z(er),fr=Z(rr),br=Z(sr),mr=Z(ur),z=Object.assign(cr,{Group:dr,List:fr,Panels:br,Panel:mr});const pr=(e,t)=>[{title:"Classrooms",href:"/classrooms"},{title:e,href:`/classrooms/${t}`},{title:"Schedule",href:""}];function Fr({classroom:e,days:t,shiftings:r,teachers:n,academicYear:o,subjectSchedulesByDay:l,subjects:s}){const{data:u,setData:p,post:v,processing:g}=Je({days:t}),[h,$]=c.useState(()=>me(l)),[d,x]=c.useState(!1),[w,_]=c.useState(o.attendance_mode==="per-shift"?0:1),[E,S]=c.useState(null),{flash:P}=Qe().props,I=o.attendance_mode==="per-shift",L=o.attendance_mode==="per-subject",C=c.useMemo(()=>pe(n),[n]);c.useEffect(()=>{P!=null&&P.success&&ne.success(P.success),P!=null&&P.error&&ne.error(P.error)},[P]),c.useEffect(()=>{_(I?0:1)},[o.attendance_mode]);const O=a=>{a===0&&I||a===1&&L?_(a):ne.warning(`Current attendance mode is "${o.attendance_mode}". Switch mode in Academic Year settings to access this feature.`)},te=(a,b)=>{const m=[...u.days];m[a]={...m[a],shifting_id:b,teachers:b?m[a].teachers:[],selected_teachers:b?m[a].selected_teachers:[]},p("days",m)},B=(a,b)=>{const m=[...u.days],f=b.filter(j=>j!==null).map(Number),y=f.map(j=>{var N;return{id:j,name:((N=n.find(G=>G.id===j))==null?void 0:N.full_name)||"Unknown"}});m[a]={...m[a],teachers:f,selected_teachers:y},p("days",m)},F=(a,b)=>{const m={...h[a][b]};S({day:a,index:b,original:m})},D=(a,b)=>{E&&($(m=>{const f=[...m[a]];return f[b]=E.original,{...m,[a]:f}}),S(null))},H=a=>{$(b=>({...b,[a]:[...b[a]||[],{subject_id:null,teacher_id:null,start_hour:"08:00",end_hour:"09:00",editable:!0}]}))},q=(a,b,m,f)=>{$(y=>{const j=[...y[a]];return j[b]={...j[b],[m]:f},{...y,[a]:j}})},re=(a,b)=>{$(m=>{const f=[...m[a]];return f.splice(b,1),{...m,[a]:f}})},be=a=>{a.preventDefault(),v(route("classrooms.schedule.shift.save",e.id))},ue=a=>{a.preventDefault();const b=he(h),m=T(b);if(m.length>0){m.forEach(f=>ne.error(f));return}x(!0),et.post(route("classrooms.schedule.subject.save",e.id),{schedules:b},{onError:f=>{Object.values(f).flat().forEach(y=>ne.error(y))},onSuccess:()=>{window.location.reload()},onFinish:()=>{x(!1)}})};function me(a){var m;const b={};for(let f=1;f<=7;f++)b[f]=((m=a[f])==null?void 0:m.map(y=>({id:y.id,subject_id:y.subject_id,teacher_id:y.teacher_id,start_hour:y.start_hour,end_hour:y.end_hour})))||[];return b}function pe(a){return a.map(b=>({id:b.id,name:b.full_name}))}function he(a){return Object.entries(a).flatMap(([b,m])=>m.map(f=>({id:f.id||void 0,day:parseInt(b),subject_id:f.subject_id??null,teacher_id:f.teacher_id??null,start_hour:f.start_hour??"",end_hour:f.end_hour??""}))).sort((b,m)=>b.day-m.day||b.start_hour.localeCompare(m.start_hour))}function T(a){const b=[],m={};return a.forEach((f,y)=>{f.day||b.push(`Schedule at index ${y+1} is missing day`),f.subject_id||b.push(`Schedule on day ${f.day} is missing subject`),f.teacher_id||b.push(`Schedule on day ${f.day} is missing teacher`),(!f.start_hour||!f.end_hour)&&b.push(`Schedule on day ${f.day} is missing start or end time`),f.end_hour<=f.start_hour&&b.push(`Day ${f.day}: End time must be after start time`),m[f.day]||(m[f.day]=[]),m[f.day].push(f)}),Object.entries(m).forEach(([f,y])=>{y.sort((j,N)=>j.start_hour.localeCompare(N.start_hour));for(let j=1;j<y.length;j++){const N=y[j-1],G=y[j];G.start_hour<N.end_hour&&b.push(`Day ${f}: Schedule overlaps between ${N.start_hour}-${N.end_hour} and ${G.start_hour}-${G.end_hour}`)}}),b}return i.jsxs(tt,{breadcrumbs:pr(e.name,e.id),children:[i.jsx(Ze,{title:`Classroom Schedule - ${e.name}`}),i.jsx(rt,{position:"top-right",richColors:!0}),i.jsxs("div",{className:"rounded-xl bg-white p-6 shadow-lg",children:[i.jsxs("div",{className:"mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[i.jsxs("h1",{className:"text-2xl font-bold",children:["Classroom Schedule: ",e.name]}),i.jsx("button",{type:"submit",form:w===0?"shift-form":"subject-form",disabled:w===0?g:d,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-700 disabled:opacity-50",children:w===0?g?"Saving...":"Save Shift Schedule":d?"Saving...":"Save Subject Schedule"})]}),i.jsxs(z.Group,{selectedIndex:w,onChange:O,children:[i.jsx(z.List,{className:"mb-6 flex rounded-lg bg-blue-100 p-1",children:["By Shifting","By Subject"].map(a=>i.jsx(z,{disabled:a==="By Shifting"&&!I||a==="By Subject"&&!L,className:({selected:b})=>`flex-1 rounded-lg py-3 text-center text-sm font-medium transition-all hover:cursor-pointer ${b?"bg-white text-blue-700 shadow":"text-gray-600 hover:bg-blue-200"} ${a==="By Shifting"&&!I||a==="By Subject"&&!L?"cursor-not-allowed opacity-50":""}`,children:a},a))}),i.jsxs(z.Panels,{children:[i.jsx(z.Panel,{children:i.jsx("form",{id:"shift-form",onSubmit:be,className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.days.map((a,b)=>i.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[i.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:a.day_name}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Shifting:"}),i.jsxs("select",{value:a.shifting_id||"",onChange:m=>te(b,m.target.value?parseInt(m.target.value):null),className:"w-full rounded-md border border-gray-300 bg-gray-50 p-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"-- No Schedule --"}),r.map(m=>i.jsxs("option",{value:m.id,children:[m.name," (",m.start_hour," - ",m.end_hour,")"]},m.id))]})]}),a.shifting_id&&i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Teacher responsible:"}),i.jsx(it,{value:a.teachers,onChange:m=>B(b,m),placeholder:"Search teachers...",options:C})]})]},a.day))})}),i.jsx(z.Panel,{children:L?i.jsx("form",{id:"subject-form",onSubmit:ue,className:"space-y-6",children:[1,2,3,4,5,6,7].map(a=>{var b,m;return i.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][a-1]}),i.jsx("button",{type:"button",onClick:()=>H(a),className:"inline-flex items-center rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-green-700",children:"+ Add Subject"})]}),i.jsx("div",{className:"grid gap-4 md:grid-cols-1",children:(b=h[a])==null?void 0:b.map((f,y)=>{var G,_e;const j=(E==null?void 0:E.day)===a&&(E==null?void 0:E.index)===y,N=!f.id;return i.jsx("div",{className:"relative rounded-md border border-gray-300 bg-gray-50 p-4",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Start Time"}),i.jsx("input",{type:"time",value:f.start_hour,onChange:A=>q(a,y,"start_hour",A.target.value),className:`w-full rounded-md border p-2 text-sm ${!j&&!N?"bg-gray-100":"bg-white"}`,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"End Time"}),i.jsx("input",{type:"time",value:f.end_hour,onChange:A=>q(a,y,"end_hour",A.target.value),className:`w-full rounded-md border p-2 text-sm ${!j&&!N?"bg-gray-100":"bg-white"}`,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Subject"}),i.jsx(Pe,{value:f.subject_id,onChange:A=>q(a,y,"subject_id",A),placeholder:"Select subject...",endpoint:route("subjects.search"),initialOption:f.subject_id?{id:f.subject_id,full_name:((G=s.find(A=>A.id===f.subject_id))==null?void 0:G.name)||""}:void 0,showInitialOptions:!0,disabled:!j&&!N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Teacher"}),i.jsx(Pe,{value:f.teacher_id,onChange:A=>q(a,y,"teacher_id",A),placeholder:"Select teacher...",endpoint:route("teachers.search"),initialOption:f.teacher_id?{id:f.teacher_id,full_name:((_e=n.find(A=>A.id===f.teacher_id))==null?void 0:_e.full_name)||""}:void 0,showInitialOptions:!0,disabled:!j&&!N})]}),i.jsx("div",{className:"flex h-full items-center justify-start space-x-2 pt-6 md:pt-0",children:N?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>re(a,y),className:"rounded-md bg-gray-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-gray-600",children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-800",children:"Done"})]}):j?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>D(a,y),className:"rounded-md bg-gray-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-gray-600",children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer",children:"Done"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>F(a,y),className:"rounded-md bg-yellow-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-yellow-600",children:"Edit"}),i.jsx("button",{type:"button",onClick:()=>re(a,y),className:"rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-700",children:"Remove"})]})})]})},y)})}),((m=h[a])==null?void 0:m.length)===0&&i.jsx("div",{className:"py-4 text-center text-gray-500",children:"No subjects scheduled for this day"})]},a)})}):i.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center",children:i.jsxs("div",{className:"mx-auto max-w-md",children:[i.jsx("div",{className:"mb-4 text-5xl",children:"⚠️"}),i.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"Attendance Mode Mismatch"}),i.jsx("p",{className:"text-gray-600",children:'Currently active attendance mode is "Per Shift". Switch to "Per Subject" mode in Academic Year settings to use this feature.'})]})})})]})]})]})]})}export{Fr as default};
