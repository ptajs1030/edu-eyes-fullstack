import{r as t,u as W,j as e,H as j,L as Y,a as x}from"./app-BMZILHE6.js";import{A as g}from"./action-modal-CIGSXJ0A.js";import{T as G}from"./table-CZz9J_OJ.js";import{A as y}from"./app-layout-0qTxk9DN.js";import{T as N,t as S}from"./index-CEsytOAn.js";/* empty css            */import"./proxy-CCPqb7VT.js";import"./createLucideIcon-BXMkZTgh.js";import"./button-D_56B_0F.js";import"./index-jQvV6yPI.js";import"./index-Cutv5Bmi.js";import"./index-B3X225Rq.js";import"./app-logo-icon-Dd6A7DYb.js";const C=[{title:"Kenaikan Kelas",href:""}];function re({classGroups:L,nextAcademicYear:M,allCompleted:p,hasData:B,hasActiveAcademicYear:b,filters:n,attendanceModes:K}){const[f,P]=t.useState(""),[R,d]=t.useState(!1),[A,o]=t.useState(!1),[E,c]=t.useState(!1),[h,k]=t.useState(!1),[m,l]=t.useState(null),{flash:a}=W().props;t.useEffect(()=>{const s=i=>{var w,v;const r=performance.getEntriesByType("navigation")[0];((i==null?void 0:i.persisted)||(r==null?void 0:r.type)==="back_forward")&&(l(null),(v=(w=S).dismiss)==null||v.call(w))},u=()=>{var i,r;l(null),(r=(i=S).dismiss)==null||r.call(i)};return window.addEventListener("pageshow",s),window.addEventListener("pagehide",u),()=>{window.removeEventListener("pageshow",s),window.removeEventListener("pagehide",u)}},[]),t.useEffect(()=>{const s=()=>sessionStorage.setItem("gp:index:suppressBannerOnce","1");return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]),t.useEffect(()=>{if(sessionStorage.getItem("gp:index:suppressBannerOnce")==="1"){l(null),sessionStorage.removeItem("gp:index:suppressBannerOnce");return}const s=(a==null?void 0:a.success)||(a==null?void 0:a.error);l(s?{type:a!=null&&a.success?"success":"error",message:s}:null)},[a]);const z=s=>{const u=n.sort===s&&n.direction==="asc"?"desc":"asc";x.get(route("grade-promotions.index"),{sort:s,direction:u},{preserveState:!0,replace:!0})},F=[{key:"level",label:"Tingkat",sortable:!0},{key:"name",label:"Kelas Asal",sortable:!0},{key:"status",label:"Status",sortable:!0},{key:"student_count",label:"Jumlah Siswa",sortable:!1},{key:"actions",label:"Aksi",sortable:!1}],T=()=>{d(!0)},I=()=>{x.post(route("grade-promotions.finalize"),{attendance_mode:f},{onSuccess:()=>{d(!1)}})},_=()=>{c(!0)},O=()=>{k(!0),c(!1),x.post(route("grade-promotions.populate"),{},{onFinish:()=>k(!1)})},H=()=>{o(!0)},D=()=>{x.post(route("grade-promotions.reset"),{},{onSuccess:()=>{o(!1)},onError:()=>{o(!1)}})},$=()=>m?e.jsxs("div",{role:"alert",className:`relative mb-4 flex items-start gap-3 rounded-lg border shadow-sm p-3 sm:p-4 ${m.type==="success"?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`,children:[e.jsx("div",{className:"shrink-0",children:m.type==="success"?e.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-10.707a1 1 0 00-1.414-1.414L9 8.586 7.707 7.293A1 1 0 006.293 8.707l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):e.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-6a1 1 0 00-1 1v2a1 1 0 002 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx("p",{className:"font-medium",children:m.message})}),e.jsx("button",{onClick:()=>l(null),"aria-label":"Tutup notifikasi",className:"ml-2 rounded-md p-1.5 text-current/70 hover:bg-black/5 hover:text-current focus:outline-none focus:ring-2 focus:ring-black/10",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}):null;return b?e.jsxs(y,{breadcrumbs:C,children:[e.jsx(j,{title:"Kenaikan Kelas"}),e.jsx(N,{position:"top-right",richColors:!0}),e.jsx("div",{className:"px-6 pt-4",children:e.jsx($,{})}),!b,B?e.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Migrasi Kenaikan Kelas"}),e.jsx("button",{onClick:H,className:"rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-700",children:"Reset Proses"})]}),e.jsx(G,{headers:F,data:L.map(s=>({...s,name:s.classroom.name,level:s.classroom.level})),sortColumn:n.sort??"",sortDirection:n.direction==="asc"||n.direction==="desc"?n.direction:"asc",onSort:z,rowRender:s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"p-4 text-sm",children:["Tingkat ",s.classroom.level]}),e.jsx("td",{className:"p-4 text-sm",children:s.classroom.name}),e.jsx("td",{className:"p-4 text-sm",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="completed"?"Selesai":"Draf"})}),e.jsxs("td",{className:"p-4 text-sm",children:[s.student_count," Siswa"]}),e.jsx("td",{className:"p-4 text-sm",children:e.jsx(Y,{href:route("grade-promotions.show",s.class_id),onClick:()=>sessionStorage.setItem("gp:index:suppressBannerOnce","1"),className:"inline-flex items-center rounded-md bg-blue-600 px-3 py-1 text-sm font-medium text-white hover:bg-blue-700",children:"Atur Siswa"})})]},s.class_id)}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-gray-900",children:"Finalisasi Kenaikan Kelas"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Tahun Ajaran Baru"}),e.jsx("input",{type:"text",value:M,disabled:!0,className:"mt-1 block w-full rounded-md border bg-gray-100 p-2 shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Mode Absensi"}),e.jsxs("select",{value:f,onChange:s=>P(s.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",children:[e.jsx("option",{value:"",children:"-- Select Mode --"}),K.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:T,disabled:!p,className:`rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 ${p?"hover:cursor-pointer":"cursor-not-allowed opacity-50"}`,children:"Finalisasi"})})]}),!p&&e.jsx("p",{className:"mt-2 text-sm text-yellow-600",children:'* Semua kelas harus berstatus "Selesai" sebelum melakukan finalisasi'})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 rounded-xl bg-white p-8 text-center shadow-lg",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Mulai Proses Kenaikan Kelas"}),e.jsx("p",{className:"max-w-md text-sm text-gray-600",children:"Belum ada data migrasi yang tersedia. Klik tombol di bawah untuk menginisialisasi data siswa."}),e.jsx("button",{onClick:_,disabled:h,className:`rounded-md bg-blue-500 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-600 ${h?"cursor-not-allowed opacity-70":""}`,children:h?"Memproses...":"Inisialisasi Data"})]}),e.jsx(g,{isOpen:R,onClose:()=>d(!1),title:"Konfirmasi Finalisasi",message:"Anda yakin ingin memfinalisasi kenaikan kelas? Proses ini tidak dapat dibatalkan dan akan mempengaruhi data siswa.",buttons:[{label:"Batal",onClick:()=>d(!1),variant:"neutral"},{label:"Ya, Finalisasi",onClick:I,variant:"danger"}]}),e.jsx(g,{isOpen:A,onClose:()=>o(!1),title:"Konfirmasi Reset Proses",message:"Anda yakin ingin mereset seluruh proses kenaikan kelas? Semua data sementara akan dihapus permanen.",buttons:[{label:"Batal",onClick:()=>o(!1),variant:"neutral"},{label:"Ya, Reset",onClick:D,variant:"danger"}]}),e.jsx(g,{isOpen:E,onClose:()=>c(!1),title:"Konfirmasi Inisialisasi Data",message:"Anda yakin ingin menginisialisasi data kenaikan kelas?",buttons:[{label:"Batal",onClick:()=>c(!1),variant:"neutral"},{label:"Ya, Inisialisasi",onClick:O,variant:"primary"}]})]}):e.jsxs(y,{breadcrumbs:C,children:[e.jsx(j,{title:"Kenaikan Kelas"}),e.jsx(N,{position:"top-right",richColors:!0}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 rounded-xl bg-white p-8 text-center shadow-lg",children:[e.jsx("div",{className:"rounded-full bg-yellow-100 p-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Tahun Akademik Tidak Ditemukan"}),e.jsx("p",{className:"max-w-md text-sm text-gray-600",children:"Tidak ada tahun akademik yang aktif. Silakan set tahun akademik aktif terlebih dahulu sebelum melanjutkan proses kenaikan kelas."})]})]})}export{re as default};
