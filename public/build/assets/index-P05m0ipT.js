import{u as g,r as p,j as t,H as E,a as i,L as T}from"./app-CEJ31a_F.js";import{A}from"./action-modal-DzoMpF9_.js";import{P as D}from"./pagination-CEpKD2K7.js";import{T as $}from"./table-opt89qiD.js";import{A as _}from"./app-layout-DWjdX06h.js";import{t as j,T as P}from"./index-DzqOr-kh.js";/* empty css            */import"./proxy-Bae1zpGv.js";import"./createLucideIcon-BsNcm_1Y.js";import"./button-BeKLD-W9.js";import"./index-BDSsETW0.js";import"./index-CvcmiQ0h.js";import"./index-D50m-0k2.js";import"./app-logo-icon-CqKwQckR.js";const L=[{title:"Ujian",href:"/exams"}];function K(){const{exams:c,filters:r}=g().props,{flash:a}=g().props;p.useEffect(()=>{a!=null&&a.success&&j.success(a.success),a!=null&&a.error&&j.error(a.error)},[a]);const[o,x]=p.useState([]),[l,d]=p.useState(null),h=(e=null)=>{e?i.get(`/exams/${e.id}/edit`):i.get("/exams/create")},f=async e=>{i.delete(`/exams/${e}`,{onSuccess:()=>{i.reload()}})},y=e=>{x(s=>s.includes(e)?s.filter(u=>u!==e):[...s,e])},k=()=>{if(o.length===0)return;const e=c.data.filter(n=>o.includes(n.id)),s=`Tahun Ajaran,Mata Pelajaran,Nama Exam,Tipe,Tanggal,Jumlah Siswa
`,u=e.map(n=>{var b;return`${(b=n.academicYear)==null?void 0:b.title},${n.subject.name},${n.name},${n.type||""},${n.date},${n.student_count}`}).join(`
`),S=new Blob([s,u],{type:"text/csv"}),C=URL.createObjectURL(S),m=document.createElement("a");m.href=C,m.download="exams.csv",m.click()},N=e=>{i.get(route("exams.index"),{sort:e,direction:r.direction==="asc"?"desc":"asc"},{preserveState:!0})},w=e=>new Date(e).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),v=[{key:"academic_year",label:"Tahun Ajaran",sortable:!0},{key:"subject_name",label:"Mata Pelajaran",sortable:!0},{key:"name",label:"Nama Exam",sortable:!0},{key:"type",label:"Tipe",sortable:!0},{key:"date",label:"Tanggal Pelaksanaan",sortable:!0},{key:"student_count",label:"Jumlah Siswa",sortable:!0},{key:"actions",label:"Action",sortable:!1}];return t.jsxs(_,{breadcrumbs:L,children:[t.jsx(E,{title:"Exam"}),t.jsx(P,{position:"top-right",richColors:!0}),t.jsxs("div",{className:"flex flex-col gap-6 rounded-xl bg-white p-6 text-black shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",placeholder:"Search exam by name or type...",defaultValue:r.search||"",onChange:e=>i.get(route("exams.index"),{search:e.target.value},{preserveState:!0}),className:"w-80 rounded border px-3 py-1"}),t.jsx("button",{disabled:o.length===0,onClick:k,className:`rounded bg-indigo-600 px-3 py-1 text-sm font-medium text-white hover:bg-indigo-700 ${o.length===0?"opacity-50 cursor-not-allowed":"hover:cursor-pointer"}`,children:"Ekspor data yang dipilih"})]}),t.jsx("button",{onClick:()=>h(null),className:"rounded bg-green-600 px-3 py-1 text-sm font-medium text-white transition hover:cursor-pointer hover:bg-green-700",children:"Tambah Exam"})]}),t.jsx($,{headers:v,data:c.data,sortColumn:r.sort??"",sortDirection:r.direction==="asc"||r.direction==="desc"?r.direction:"asc",onSort:N,onSelectAll:e=>x(e?c.data.map(s=>s.id):[]),selectedIds:o,rowRender:e=>{var s;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"w-[10px] p-3 text-sm",children:t.jsx("input",{type:"checkbox",checked:o.includes(e.id),onChange:()=>y(e.id)})}),t.jsx("td",{className:"p-3 text-sm",children:(s=e.academic_year)==null?void 0:s.title}),t.jsx("td",{className:"p-3 text-sm",children:e.subject.name}),t.jsx("td",{className:"p-3 text-sm font-medium",children:e.name}),t.jsx("td",{className:"p-3 text-sm",children:e.type}),t.jsx("td",{className:"p-3 text-sm",children:w(e.date)}),t.jsx("td",{className:"p-3 text-sm",children:t.jsxs("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-xs text-gray-700",children:[e.student_count," Siswa"]})}),t.jsxs("td",{className:"flex justify-center gap-2 p-3",children:[t.jsx("button",{onClick:()=>h(e),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Edit"}),t.jsx(T,{href:route("exams.scoring",e.id),className:"rounded bg-blue-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Penilaian"}),t.jsx("button",{onClick:()=>d(e),className:"rounded bg-red-500 px-3 py-1 text-sm font-medium text-white hover:cursor-pointer",children:"Hapus"})]})]},e.id)}}),t.jsx(D,{links:c.links}),t.jsx(A,{isOpen:!!l,onClose:()=>d(null),title:"Confirm Deletion",message:t.jsxs("span",{children:["Are you sure you want to delete exam ",t.jsx("strong",{children:l==null?void 0:l.name}),"? This action will delete all student assignments and scores and cannot be undone."]}),buttons:[{label:"Cancel",onClick:()=>d(null),variant:"neutral"},{label:"Delete",onClick:()=>{l&&(f(l.id),d(null))},variant:"danger"}]})]})]})}export{K as default};
