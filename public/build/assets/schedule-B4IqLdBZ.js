import{r as h,j as n,R as X,C as Ie,u as Pe,H as ke,a as Me}from"./app-CWwYUGl9.js";import{S as je}from"./searchable-select-CSBmcFZ_.js";import{A as Fe}from"./app-layout-PwhdpOZW.js";import{t as ue,T as Ce}from"./index-C44N-IkU.js";import{$ as Se,a as Oe,w as Ae,e as De,o as L,b as Le}from"./use-resolve-button-type-CqQgD_bO.js";import{K as Y,L as ee,f as Re,y as ie,n as ce,o as W,_ as _e,s as de,O as ye,u as se,t as He}from"./use-is-mounted-DaWK17hh.js";/* empty css            */import"./button-lwhb8nw8.js";import"./index-CId4ej6o.js";import"./index-Cmh05750.js";import"./index-CrccctHS.js";import"./createLucideIcon-0I1_Osul.js";import"./app-logo-icon-Ou5SQxmI.js";function Ge({value:e,onChange:a,placeholder:l="Search...",options:s}){const[c,m]=h.useState(""),[d,b]=h.useState(!1),E=h.useRef(null),N=s.filter(u=>u.name.toLowerCase().includes(c.toLowerCase())&&!e.includes(u.id)),g=s.filter(u=>e.includes(u.id));h.useEffect(()=>{const u=f=>{E.current&&!E.current.contains(f.target)&&b(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const S=u=>{a([...e,u.id]),m(""),b(!1)},_=u=>{a(e.filter(f=>f!==u))};return n.jsxs("div",{className:"relative",ref:E,children:[n.jsx("div",{className:"flex flex-wrap gap-1 mb-1",children:g.map(u=>n.jsxs("div",{className:"flex items-center rounded bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800",children:[n.jsx("span",{children:u.name}),n.jsx("button",{type:"button",onClick:()=>_(u.id),className:"ml-1 text-gray-500 hover:text-red-500 hover:cursor-pointer",children:"×"})]},u.id))}),n.jsx("div",{className:"flex border border-gray-300 rounded",children:n.jsx("input",{type:"text",value:c,onChange:u=>m(u.target.value),placeholder:l,className:"flex-1 px-3 py-2 outline-none",onFocus:()=>b(!0)})}),d&&n.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border max-h-60 overflow-auto",children:N.length===0?n.jsx("div",{className:"py-2 px-3 text-gray-500",children:"Tidak ditemukan"}):N.map(u=>n.jsx("div",{onClick:()=>S(u),className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",children:u.name},u.id))})]})}let Ue="span";var we=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(we||{});function Be(e,a){var l;let{features:s=1,...c}=e,m={ref:a,"aria-hidden":(s&2)===2?!0:(l=c["aria-hidden"])!=null?l:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return ee()({ourProps:m,theirProps:c,slot:{},defaultTag:Ue,name:"Hidden"})}let Ne=Y(Be),Ke=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),qe=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var A=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(A||{}),ne=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ne||{}),We=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(We||{});function Je(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Ke)).sort((a,l)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(l.tabIndex||Number.MAX_SAFE_INTEGER)))}function Ve(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(qe)).sort((a,l)=>Math.sign((a.tabIndex||Number.MAX_SAFE_INTEGER)-(l.tabIndex||Number.MAX_SAFE_INTEGER)))}var ze=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(ze||{}),Xe=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Xe||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let Qe=["textarea","input"].join(",");function Ze(e){var a,l;return(l=(a=e==null?void 0:e.matches)==null?void 0:a.call(e,Qe))!=null?l:!1}function Q(e,a=l=>l){return e.slice().sort((l,s)=>{let c=a(l),m=a(s);if(c===null||m===null)return 0;let d=c.compareDocumentPosition(m);return d&Node.DOCUMENT_POSITION_FOLLOWING?-1:d&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function V(e,a,{sorted:l=!0,relativeTo:s=null,skipElements:c=[]}={}){let m=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,d=Array.isArray(e)?l?Q(e):e:a&64?Ve(e):Je(e);c.length>0&&d.length>1&&(d=d.filter(u=>!c.some(f=>f!=null&&"current"in f?(f==null?void 0:f.current)===u:f===u))),s=s??m.activeElement;let b=(()=>{if(a&5)return 1;if(a&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),E=(()=>{if(a&1)return 0;if(a&2)return Math.max(0,d.indexOf(s))-1;if(a&4)return Math.max(0,d.indexOf(s))+1;if(a&8)return d.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),N=a&32?{preventScroll:!0}:{},g=0,S=d.length,_;do{if(g>=S||g+S<=0)return 0;let u=E+g;if(a&16)u=(u+S)%S;else{if(u<0)return 3;if(u>=S)return 1}_=d[u],_==null||_.focus(N),g+=b}while(_!==m.activeElement);return a&6&&Ze(_)&&_.select(),2}function Ye({onFocus:e}){let[a,l]=h.useState(!0),s=Re();return a?X.createElement(Ne,{as:"button",type:"button",features:we.Focusable,onFocus:c=>{c.preventDefault();let m,d=50;function b(){if(d--<=0){m&&cancelAnimationFrame(m);return}if(e()){if(cancelAnimationFrame(m),!s.current)return;l(!1);return}m=requestAnimationFrame(b)}m=requestAnimationFrame(b)}}):null}const Ee=h.createContext(null);function et(){return{groups:new Map,get(e,a){var l;let s=this.groups.get(e);s||(s=new Map,this.groups.set(e,s));let c=(l=s.get(a))!=null?l:0;s.set(a,c+1);let m=Array.from(s.keys()).indexOf(a);function d(){let b=s.get(a);b>1?s.set(a,b-1):s.delete(a)}return[m,d]}}}function tt({children:e}){let a=h.useRef(et());return h.createElement(Ee.Provider,{value:a},e)}function $e(e){let a=h.useContext(Ee);if(!a)throw new Error("You must wrap your component in a <StableCollection>");let l=h.useId(),[s,c]=a.current.get(e,l);return h.useEffect(()=>c,[]),s}var rt=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(rt||{}),at=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(at||{}),nt=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(nt||{});let st={0(e,a){var l;let s=Q(e.tabs,g=>g.current),c=Q(e.panels,g=>g.current),m=s.filter(g=>{var S;return!((S=g.current)!=null&&S.hasAttribute("disabled"))}),d={...e,tabs:s,panels:c};if(a.index<0||a.index>s.length-1){let g=se(Math.sign(a.index-e.selectedIndex),{[-1]:()=>1,0:()=>se(Math.sign(a.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(m.length===0)return d;let S=se(g,{0:()=>s.indexOf(m[0]),1:()=>s.indexOf(m[m.length-1])});return{...d,selectedIndex:S===-1?e.selectedIndex:S}}let b=s.slice(0,a.index),E=[...s.slice(a.index),...b].find(g=>m.includes(g));if(!E)return d;let N=(l=s.indexOf(E))!=null?l:e.selectedIndex;return N===-1&&(N=e.selectedIndex),{...d,selectedIndex:N}},1(e,a){if(e.tabs.includes(a.tab))return e;let l=e.tabs[e.selectedIndex],s=Q([...e.tabs,a.tab],m=>m.current),c=e.selectedIndex;return e.info.current.isControlled||(c=s.indexOf(l),c===-1&&(c=e.selectedIndex)),{...e,tabs:s,selectedIndex:c}},2(e,a){return{...e,tabs:e.tabs.filter(l=>l!==a.tab)}},3(e,a){return e.panels.includes(a.panel)?e:{...e,panels:Q([...e.panels,a.panel],l=>l.current)}},4(e,a){return{...e,panels:e.panels.filter(l=>l!==a.panel)}}},pe=h.createContext(null);pe.displayName="TabsDataContext";function Z(e){let a=h.useContext(pe);if(a===null){let l=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,Z),l}return a}let xe=h.createContext(null);xe.displayName="TabsActionsContext";function ge(e){let a=h.useContext(xe);if(a===null){let l=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,ge),l}return a}function it(e,a){return se(a.type,st,e,a)}let lt="div";function ot(e,a){let{defaultIndex:l=0,vertical:s=!1,manual:c=!1,onChange:m,selectedIndex:d=null,...b}=e;const E=s?"vertical":"horizontal",N=c?"manual":"auto";let g=d!==null,S=de({isControlled:g}),_=ie(a),[u,f]=h.useReducer(it,{info:S,selectedIndex:d??l,tabs:[],panels:[]}),U=h.useMemo(()=>({selectedIndex:u.selectedIndex}),[u.selectedIndex]),R=de(m||(()=>{})),C=de(u.tabs),x=h.useMemo(()=>({orientation:E,activation:N,...u}),[E,N,u]),F=W($=>(f({type:1,tab:$}),()=>f({type:2,tab:$}))),k=W($=>(f({type:3,panel:$}),()=>f({type:4,panel:$}))),T=W($=>{P.current!==$&&R.current($),g||f({type:0,index:$})}),P=de(g?e.selectedIndex:u.selectedIndex),H=h.useMemo(()=>({registerTab:F,registerPanel:k,change:T}),[]);ce(()=>{f({type:0,index:d??l})},[d]),ce(()=>{if(P.current===void 0||u.tabs.length<=0)return;let $=Q(u.tabs,D=>D.current);$.some((D,G)=>u.tabs[G]!==D)&&T($.indexOf(u.tabs[P.current]))});let te={ref:_},B=ee();return X.createElement(tt,null,X.createElement(xe.Provider,{value:H},X.createElement(pe.Provider,{value:x},x.tabs.length<=0&&X.createElement(Ye,{onFocus:()=>{var $,D;for(let G of C.current)if((($=G.current)==null?void 0:$.tabIndex)===0)return(D=G.current)==null||D.focus(),!0;return!1}}),B({ourProps:te,theirProps:b,slot:U,defaultTag:lt,name:"Tabs"}))))}let ut="div";function dt(e,a){let{orientation:l,selectedIndex:s}=Z("Tab.List"),c=ie(a),m=h.useMemo(()=>({selectedIndex:s}),[s]),d=e,b={ref:c,role:"tablist","aria-orientation":l};return ee()({ourProps:b,theirProps:d,slot:m,defaultTag:ut,name:"Tabs.List"})}let ct="button";function mt(e,a){var l,s;let c=h.useId(),{id:m=`headlessui-tabs-tab-${c}`,disabled:d=!1,autoFocus:b=!1,...E}=e,{orientation:N,activation:g,selectedIndex:S,tabs:_,panels:u}=Z("Tab"),f=ge("Tab"),U=Z("Tab"),[R,C]=h.useState(null),x=h.useRef(null),F=ie(x,a,C);ce(()=>f.registerTab(x),[f,x]);let k=$e("tabs"),T=_.indexOf(x);T===-1&&(T=k);let P=T===S,H=W(y=>{var O;let J=y();if(J===ne.Success&&g==="auto"){let r=(O=Le(x))==null?void 0:O.activeElement,o=U.tabs.findIndex(i=>i.current===r);o!==-1&&f.change(o)}return J}),te=W(y=>{let O=_.map(J=>J.current).filter(Boolean);if(y.key===L.Space||y.key===L.Enter){y.preventDefault(),y.stopPropagation(),f.change(T);return}switch(y.key){case L.Home:case L.PageUp:return y.preventDefault(),y.stopPropagation(),H(()=>V(O,A.First));case L.End:case L.PageDown:return y.preventDefault(),y.stopPropagation(),H(()=>V(O,A.Last))}if(H(()=>se(N,{vertical(){return y.key===L.ArrowUp?V(O,A.Previous|A.WrapAround):y.key===L.ArrowDown?V(O,A.Next|A.WrapAround):ne.Error},horizontal(){return y.key===L.ArrowLeft?V(O,A.Previous|A.WrapAround):y.key===L.ArrowRight?V(O,A.Next|A.WrapAround):ne.Error}}))===ne.Success)return y.preventDefault()}),B=h.useRef(!1),$=W(()=>{var y;B.current||(B.current=!0,(y=x.current)==null||y.focus({preventScroll:!0}),f.change(T),He(()=>{B.current=!1}))}),D=W(y=>{y.preventDefault()}),{isFocusVisible:G,focusProps:me}=Se({autoFocus:b}),{isHovered:K,hoverProps:re}=Oe({isDisabled:d}),{pressed:le,pressProps:he}=Ae({disabled:d}),oe=h.useMemo(()=>({selected:P,hover:K,active:le,focus:G,autofocus:b,disabled:d}),[P,K,G,le,b,d]),fe=_e({ref:F,onKeyDown:te,onMouseDown:D,onClick:$,id:m,role:"tab",type:De(e,R),"aria-controls":(s=(l=u[T])==null?void 0:l.current)==null?void 0:s.id,"aria-selected":P,tabIndex:P?0:-1,disabled:d||void 0,autoFocus:b},me,re,he);return ee()({ourProps:fe,theirProps:E,slot:oe,defaultTag:ct,name:"Tabs.Tab"})}let ht="div";function ft(e,a){let{selectedIndex:l}=Z("Tab.Panels"),s=ie(a),c=h.useMemo(()=>({selectedIndex:l}),[l]),m=e,d={ref:s};return ee()({ourProps:d,theirProps:m,slot:c,defaultTag:ht,name:"Tabs.Panels"})}let bt="div",pt=ye.RenderStrategy|ye.Static;function xt(e,a){var l,s,c,m;let d=h.useId(),{id:b=`headlessui-tabs-panel-${d}`,tabIndex:E=0,...N}=e,{selectedIndex:g,tabs:S,panels:_}=Z("Tab.Panel"),u=ge("Tab.Panel"),f=h.useRef(null),U=ie(f,a);ce(()=>u.registerPanel(f),[u,f]);let R=$e("panels"),C=_.indexOf(f);C===-1&&(C=R);let x=C===g,{isFocusVisible:F,focusProps:k}=Se(),T=h.useMemo(()=>({selected:x,focus:F}),[x,F]),P=_e({ref:U,id:b,role:"tabpanel","aria-labelledby":(s=(l=S[C])==null?void 0:l.current)==null?void 0:s.id,tabIndex:x?E:-1},k),H=ee();return!x&&((c=N.unmount)==null||c)&&!((m=N.static)!=null&&m)?X.createElement(Ne,{"aria-hidden":"true",...P}):H({ourProps:P,theirProps:N,slot:T,defaultTag:bt,features:pt,visible:x,name:"Tabs.Panel"})}let gt=Y(mt),vt=Y(ot),jt=Y(dt),yt=Y(ft),St=Y(xt),z=Object.assign(gt,{Group:vt,List:jt,Panels:yt,Panel:St});const _t=()=>[{title:"Kelas",href:"/classrooms"},{title:"Jadwal",href:""}],be=["Senin","Selasa","Rabu","Kamis","Jum'at","Sabtu","Minggu"];function Lt({classroom:e,days:a,shiftings:l,teachers:s,academicYear:c,subjectSchedulesByDay:m,subjects:d,refreshed_schedules:b}){const{data:E,setData:N,post:g,processing:S}=Ie({days:a}),[_,u]=h.useState(()=>oe(b||m)),[f,U]=h.useState(!1),[R,C]=h.useState(c.attendance_mode==="per-shift"?0:1),[x,F]=h.useState(null),{flash:k}=Pe().props,T=c.attendance_mode==="per-shift",P=c.attendance_mode==="per-subject",H=h.useMemo(()=>fe(s),[s]);h.useEffect(()=>{if(b){const r=oe(b);u(r),F(null)}},[b]),h.useEffect(()=>{k!=null&&k.success&&(ue.success(k.success),F(null)),k!=null&&k.error&&ue.error(k.error)},[k]),h.useEffect(()=>{C(T?0:1)},[T]);const te=r=>{r===0&&T||r===1&&P?C(r):ue.warning(`Current attendance mode is "${c.attendance_mode}". Switch mode in Academic Year settings to access this feature.`)},B=(r,o)=>{const i=[...E.days];i[r]={...i[r],shifting_id:o,teachers:o?i[r].teachers:[],selected_teachers:o?i[r].selected_teachers:[]},N("days",i)},$=(r,o)=>{const i=[...E.days],t=o.filter(w=>w!==null).map(Number),p=t.map(w=>{var I;return{id:w,name:((I=s.find(v=>v.id===w))==null?void 0:I.full_name)||"Unknown"}});i[r]={...i[r],teachers:t,selected_teachers:p},N("days",i)},D=(r,o)=>{const i=_[r][o];if(!i.id||i.id.toString().includes("."))return;const t={...i};F({day:r,index:o,original:t}),u(p=>{const w={...p};return w[r]=w[r].map((I,v)=>({...I,editable:v===o&&!!I.id&&!I.id.toString().includes(".")})),w})},G=(r,o)=>{if(x){const i=_[r][o];!i.id||i.id.toString().includes(".")?re(r,o):u(t=>{const p={...t};return p[r]=p[r].map(w=>({...w,editable:!1})),p[r][o]={...x.original,editable:!1},p})}F(null)},me=r=>{var i;const o=Date.now()+Math.random();u(t=>({...t,[r]:[...t[r]||[],{id:o,subject_id:null,teacher_id:null,start_hour:"",end_hour:"",editable:!0}]})),F({day:r,index:((i=_[r])==null?void 0:i.length)||0,original:{id:o,subject_id:null,teacher_id:null,start_hour:"",end_hour:"",editable:!0}})},K=(r,o,i,t)=>{u(p=>{const w={...p},I=[...w[r]||[]];let v=t;if((i==="start_hour"||i==="end_hour")&&typeof t=="string"&&t.length===5){const[M,j]=t.split(":"),q=Math.min(Math.max(parseInt(M||"0",10),0),23),ae=Math.min(Math.max(parseInt(j||"0",10),0),59);v=`${String(q).padStart(2,"0")}:${String(ae).padStart(2,"0")}`}return I[o]={...I[o],[i]:v},w[r]=I,w})},re=(r,o)=>{u(i=>{const t=[...i[r]];return t.splice(o,1),{...i,[r]:t}}),x&&x.day===r&&x.index===o&&F(null)},le=r=>{r.preventDefault(),g(route("classrooms.schedule.shift.save",e.id))},he=r=>{r.preventDefault();const o=y(_),i=O(o);if(i.length>0){ue.error(i[0]);return}U(!0),Me.post(route("classrooms.schedule.subject.save",e.id),{schedules:o},{onFinish:()=>{U(!1)},preserveState:!1,preserveScroll:!0})};function oe(r){var i;const o={};for(let t=1;t<=7;t++)o[t]=((i=r[t])==null?void 0:i.map(p=>({id:p.id,subject_id:p.subject_id,teacher_id:p.teacher_id,start_hour:p.start_hour,end_hour:p.end_hour,editable:!1})))||[];return o}function fe(r){return r.map(o=>({id:o.id,name:o.full_name}))}function y(r){return Object.entries(r).flatMap(([o,i])=>i.filter(t=>t.subject_id&&t.teacher_id&&t.start_hour&&t.end_hour).map(t=>({id:t.id&&!t.id.toString().includes(".")?t.id:void 0,day:parseInt(o),subject_id:t.subject_id,teacher_id:t.teacher_id,start_hour:t.start_hour,end_hour:t.end_hour}))).sort((o,i)=>o.day-i.day||o.start_hour.localeCompare(i.start_hour))}function O(r){const o={},i=/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/;for(const t of r){if(!t.day&&t.day!==0)return[`Jadwal ke-${r.indexOf(t)+1} tidak memiliki hari yang ditentukan`];if(!t.subject_id)return[`Hari ${t.day}: Mata pelajaran harus dipilih`];if(!t.teacher_id)return[`Hari ${t.day}: Guru pengajar harus dipilih`];if(!t.start_hour||!t.end_hour)return[`Hari ${t.day}: Waktu mulai dan selesai harus diisi`];if(t.start_hour&&!i.test(t.start_hour))return[`Hari ${t.day}: Format waktu mulai tidak valid (HH:MM)`];if(t.end_hour&&!i.test(t.end_hour))return[`Hari ${t.day}: Format waktu selesai tidak valid (HH:MM)`];if(t.end_hour<=t.start_hour)return[`Hari ${t.day}: Waktu selesai harus setelah waktu mulai`];o[t.day]||(o[t.day]=[]),o[t.day].push(t)}for(const[t,p]of Object.entries(o)){const w=p;w.sort((v,M)=>v.start_hour.localeCompare(M.start_hour));for(let v=1;v<w.length;v++){const M=w[v-1],j=w[v];if(j.start_hour<M.end_hour)return[`Terjadi overlap jadwal pada ${be[parseInt(t)-1]}: ${M.start_hour}-${M.end_hour} dan ${j.start_hour}-${j.end_hour}`]}const I={};for(const v of w)v.teacher_id&&(I[v.teacher_id]||(I[v.teacher_id]=[]),I[v.teacher_id].push(v));for(const[v,M]of Object.entries(I)){M.sort((j,q)=>j.start_hour.localeCompare(q.start_hour));for(let j=1;j<M.length;j++){const q=M[j-1],ae=M[j];if(ae.start_hour<q.end_hour){const ve=s.find(Te=>Te.id===parseInt(v));return[`${ve?ve.full_name:`Guru ID ${v}`} memiliki jadwal bertumpuk pada ${be[parseInt(t)-1]}: ${q.start_hour}-${q.end_hour} dan ${ae.start_hour}-${ae.end_hour}`]}}}}return[]}const J=()=>{u(r=>{const o={};return Object.keys(r).forEach(i=>{o[parseInt(i)]=r[parseInt(i)].map(t=>({...t,editable:!1}))}),o}),F(null)};return n.jsxs(Fe,{breadcrumbs:_t(),children:[n.jsx(ke,{title:`Jadwal - ${e.name}`}),n.jsx(Ce,{position:"top-right",richColors:!0}),n.jsxs("div",{className:"rounded-xl bg-white p-6 shadow-lg",children:[n.jsxs("div",{className:"mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[n.jsxs("h1",{className:"text-2xl font-bold",children:["Jadwal: ",e.name]}),n.jsx("button",{type:"submit",form:R===0?"shift-form":"subject-form",disabled:R===0?S:f,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-blue-700 disabled:opacity-50",children:S||f?"Menyimpan...":"Simpan Jadwal"})]}),n.jsxs(z.Group,{selectedIndex:R,onChange:te,children:[n.jsx(z.List,{className:"mb-6 flex rounded-lg bg-blue-100 p-1",children:["By Shifting","By Subject"].map(r=>n.jsx(z,{disabled:r==="By Shifting"&&!T||r==="By Subject"&&!P,className:({selected:o})=>`flex-1 rounded-lg py-3 text-center text-sm font-medium transition-all hover:cursor-pointer ${o?"bg-white text-blue-700 shadow":"text-gray-600 hover:bg-blue-200"} ${r==="By Shifting"&&!T||r==="By Subject"&&!P?"cursor-not-allowed opacity-50":""}`,children:r},r))}),n.jsxs(z.Panels,{children:[n.jsx(z.Panel,{children:n.jsx("form",{id:"shift-form",onSubmit:le,className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:E.days.map((r,o)=>n.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[n.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:r.day_name}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Shifting:"}),n.jsxs("select",{value:r.shifting_id||"",onChange:i=>B(o,i.target.value?parseInt(i.target.value):null),className:"w-full rounded-md border border-gray-300 bg-gray-50 p-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"-- No Schedule --"}),l.map(i=>n.jsxs("option",{value:i.id,children:[i.name," (",i.start_hour," - ",i.end_hour,")"]},i.id))]})]}),r.shifting_id&&n.jsxs("div",{children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Teacher responsible:"}),n.jsx(Ge,{value:r.teachers,onChange:i=>$(o,i),placeholder:"Cari guru...",options:H})]})]},r.day))})}),n.jsx(z.Panel,{children:P?n.jsx("form",{id:"subject-form",onSubmit:he,className:"space-y-6",children:[1,2,3,4,5,6,7].map(r=>{var o,i;return n.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm",children:[n.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:be[r-1]}),n.jsx("button",{type:"button",onClick:()=>me(r),className:"inline-flex items-center rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-green-700",children:"+ Tambah"})]}),n.jsx("div",{className:"grid gap-4 md:grid-cols-1",children:(o=_[r])==null?void 0:o.map((t,p)=>{var v,M;const w=(x==null?void 0:x.day)===r&&(x==null?void 0:x.index)===p,I=!t.id||t.id.toString().includes(".");return n.jsx("div",{className:"relative rounded-md border border-gray-300 bg-gray-50 p-4",children:n.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-5",children:[n.jsxs("div",{children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Jam Mulai"}),n.jsx("input",{type:"time",value:t.start_hour,onChange:j=>K(r,p,"start_hour",j.target.value),className:`mt-1 w-full rounded-md border border-gray-300 p-2 text-sm shadow-sm ${t.editable?"cursor-text bg-white":"cursor-not-allowed bg-gray-100"}`,disabled:!t.editable,readOnly:!t.editable,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Jam Selesai"}),n.jsx("input",{type:"time",value:t.end_hour,onChange:j=>K(r,p,"end_hour",j.target.value),className:`mt-1 w-full rounded-md border border-gray-300 p-2 text-sm shadow-sm ${t.editable?"cursor-text bg-white":"cursor-not-allowed bg-gray-100"}`,disabled:!t.editable,readOnly:!t.editable,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Mata Pelajaran"}),n.jsx(je,{value:t.subject_id,onChange:j=>K(r,p,"subject_id",j),placeholder:"Pilih mata pelajaran...",endpoint:route("subjects.search"),initialOption:t.subject_id?{id:t.subject_id,full_name:((v=d.find(j=>j.id===t.subject_id))==null?void 0:v.name)||""}:void 0,showInitialOptions:!0,required:!0,disabled:!t.editable})]}),n.jsxs("div",{children:[n.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Pengajar"}),n.jsx(je,{value:t.teacher_id,onChange:j=>K(r,p,"teacher_id",j),placeholder:"Select teacher...",endpoint:route("teachers.search"),initialOption:t.teacher_id?{id:t.teacher_id,full_name:((M=s.find(j=>j.id===t.teacher_id))==null?void 0:M.full_name)||""}:void 0,showInitialOptions:!0,required:!0,disabled:!t.editable})]}),n.jsx("div",{className:"mt-1 flex h-full items-center justify-start space-x-2 pt-6 md:pt-0",children:I?n.jsx("button",{type:"button",onClick:()=>re(r,p),className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:cursor-pointer hover:bg-gray-50",children:"Batal"}):w?n.jsxs(n.Fragment,{children:[n.jsx("button",{type:"button",onClick:()=>G(r,p),className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:cursor-pointer hover:bg-gray-50",children:"Batal"}),n.jsx("button",{type:"button",onClick:J,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer",children:"Selesai"})]}):n.jsxs(n.Fragment,{children:[n.jsx("button",{type:"button",onClick:()=>D(r,p),className:"rounded-md bg-yellow-400 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-yellow-600",disabled:x!==null,children:"Edit"}),n.jsx("button",{type:"button",onClick:()=>re(r,p),className:"rounded-md bg-red-500 px-4 py-2 text-sm font-medium text-white hover:cursor-pointer hover:bg-red-700",children:"Hapus"})]})})]})},p)})}),((i=_[r])==null?void 0:i.length)===0&&n.jsx("div",{className:"py-4 text-center text-gray-500",children:"Tidak ada jadwal mata pelajaran untuk hari ini"})]},r)})}):n.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-8 text-center",children:n.jsxs("div",{className:"mx-auto max-w-md",children:[n.jsx("div",{className:"mb-4 text-5xl",children:"⚠️"}),n.jsx("h3",{className:"mb-2 text-xl font-semibold",children:"Attendance Mode Mismatch"}),n.jsx("p",{className:"text-gray-600",children:'Saat ini attendance mode yang aktif adalah "Per Shift". Ganti ke "Per Subject" mode di setting tahun ajaran untuk dapat menggunakan fitur ini.'})]})})})]})]})]})]})}export{Lt as default};
