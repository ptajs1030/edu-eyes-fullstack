import{r as i,j as e,a as N}from"./app-ECl7PNEZ.js";import{F as C}from"./form-modal-Cc5VfxGB.js";import{t as L}from"./index-DuXsyNjS.js";/* empty css            */import"./proxy-BZ542oUl.js";import"./index-Di_juwC2.js";function D({isOpen:m,onClose:x,user:t,statuses:y,role:s,routePrefix:j}){const[r,u]=i.useState({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:s.id,status:"active",...s.value==="admin"||s.value==="teacher"?{nip:"",position:""}:{},...s.value==="parent"?{job:""}:{},address:""}),[b,f]=i.useState(!1),[g,p]=i.useState(null),[w,h]=i.useState(!1),v=i.useRef(null);i.useEffect(()=>{m&&t&&!b?(u({...t,password:"",password_confirmation:"",profile_picture:void 0}),t.profile_picture&&p(`/storage/${t.profile_picture}`),f(!0)):m&&!t&&!b&&(u({full_name:"",username:"",phone:"",email:"",password:"",password_confirmation:"",role_id:s.id,status:"active",...s.value==="admin"||s.value==="teacher"?{nip:"",position:""}:{},...s.value==="parent"?{job:""}:{},address:""}),p(null),f(!0)),h(!1)},[t,s,m,b]),i.useEffect(()=>{m||(f(!1),p(null),h(!1))},[m]);const l=(a,o)=>{u(c=>({...c,[a]:o}))},k=a=>{var c;const o=(c=a.target.files)==null?void 0:c[0];if(o){const d=new FileReader;d.onloadend=()=>{p(d.result)},d.readAsDataURL(o),u(n=>({...n,profile_picture:o})),h(!1)}},_=()=>{p(null),u(a=>({...a,profile_picture:void 0})),h(!0),v.current&&(v.current.value="")},F=a=>{a.preventDefault();const o=new FormData;r.profile_picture instanceof File&&o.append("profile_picture",r.profile_picture),w&&o.append("remove_profile_picture","1"),Object.entries(r).forEach(([d,n])=>{d!=="profile_picture"&&n!==void 0&&n!==null&&o.append(d,n)}),t!=null&&t.id&&o.append("_method","PUT");const c=t!=null&&t.id?route(`${j}.update`,t.id):route(`${j}.store`);N.post(c,o,{preserveScroll:!0,onSuccess:()=>{x(),N.reload()},onError:d=>{const n=Object.values(d).join(`
`);L.error(`Failed: ${n}`)},headers:{"Content-Type":"multipart/form-data"}})};return e.jsxs(C,{isOpen:m,onClose:x,title:t?`Edit ${s.name}`:`Add New ${s.name}`,onSubmit:F,children:[e.jsxs("div",{className:"mb-4 flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-32 w-32 items-center justify-center overflow-hidden rounded-full border-2 border-gray-300 bg-gray-100",children:g?e.jsx("img",{src:g,alt:"Profile preview",className:"h-full w-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(g||(t==null?void 0:t.profile_picture)&&!w)&&e.jsx("button",{type:"button",onClick:_,className:"absolute -top-2 -right-2 rounded-full bg-red-500 p-1 text-white hover:cursor-pointer hover:bg-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("label",{className:"mt-2 cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("span",{children:"Upload Photo"}),e.jsx("input",{type:"file",ref:v,className:"hidden",accept:"image/*",onChange:k})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Max 2MB (300x300)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("input",{type:"text",value:s.name,disabled:!0,className:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 p-2 shadow-sm"}),e.jsx("input",{type:"hidden",name:"role_id",value:s.id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name*"}),e.jsx("input",{id:"full_name",type:"text",maxLength:70,value:r.full_name,onChange:a=>l("full_name",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username*"}),e.jsx("input",{id:"username",type:"text",maxLength:70,value:r.username,onChange:a=>l("username",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0})]}),(s.value==="admin"||s.value==="teacher")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"nip",className:"block text-sm font-medium text-gray-700",children:"NIP"}),e.jsx("input",{id:"nip",type:"text",maxLength:70,value:r.nip||"",onChange:a=>l("nip",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Position"}),e.jsx("input",{id:"position",type:"text",maxLength:70,value:r.position||"",onChange:a=>l("position",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]})]}),s.value==="parent"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"job",className:"block text-sm font-medium text-gray-700",children:"Job"}),e.jsx("input",{id:"job",type:"text",maxLength:70,value:r.job||"",onChange:a=>l("job",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("input",{id:"phone",type:"tel",value:r.phone||"",onChange:a=>l("phone",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:r.email||"",onChange:a=>l("email",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("textarea",{id:"address",value:r.address||"",onChange:a=>l("address",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",rows:3})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status*"}),e.jsx("select",{id:"status",value:r.status,onChange:a=>l("status",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!0,children:y.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:t?"New Password":"Password*"}),e.jsx("input",{id:"password",type:"password",value:r.password||"",onChange:a=>l("password",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",placeholder:t?"Leave blank to keep current password":"",required:!t})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700",children:t?"Confirm New Password":"Confirm Password*"}),e.jsx("input",{id:"password_confirmation",type:"password",value:r.password_confirmation||"",onChange:a=>l("password_confirmation",a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm",required:!t})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:x,className:"mr-2 rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:cursor-pointer hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:cursor-pointer hover:bg-blue-700",children:t?"Update":"Create"})]})]})}export{D as default};
